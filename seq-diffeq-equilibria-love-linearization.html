<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Equilibrium Analysis, Models of Love, and Linearization</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script><script>// Make *any* div with class 'sagecell-r' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-r",
  "linked": true,
  "linkKey": "linked-r",
  "autoeval": false,
  "languages": [
    "r"
  ],
  "evalButtonText": "Evaluate (R)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.10';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.c2d04816128ebb44.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.e0c6d4592e23c667.css">
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="seq-diffeq-nullclines-predation-competition.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-continuous-dynamics.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="interactions.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-structured-populations.html" class="internal"><span class="codenumber">3</span> <span class="title">Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-two-stage.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Two Stage Populations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-matrix-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Models for Structured Populations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Example: Mosquito Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Model Equations and Parameters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Simulation, Asymptotic Growth, and Stable Distributions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Exploring the Impact of Additional Mortality</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-density-dependent.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Density Dependence in Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-model" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Model Development</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#sec-structure-density-dependent-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Simulation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-equilibria" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Finding Fixed Points for Structured Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-partial-derivatives" class="internal"><span class="codenumber">3.4.4</span> <span class="title">Partial Derivatives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-fixed-point-stability" class="internal"><span class="codenumber">3.4.5</span> <span class="title">Testing the Stability of a Fixed Point</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-continuous-dynamics.html" class="internal"><span class="codenumber">4</span> <span class="title">Continuous Dynamics</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-rates-of-change" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-slope-fields" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Slope Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-numerical-solutions" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Numerical Solutions to Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="diffeq-population-models.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Continuous Time Population Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-popn-density-dependent" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Continuous Logistic Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-rescaling" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Dimensional Analysis and Rescaling</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-diffeq-equilibria.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Analysis of Equilibria, Drug Dosing, and the Allee effect</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-diffeq-phase-line" class="internal"><span class="codenumber">4.3.1</span> <span class="title">The Phase Line</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-equilibria-examples" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Applications</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Interacting Variables and Producer-Consumer Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-phase-plane-vector-fields" class="internal"><span class="codenumber">4.4.1</span> <span class="title">The Phase Plane and Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-systems-differential-equations" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Systems of Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Phase Plane Analysis with Nullclines, Competition and Predator-Prey Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-competition-models" class="internal"><span class="codenumber">4.5.1</span> <span class="title">Competition Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-nullcline-analysis" class="internal"><span class="codenumber">4.5.2</span> <span class="title">Nullcline Analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-predator-prey" class="internal"><span class="codenumber">4.5.3</span> <span class="title">The Predator-Prey Model</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-nullclines-code" class="internal"><span class="codenumber">4.5.4</span> <span class="title">Generating Nullcline Curves in R</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Equilibrium Analysis, Models of Love, and Linearization</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-equil-romeo-juliet" class="internal"><span class="codenumber">4.6.1</span> <span class="title">Linear Differential Equations and Romeo and Juliet</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-eigenvalues-as-rates" class="internal"><span class="codenumber">4.6.2</span> <span class="title">Linear Systems of Differential Equations and Eigenvalues</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-linearization" class="internal"><span class="codenumber">4.6.3</span> <span class="title">Linearization Around Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">5</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">5.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="seq-diffeq-equilibria-love-linearization"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">4.6</span><span class="space"> </span><span class="title">Equilibrium Analysis, Models of Love, and Linearization</span>
</h2>
<section class="introduction" id="seq-diffeq-equilibria-love-linearization-2"><div class="para" id="seq-diffeq-equilibria-love-linearization-2-1">Equilibrium solutions are one of the most important concepts in understanding dynamical systems. We already know that we find equilibrium solutions by looking for the intersection of the nullclines. In the previous section, we saw that sometimes we can determine the stability of an equilibrium by looking at the direction of the vector field in all of the regions surrounding an equilibrium. Unfortunately, this is sometimes inconclusive. Even worse, it might be hard to visualize especially if there are more than two state variables.</div>
<div class="para" id="seq-diffeq-equilibria-love-linearization-2-2">We need a more definitive way to determine whether an equilibrium solution is stable or unstable. For our projection models involving sequences, we learned about the possibility of using the eigenvalues of the derivative matrix of the projection functions. We will be able to do the same thing for systems of differential equations. This time, however, we are looking at whether the eigenvalues of the matrix have positive or negative real part.</div></section><section class="subsection" id="subsec-diffeq-equil-romeo-juliet"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.6.1</span><span class="space"> </span><span class="title">Linear Differential Equations and Romeo and Juliet</span>
</h3>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-2">
<div class="para">Suppose we have <span class="process-math">\(n\)</span> different state variables, <span class="process-math">\(X_1,\ldots,X_n\)</span> and a system of <span class="process-math">\(n\)</span> differential equations for those variables,</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-2-4">
\begin{align*}
X_1' \amp = f_1(X_1, X_2, \ldots, X_n) \\
X_2' \amp = f_2(X_1, X_2, \ldots, X_n) \\
\amp \vdots \\
X_n' \amp = f_n(X_1, X_2, \ldots, X_n). 
\end{align*}
</div>
<div class="para">We say that the system is a <dfn class="terminology">linear system of differential equations</dfn> if the <span class="process-math">\(n\)</span> rate functions are all just linear combinations of the state variables</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-2-7">
\begin{align*}
X_1' \amp = c_{11} X_1 + c_{12} X_2 + \cdots + c_{1n} X_n \\
X_2' \amp = c_{21} X_1 + c_{22} X_2 + \cdots + c_{2n} X_n \\
\amp \vdots \\
X_n' \amp = c_{n1} X_1 + c_{n2} X_2 + \cdots + c_{nn} X_n. 
\end{align*}
</div>
<div class="para">The coefficients define a square matrix with <span class="process-math">\(n\)</span> rows (for each equation) and <span class="process-math">\(n\)</span> columns (for the state variables),</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-2-10">
\begin{align*}
\end{align*}
</div>
<div class="para">This system is often summarized as a vector differential equation</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-2-11">
\begin{gather*}
\end{gather*}
</div>
<div class="para">where <span class="process-math">\(X = (X_1, X_2, \ldots, X_n)\)</span> is the state vector containing all of state variables in order.</div>
</div>
<div class="para" id="subsec-diffeq-equil-romeo-juliet-3">As our motivating example, we will consider a simple model for love developed by mathematician Steven Strogatz as a way to illustrate linear differential equations, which he called the “Romeo-Juliet” model of love. Let <span class="process-math">\(R\)</span> quantify Romeo’s ardor toward Juliet, so that <span class="process-math">\(R \gt 0\)</span> corresponds to Romeo feeling in love with Juliet and <span class="process-math">\(R \lt 0\)</span> corresponds to Romeo feeling out of love with Juliet. We let <span class="process-math">\(J\)</span> quantify Juliet’s ardor toward Romeo in a similar way.</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-4">
<div class="para">In his play “Romeo and Juliet”, Shakespeare gives a dialogue between Romeo and his friend Benvolio:</div>
<dl class="description-list">
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-1">Benvolio</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-1-2">What sadness lengthens Romeo’s hours?</div></dd>
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-2">Romeo</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-2-2">Not having that, which, having, makes them short.</div></dd>
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-3">Benvolio</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-3-2">In love?</div></dd>
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-4">Romeo</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-4-2">Out.</div></dd>
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-5">Benvolio</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-5-2">Of love?</div></dd>
<dt id="subsec-diffeq-equil-romeo-juliet-4-2-6">Romeo</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-4-2-6-2">Out of her favour, where I am in love.</div></dd>
</dl>
<div class="para">In a very simplified interpretation of the relationship, Romeo initially has positive feelings of love toward Juliet but because he perceives that he is out of her favor, he is sad. From a modeling point of view, we will say that seeing Juliet’s feelings be negative causes Romeo’s feelings of love <em class="emphasis">decrease</em>.</div>
</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-5">
<div class="para">Juliet, on the other hand, expresses coyness at Romeo in a different scene:</div>
<dl class="description-list">
<dt id="subsec-diffeq-equil-romeo-juliet-5-1-1">Juliet</dt>
<dd><div class="para" id="subsec-diffeq-equil-romeo-juliet-5-1-1-2">If thou dost love, pronounce it faithfully:<br> Or if thou think’st I am too quickly won,<br> I’ll frown and be perverse an say thee nay,<br> So thou wilt woo; but else, not for the world.</div></dd>
</dl>
<div class="para">Again, we will take a simplified interpretation and say that Juliet’s actual feelings move in the opposite direction of Romeo current feelings. If Romeo loves Juliet, Juliet’s feelings for Romeo will decrease. If Romeo dislikes Juliet, Juliet tries to win him back by having her feelings increase.</div>
</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-6">
<div class="para">The simplest model capturing these simplified (and nontextual) dynamics would be given by a system of differential equations</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-6-1">
\begin{align*}
R' \amp = a J, \\
J' \amp = - b R.
\end{align*}
</div>
<div class="para">This says that Romeo’s feelings <em class="emphasis">move</em> in the direction of Juliets feelings by having a rate of change that is <em class="emphasis">proportional</em> to Juliet’s current level of love. Meanwhile, Juliet’s feelings have a rate of change that is proportional to the <em class="emphasis">opposite</em> of Romeo’s current level of love.</div>
</div>
<div class="para" id="subsec-diffeq-equil-romeo-juliet-7">The phase plane will be the <span class="process-math">\((R,J)\)</span> plane. The <span class="process-math">\(R\)</span> nullcline is the line <span class="process-math">\(J=0\)</span> (horizontal axis). If <span class="process-math">\(J \gt 0\text{,}\)</span> <span class="process-math">\(R\)</span> is moving to the right; if <span class="process-math">\(J \lt 0\text{,}\)</span> <span class="process-math">\(R\)</span> is moving to the left. The <span class="process-math">\(J\)</span> nullcine is the line <span class="process-math">\(R=0\)</span> (vertical axis). If <span class="process-math">\(R \gt 0\text{,}\)</span> <span class="process-math">\(J\)</span> is moving down; if <span class="process-math">\(R \lt 0\text{,}\)</span> <span class="process-math">\(J\)</span> is moving up. There is only one equilibrium at <span class="process-math">\((R,J)=(0,0)\text{,}\)</span> a state of mutual apathy.</div>
<figure class="figure figure-like" id="fig-romeo-juliet-responsive-fickle-nullclines"><div class="image-box" style="width: 60%; margin-left: 20%; margin-right: 20%;"><img src="external/images/romeo-juliet-responsive-fickle-nullclines.svg" role="img" class="contained" alt="phase plane with nullclines and directions of motion for Romeo and Juliet model"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.6.1<span class="period">.</span></span><span class="space"> </span>Phase plane for the Romeo-Juliet model showing nullclines, equilibrium, and directions of motion.</figcaption></figure><div class="para" id="subsec-diffeq-equil-romeo-juliet-9">The preliminary phase plane analysis based on the nullclines suggest that the dynamics will have the state spiraling around the equilibrium. We can verify this numerically by calculating a solution and looking at the plot. Of course, we need to select parameter values, so we will choose <span class="process-math">\(a = 0.8\)</span> and <span class="process-math">\(b = 0.2\text{.}\)</span> There is no fixed sense of scale for this problem, so we will start with an initial value <span class="process-math">\(R(0) = 1\)</span> and <span class="process-math">\(J(0) = 0\text{,}\)</span> so that Romeo likes Juliet but Juliet starts out being indifferent.</div>
<div class="para" id="subsec-diffeq-equil-romeo-juliet-10">The following listing will create a graph showing the phase plane with nullclines and the trajectory for this initial value problem as well as a graph showing the solutions as functions of time.</div>
<figure class="listing figure-like" id="subsec-diffeq-equil-romeo-juliet-11"><div class="code-box"><pre class="program"><code class="language-r"># Rate formulas
f1 &lt;- function(R, J, params) {
    with(as.list(params), a*J)
}
f2 &lt;- function(R, J, params) {
    with(as.list(params), -b*R)
}

# Model parameters
my_p &lt;- c(a = 0.8, b = 0.2)

# Rate function for ode solver
rateFcn &lt;- function(t, state, params) {
    with(as.list(state),
    {
        dRdt &lt;- f1(R, J, params)
        dJdt &lt;- f2(R, J, params)
        list( c(dRdt, dJdt) )
    })
}

# Find the numerical solution
library(deSolve)
R0 &lt;- 1
J0 &lt;- 0
times &lt;- seq(0, 30, by=0.1)
soln &lt;- ode( c(R=R0, J=J0), times, rateFcn, my_p ) |&gt;
    as.data.frame()

# Create vector field data
library(dplyr)
vf_data &lt;- expand.grid(R = seq(-1.5, 1.5, length = 21),
                       J = seq(-1.5, 1.5, length = 21)) |&gt;
    mutate( dRdt = f1(R, J, my_p),
            dJdt = f2(R, J, my_p)) |&gt;
    mutate( speed = sqrt(dRdt^2 + dJdt^2) ) |&gt;
    mutate( Rdir = dRdt/speed,
            Jdir = dJdt/speed)

# Create the plot, we know nullclines exactly
library(ggplot2)
library(ggquiver)
pp_graph &lt;- ggplot() +
    geom_quiver(data = vf_data,
        mapping = aes(x = R, y = J,
                      u = Rdir, v = Jdir),
        color = "black", vecsize = 0.5) + 
    geom_hline(yintercept = 0, color = "cyan") +
    geom_vline(xintercept = 0, color = "salmon") +
    geom_path(data = soln,
              mapping = aes(x = R, y = J),
              linewidth = 2) +
    labs(x = "R", y = "J") + 
    scale_color_discrete(breaks=c("R","J"),
                         labels = c("R'=0", "J'=0"),
                         name = "nullcline")
show(pp_graph)

soln_graph &lt;- ggplot(data = soln) +
    geom_line(mapping = aes(x = time, y = R, color="R"),
                linewidth = 2) + 
    geom_line(mapping = aes(x = time, y = J, color="J"),
                linewidth = 2) +
    scale_color_discrete(breaks = c("R","J"), name = "")
show(soln_graph)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.6.2<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="fig-romeo-juliet-responsive-fickle-graphs"><div class="sidebyside"><div class="sbsrow" style="margin-left:0%;margin-right:0%;">
<div class="sbspanel top" style="width:50%;"><img src="external/images/romeo-juliet-responsive-fickle-phaseplane-trajectory.png" class="contained" alt="phase plane showing nullclines and trajectory of a solution"></div>
<div class="sbspanel top" style="width:50%;"><img src="external/images/romeo-juliet-responsive-fickle-phaseplane-solutions.png" class="contained" alt="phase plane showing nullclines and trajectory of a solution"></div>
</div></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.6.3<span class="period">.</span></span><span class="space"> </span>Phase plane showing nullclines and the trajectory of the solution as well as the solution <span class="process-math">\(R(t)\)</span> and <span class="process-math">\(J(t)\)</span> as functions of time.</figcaption></figure><div class="para logical" id="subsec-diffeq-equil-romeo-juliet-13">
<div class="para">If you think those graphs look like sine and cosine curves, you are correct. <span class="process-math">\(R(t)\)</span> is exactly</div>
<div class="displaymath process-math">
\begin{equation*}
R(t) = \cos(\omega t)
\end{equation*}
</div>
<div class="para">for some angular frequency <span class="process-math">\(\omega\text{.}\)</span> The love of Romeo and Juliet, if not interrupted, would be a never-ending cycle of ups and downs. But what is the angular frequency?</div>
</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-14">
<div class="para">If we calculate <span class="process-math">\(R'(t)\)</span> we get</div>
<div class="displaymath process-math">
\begin{equation*}
R' = -\omega \sin(\omega t)\text{,}
\end{equation*}
</div>
<div class="para">which by our differential equation is supposed to equal <span class="process-math">\(R' = a J\text{.}\)</span> Although we don’t know <span class="process-math">\(\omega\)</span> quite yet, this allows us to solve for</div>
<div class="displaymath process-math">
\begin{equation*}
J(t) = -\frac{\omega}{a} \sin(\omega t)\text{.}
\end{equation*}
</div>
</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-15">
<div class="para">Another derivative gives us</div>
<div class="displaymath process-math">
\begin{equation*}
J'(t) = -\frac{\omega^2}{a} \cos(\omega t)\text{,}
\end{equation*}
</div>
<div class="para">which is also supposed to equal <span class="process-math">\(J' = -b R\text{.}\)</span> Since we know <span class="process-math">\(-b R = - b \cos(\omega t)\text{,}\)</span> we must have <span class="process-math">\(\frac{\omega^2}{a} = b\)</span> or</div>
<div class="displaymath process-math">
\begin{equation*}
\omega = \sqrt{a b}\text{.}
\end{equation*}
</div>
<div class="para">Since our demo had <span class="process-math">\(a = 0.8\)</span> and <span class="process-math">\(b = 0.2\text{,}\)</span> we get <span class="process-math">\(\omega = \sqrt{(0.8)(0.2)} = 0.4\text{.}\)</span>
</div>
</div>
<div class="para logical" id="subsec-diffeq-equil-romeo-juliet-16">
<div class="para">Now I want to make a connection to matrices and eigenvalues. Our system of differential equations</div>
<div class="displaymath process-math" id="subsec-diffeq-equil-romeo-juliet-16-1">
\begin{align*}
R' \amp = a J, \\
J' \amp = - b R.
\end{align*}
</div>
<div class="para">is a <dfn class="terminology">linear system</dfn> because the rate formulas are linear combinations of the state variables <span class="process-math">\(R\)</span> and <span class="process-math">\(J\text{.}\)</span> The matrix associated with this system contains the coefficients of the variables,</div>
<div class="displaymath process-math">
\begin{equation*}
A = \begin{bmatrix} 0 \amp a \\ -b \amp 0 \end{bmatrix}
=  \begin{bmatrix} 0 \amp 0.8 \\ -0.2 \amp 0 \end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">What are the eigenvalues of this matrix?</div>
</div>
<figure class="listing figure-like" id="subsec-diffeq-equil-romeo-juliet-17"><div class="code-box"><pre class="program"><code class="language-r">A &lt;- matrix( c(0, -0.2, 0.8, 0), nrow=2, ncol=2, byrow=FALSE)
eig_sys &lt;- eigen(A)
print(eig_sys$values)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.6.4<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="code-box"><pre class="console">&gt; print(eig_sys$values)
[1] 0+0.4i 0-0.4i
</pre></div>
<div id="subsec-diffeq-equil-romeo-juliet-19" class="ptx-sagecell sagecell-r"><script type="text/x-sage">A <- matrix( c(0, -0.2, 0.8, 0), nrow=2, ncol=2, byrow=FALSE)
eig_sys <- eigen(A)
print(eig_sys$values)
</script></div>
<div class="para" id="subsec-diffeq-equil-romeo-juliet-20">The eigenvalues are complex numbers, <span class="process-math">\(\lambda_1 = 0 + 0.4i\)</span> and <span class="process-math">\(\lambda_2 = 0 - 0.4i\text{.}\)</span> The imaginary coefficient, the number multiplying <span class="process-math">\(i\text{,}\)</span> is exactly the same as our angular frequency.</div></section><section class="subsection" id="subsec-diffeq-eigenvalues-as-rates"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.6.2</span><span class="space"> </span><span class="title">Linear Systems of Differential Equations and Eigenvalues</span>
</h3>
<div class="para" id="subsec-diffeq-eigenvalues-as-rates-2">The observation that the eigenvalues of the matrix were related to the solutions of the system of differential equations is not an accident. It is not our goal to learn the theory, but I will summarize the major results.</div>
<article class="theorem theorem-like" id="thm-diffeq-linear-eigen-systems"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">4.6.5</span><span class="period">.</span>
</h4>
<div class="para" id="thm-diffeq-linear-eigen-systems-1-1">Suppose a linear system of <span class="process-math">\(n\)</span> differential equations for <span class="process-math">\(n\)</span> state variables is written in matrix form <span class="process-math">\(\vec{X}' = A \cdot \vec{X}\)</span> with a square <span class="process-math">\(n \times n\)</span> matrix <span class="process-math">\(A\text{.}\)</span> With some rare exceptions, the matrix <span class="process-math">\(A\)</span> will have <span class="process-math">\(n\)</span> eigenvalues <span class="process-math">\(\lambda_1, \lambda_2, \ldots, \lambda_n\)</span> and <span class="process-math">\(n\)</span> corresponding eigenvectors <span class="process-math">\(\vec v_1, \vec v_2, \ldots, \vec v_n\text{.}\)</span>
</div> <div class="para logical" id="thm-diffeq-linear-eigen-systems-1-2">
<div class="para">Each eigenvalue–eigenvector pair <span class="process-math">\((\lambda_k, \vec v_k)\)</span> provides one component of a solution.</div>
<ul class="disc" id="thm-diffeq-linear-eigen-systems-1-2-3">
<li id="thm-diffeq-linear-eigen-systems-1-2-3-1"><div class="para" id="thm-diffeq-linear-eigen-systems-1-2-3-1-1">If <span class="process-math">\(\lambda_k\)</span> is a real number, then there is a solution <span class="process-math">\(e^{\lambda_k t} \vec v_k\)</span> corresponding to either exponential growth or decay in the direction of <span class="process-math">\(\vec v_k\)</span>
</div></li>
<li id="thm-diffeq-linear-eigen-systems-1-2-3-2">
<div class="para" id="thm-diffeq-linear-eigen-systems-1-2-3-2-1">If <span class="process-math">\(\lambda_k\)</span> is a pure imaginary number, <span class="process-math">\(\lambda_k = \omega i\text{,}\)</span> then its corresponding eigenvector will have a nonzero real and imaginary vector components and there will be <em class="emphasis">two</em> component solutions of the form <span class="process-math">\(\cos(\omega t) \vec{u}\)</span> and <span class="process-math">\(\sin(\omega t) \vec{v}\)</span> where <span class="process-math">\(\vec u,\vec v\)</span> are in the plane of the real and imaginary components of the eigenvector.</div>
<div class="para" id="thm-diffeq-linear-eigen-systems-1-2-3-2-2">The conjugate value <span class="process-math">\(-\omega i\)</span> will also be an eigenvalue and its corresponding eigenvectors will similarly be conjugates. The conjugate does not introduce any new solutions.</div>
</li>
<li id="thm-diffeq-linear-eigen-systems-1-2-3-3"><div class="para" id="thm-diffeq-linear-eigen-systems-1-2-3-3-1">If <span class="process-math">\(\lambda_k\)</span> is a complex number with real and imaginary parts, <span class="process-math">\(\lambda_k = \alpha + \omega i\text{,}\)</span> then its corresponding eigenvector will also have a nonzero real and imaginary vector components. There will be <em class="emphasis">two</em> component solutions of the form <span class="process-math">\(e^{\alpha t} \cos(\omega t) \vec{u}\)</span> and <span class="process-math">\(e^{\alpha t} \sin(\omega t) \vec{v}\)</span> where <span class="process-math">\(\vec u,\vec v\)</span> are in the plane of the real and imaginary components of the eigenvector.</div></li>
</ul>
</div> <div class="para" id="thm-diffeq-linear-eigen-systems-1-3">Growth or decay ultimately comes down to the real part of the eigenvalues. For each eigenvalue with a <em class="emphasis">positive</em> real part, there is a eigenvector-based direction for which solutions see exponential growth. For each eigenvalue with a <em class="emphasis">negative</em> real part, there is a eigenvector-based direction for which solutions see exponential decay. Eigenvalues that are complex conjugate pairs together correspond to two directions in which there is oscillation, and whether the oscillation grows or decays is based on the real part of the eigenvalue.</div></article><div class="para" id="subsec-diffeq-eigenvalues-as-rates-4">The take-home message for this theorem is that when we have our matrix for the linear system of differential equations, we look at all of the eigenvalues and keep track of whether the real part is positive or negative. This will give us an understanding of whether solutions are growing or decaying. The imaginary parts will give us an understanding of whether there are any oscillations.</div>
<article class="example example-like" id="subsec-diffeq-eigenvalues-as-rates-5"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.6.6</span><span class="period">.</span>
</h4>
<div class="para logical" id="subsec-diffeq-eigenvalues-as-rates-5-1-1">
<div class="para">A variant of the Romeo and Juliet model is to consider the possibility that both Romeo and Juliet respond positively to the others’ current emotions. That is, if Romeo loves Juliet, Juliets feelings toward Romeo increase, regardless of their current value. If Romeo dislikes Juliet, then her feelings will decrease. The mutually responsive model of love is given by</div>
<div class="displaymath process-math" id="subsec-diffeq-eigenvalues-as-rates-5-1-1-1">
\begin{align*}
R' \amp = a J,\\
J' \amp = b R.
\end{align*}
</div>
</div> <div class="para logical" id="subsec-diffeq-eigenvalues-as-rates-5-1-2">
<div class="para">The matrix associated with this system is</div>
<div class="displaymath process-math">
\begin{equation*}
A = \begin{bmatrix} 0 \amp a \\ b \amp 0 \end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">Using particular values <span class="process-math">\(a = 0.8\)</span> and <span class="process-math">\(b = 0.2\text{,}\)</span> we find two real eigenvalues <span class="process-math">\(\lambda_1 = 0.4\)</span> and <span class="process-math">\(\lambda_2 = -0.4\text{.}\)</span> R reports the first eigenvector as <span class="process-math">\(\vec v_1 = \langle 0.8944, 0.4472 \rangle\text{,}\)</span> which will be the direction of the exponential growth component <span class="process-math">\(e^{0.4 t}\text{.}\)</span> The second eigenvector <span class="process-math">\(\vec v_2 = \langle -0.8944, 0.4472 \rangle\)</span> gives the direction of the exponential decay component <span class="process-math">\(e^{-0.4 t}\text{.}\)</span>
</div>
</div> <div class="para" id="subsec-diffeq-eigenvalues-as-rates-5-1-3">The equilibrium of no passion in this case is <dfn class="terminology">unstable</dfn> because solutions have components that move away from the equilibrium with exponential growth.</div></article></section><section class="subsection" id="subsec-diffeq-linearization"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.6.3</span><span class="space"> </span><span class="title">Linearization Around Equilibria</span>
</h3>
<div class="para logical" id="subsec-diffeq-linearization-2">
<div class="para">We are now ready to give the result for local stability analysis of equilibria in systems of differential equations. Suppose we have a system of differential equations—linear or nonlinear—</div>
<div class="displaymath process-math" id="subsec-diffeq-linearization-2-3">
\begin{align*}
X_1' \amp = f_1(X_1, X_2, \ldots, X_n) \\
X_2' \amp = f_2(X_1, X_2, \ldots, X_n) \\
\amp \vdots \\
X_n' \amp = f_n(X_1, X_2, \ldots, X_n). 
\end{align*}
</div>
<div class="para">And suppose we have found an equilibrium solution <span class="process-math">\(\vec X^* = (x_1^*, x_2^*, \ldots, x_n^*)\)</span> at which <em class="emphasis">all</em> of the rate functions equal zero. Then <em class="emphasis">near</em> the equilibrium, the displacement of our solution from the equilibrium will approximately follow the <dfn class="terminology">linearized</dfn> system of differential equations formed by the partial derivatives.</div>
</div>
<div class="para logical" id="subsec-diffeq-linearization-3">
<div class="para">Let <span class="process-math">\(Df\)</span> be the matrix of partial derivatives,</div>
<div class="displaymath process-math">
\begin{equation*}
Df = \begin{bmatrix}
\frac{\partial f_1}{\partial x_1} \amp \frac{\partial f_1}{\partial x_2} \amp \cdots \frac{\partial f_1}{\partial x_n} \\
\frac{\partial f_2}{\partial x_1} \amp \frac{\partial f_2}{\partial x_2} \amp \cdots \frac{\partial f_2}{\partial x_n} \\
\vdots \amp \vdots \amp \ddots \amp \vdots \\
\frac{\partial f_n}{\partial x_1} \amp \frac{\partial f_n}{\partial x_2} \amp \cdots \frac{\partial f_n}{\partial x_n} \\
\end{bmatrix}
\end{equation*}
</div>
<div class="para">and we evaluate the matrix at the equilibrium to get a specific matrix <span class="process-math">\(Df(\vec X^*)\text{.}\)</span> Compute the eigenvalues of this matrix.</div>
<ul class="disc" id="subsec-diffeq-linearization-3-4">
<li id="subsec-diffeq-linearization-3-4-1"><div class="para" id="subsec-diffeq-linearization-3-4-1-1">If <em class="emphasis">all</em> of the eigenvalues have negative real parts, then the equilibrium is locally stable.</div></li>
<li id="subsec-diffeq-linearization-3-4-2"><div class="para" id="subsec-diffeq-linearization-3-4-2-1">If <em class="emphasis">one or more</em> of the eigenvalues have positive real parts, then the equilibrium is locally unstable.</div></li>
<li id="subsec-diffeq-linearization-3-4-3"><div class="para" id="subsec-diffeq-linearization-3-4-3-1">If <em class="emphasis">one or more</em> of the eigenvalues has a real part that is 0 and none have positive real part, then this test is inconclusive.</div></li>
</ul>
</div>
<div class="para" id="subsec-diffeq-linearization-4">The following Sage script can be modified to define the state variables and rate functions for your model and it will attempt to find algebraic solutions for equilibria. For each equilibrium solution it finds, it will report back the eigenvalues so that you can interpret the results. This is essentially the same analysis as what we did earlier for projection functions.</div>
<div class="para logical" id="subsec-diffeq-linearization-5">
<div class="para">The provided example is for the nondimensionalized producer–consumer model,</div>
<div class="displaymath process-math" id="subsec-diffeq-linearization-5-2">
\begin{align*}
\dot{a} \amp = a \cdot \left(1 - a\right) - a z,\\
\dot{z} \amp = (- \alpha + \beta a) \cdot z,
\end{align*}
</div>
<div class="para">which has two free parameters <span class="process-math">\(\alpha\)</span> and <span class="process-math">\(\beta\text{.}\)</span> The code initial analyzes the system for <span class="process-math">\(\alpha = 0.2\)</span> and <span class="process-math">\(\beta = 0.1\text{.}\)</span>
</div>
</div>
<div id="subsec-diffeq-linearization-6" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># Declare state variables
var("a,z")

# Parameters as values
alpha = 0.2
beta = 0.1

# Define our two functions
f1(a,z) = a * (1 - a) - a * z
f2(a,z) = (- alpha + beta * a) * z

# Create an association between variables and projections
state_vars = [a, z]
rate_functions = [f1(a,z), f2(a,z)]

# ==== Edit ABOVE this line =====
# Caution: lengths must be the same or an error
assert len(state_vars) == len(rate_functions)

# Create a matrix using partial derivatives
# This uses a Python trick called "list comprehension"
Df = matrix([ # create a list of rows based on projections
    [ # create a list of factored derivatives
        curF.derivative(curX).factor()
            for curX in state_vars
    ] for curF in rate_functions
])
show("General Jacobian")
show(Df)

# Find the equilibrium solutions
N = len(state_vars)

# Again use list comprehension so this works for other models
equil_list = solve([ rate_functions[i] == 0 for i in range(N)],
            state_vars)

# Show the equilibrium solutions and also the Jacobian evaluated there.
for equil in equil_list:
    show("-")
    show("Equilibrium solution")
    for my_var in state_vars:
        show(my_var == N(my_var.subs(equil).factor().simplify()))

    show("Jacobian")
    myJ = Df.subs(equil)
    show(myJ)
    
    show("Eigenvalues")
    myJM = Matrix(RDF, myJ)
    myEigSpace = myJM.right_eigenvectors()
    show([myEig[0] for myEig in myEigSpace])
</script></div>
<div class="para logical" id="subsec-diffeq-linearization-7">
<div class="para">The matrix of partial derivatives in terms of the parameters and state variables will be</div>
<div class="displaymath process-math">
\begin{equation*}
Df = \begin{bmatrix}
1 - 2a - z \amp -a \\
\beta z \amp -\alpha + \beta a
\end{bmatrix}\text{.}
\end{equation*}
</div>
</div>
<div class="para logical" id="subsec-diffeq-linearization-8">
<div class="para">Using the parameters <span class="process-math">\(\alpha = 0.2\)</span> and <span class="process-math">\(\beta = 0.1\text{,}\)</span> we find the following results:</div>
<ol class="decimal" id="subsec-diffeq-linearization-8-3">
<li id="subsec-diffeq-linearization-8-3-1">
<div class="para" id="subsec-diffeq-linearization-8-3-1-1">Equilibrium: <span class="process-math">\((a,z) = (0,0)\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-1-2">Eigenvalues: <span class="process-math">\(\lambda_1 = 1\text{,}\)</span> <span class="process-math">\(\lambda_2 = -0.2\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-1-3">Both eigenvalues are real, and one of them is positive. So this equilibrium is <dfn class="terminology">unstable</dfn>
</div>
</li>
<li id="subsec-diffeq-linearization-8-3-2">
<div class="para" id="subsec-diffeq-linearization-8-3-2-1">Equilibrium: <span class="process-math">\((a,z) = (1,0)\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-2-2">Eigenvalues: <span class="process-math">\(\lambda_1 = -1\text{,}\)</span> <span class="process-math">\(\lambda_2 = -0.1\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-2-3">Both eigenvalues are real and negative. So this equilibrium is <dfn class="terminology">stable</dfn>
</div>
</li>
<li id="subsec-diffeq-linearization-8-3-3">
<div class="para" id="subsec-diffeq-linearization-8-3-3-1">Equilibrium: <span class="process-math">\((a,z) = (2,-1)\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-3-2">Eigenvalues: <span class="process-math">\(\lambda_1 = -2.095\text{,}\)</span> <span class="process-math">\(\lambda_2 = 0.095\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-8-3-3-3">Both eigenvalues are real, and one of them is positive. So this equilibrium (which is not biologically meaningful since one population is negative) is <dfn class="terminology">unstable</dfn>
</div>
</li>
</ol>
<div class="para">With these parameter values, the system is only at a stable equilibrium when the algae is at its natural carrying capacity and there are no zooplankton.</div>
</div>
<div class="para logical" id="subsec-diffeq-linearization-9">
<div class="para">Changing the parameters to <span class="process-math">\(\alpha = 0.2\)</span> and <span class="process-math">\(\beta = 0.3\text{,}\)</span> we repeat the analysis:</div>
<ol class="decimal" id="subsec-diffeq-linearization-9-3">
<li id="subsec-diffeq-linearization-9-3-1">
<div class="para" id="subsec-diffeq-linearization-9-3-1-1">Equilibrium: <span class="process-math">\((a,z) = (0,0)\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-1-2">Eigenvalues: <span class="process-math">\(\lambda_1 = 1\text{,}\)</span> <span class="process-math">\(\lambda_2 = -0.2\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-1-3">Both eigenvalues are real, and one of them is positive. So this equilibrium is <dfn class="terminology">unstable</dfn>
</div>
</li>
<li id="subsec-diffeq-linearization-9-3-2">
<div class="para" id="subsec-diffeq-linearization-9-3-2-1">Equilibrium: <span class="process-math">\((a,z) = (1,0)\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-2-2">Eigenvalues: <span class="process-math">\(\lambda_1 = -1\text{,}\)</span> <span class="process-math">\(\lambda_2 = 0.1\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-2-3">Both eigenvalues are real, but one is still positive. This equilibrium is also <dfn class="terminology">unstable</dfn>
</div>
</li>
<li id="subsec-diffeq-linearization-9-3-3">
<div class="para" id="subsec-diffeq-linearization-9-3-3-1">Equilibrium: <span class="process-math">\((a,z) = (\frac{2}{3}, \frac{1}{3})\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-3-2">Eigenvalues: <span class="process-math">\(\lambda_1 = -0.5442\text{,}\)</span> <span class="process-math">\(\lambda_2 = -0.1225\)</span>
</div>
<div class="para" id="subsec-diffeq-linearization-9-3-3-3">Both eigenvalues are real and negative. This equilibrium is <dfn class="terminology">stable</dfn>
</div>
</li>
</ol>
<div class="para">With these new parameter values, the system is stable when there are both algae and zooplankton present at equilibrium. If the population started with only algae at equilibrium <span class="process-math">\((1,0)\text{,}\)</span> then introducing just a few zooplankton will result in the zooplankton growing to reach a positive equilibrium value.</div>
</div></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="seq-diffeq-nullclines-predation-competition.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="interactions.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
