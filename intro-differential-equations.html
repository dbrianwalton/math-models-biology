<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Introduction to Differential Equations</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.10';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.c2d04816128ebb44.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.e0c6d4592e23c667.css">
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="ch-continuous-dynamics.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-continuous-dynamics.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="diffeq-population-models.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-structured-populations.html" class="internal"><span class="codenumber">3</span> <span class="title">Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-two-stage.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Two Stage Populations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-matrix-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Models for Structured Populations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Example: Mosquito Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Model Equations and Parameters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Simulation, Asymptotic Growth, and Stable Distributions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Exploring the Impact of Additional Mortality</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-density-dependent.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Density Dependence in Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-model" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Model Development</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#sec-structure-density-dependent-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Simulation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-equilibria" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Finding Fixed Points for Structured Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-partial-derivatives" class="internal"><span class="codenumber">3.4.4</span> <span class="title">Partial Derivatives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-fixed-point-stability" class="internal"><span class="codenumber">3.4.5</span> <span class="title">Testing the Stability of a Fixed Point</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-continuous-dynamics.html" class="internal"><span class="codenumber">4</span> <span class="title">Continuous Dynamics</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-rates-of-change" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-slope-fields" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Slope Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-numerical-solutions" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Numerical Solutions to Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="diffeq-population-models.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Continuous Time Population Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-popn-density-dependent" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Continuous Logistic Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-rescaling" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Dimensional Analysis and Rescaling</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-diffeq-equilibria.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Analysis of Equilibria, Drug Dosing, and the Allee effect</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-diffeq-phase-line" class="internal"><span class="codenumber">4.3.1</span> <span class="title">The Phase Line</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-equilibria-examples" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Applications</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Interacting Variables and Producer-Consumer Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-phase-plane-vector-fields" class="internal"><span class="codenumber">4.4.1</span> <span class="title">The Phase Plane and Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-systems-differential-equations" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Systems of Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Phase Plane Analysis with Nullclines, Competition and Predator-Prey Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-competition-models" class="internal"><span class="codenumber">4.5.1</span> <span class="title">Competition Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-nullcline-analysis" class="internal"><span class="codenumber">4.5.2</span> <span class="title">Nullcline Analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-predator-prey" class="internal"><span class="codenumber">4.5.3</span> <span class="title">The Predator-Prey Model</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-nullclines-code" class="internal"><span class="codenumber">4.5.4</span> <span class="title">Generating Nullcline Curves in R</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html" class="internal"><span class="codenumber">4.6</span> <span class="title">Equilibrium Analysis, Models of Love, and Linearization</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-equil-romeo-juliet" class="internal"><span class="codenumber">4.6.1</span> <span class="title">Linear Differential Equations and Romeo and Juliet</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-eigenvalues-as-rates" class="internal"><span class="codenumber">4.6.2</span> <span class="title">Linear Systems of Differential Equations and Eigenvalues</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-equilibria-love-linearization.html#subsec-diffeq-linearization" class="internal"><span class="codenumber">4.6.3</span> <span class="title">Linearization Around Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">5</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">5.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="intro-differential-equations"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">4.1</span><span class="space"> </span><span class="title">Introduction to Differential Equations</span>
</h2>
<section class="introduction" id="intro-differential-equations-2"><div class="para" id="intro-differential-equations-2-1">Sequences give us a way to model values at specific evenly spaced times. However, they do not provide a method to model values between those times. Furthermore, discrete time projeciton models are based on using the values of the state variables at one instant in time to predict a future value one time interval later. That is, the increment of change is considered to be a single bulk change in values.</div>
<div class="para" id="intro-differential-equations-2-2">We often want to consider models that allow us to predict values for a state at <em class="emphasis">any</em> time. We want to have the model describe how the state is changing continuously throughout time, rather than one bulk increment of change. The most basic mathematical tool to model continuous functions is a <dfn class="terminology">differential equation</dfn>.</div></section><section class="subsection" id="subsec-diffeq-rates-of-change"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.1.1</span><span class="space"> </span><span class="title">Rates of Change</span>
</h3>
<div class="para" id="subsec-diffeq-rates-of-change-2">In order to motivate differential equations, let us think back to population models where the population changed according to births and deaths. For discrete time models, we established functions that described <em class="emphasis">how many</em> births or deaths to add over the course of a cycle. Such a function represented the total accumulated births or deaths, regardless of exactly when those events occurred. For a continuous time model, we instead think in terms of the rate at which births and deaths are occurring.</div>
<div class="para" id="subsec-diffeq-rates-of-change-3">A <dfn class="terminology">rate of change</dfn> represents the ratio between the changes of two covarying variables. One of the simplest examples is velocity which is the rate of change of distance traveled with respect to time, for which you probably have heard the saying, distance equals rate times time. Mathematically, this is saying that the distance traveled is <em class="emphasis">proportional</em> to the time spent travelling and the rate (velocity) is the proportionality constant. However, this is technically only true for constant rates of change. Calculus introduced the <dfn class="terminology">derivative</dfn> as the mathematical quantity that measures the <dfn class="terminology">instantaneous rate of change</dfn>. This rate of change results from the idea of computing the limit of an average rate of change.</div>
<div class="para logical" id="subsec-diffeq-rates-of-change-4">
<div class="para">Consider a quantity <span class="process-math">\(Q\)</span> that is a function of time <span class="process-math">\(t\text{.}\)</span> The instantaneous rate of change of <span class="process-math">\(Q\)</span> with respect to <span class="process-math">\(t\)</span> at a particular moment <span class="process-math">\(t=a\)</span> is defined as the derivative</div>
<div class="displaymath process-math">
\begin{equation*}
\left. \frac{dQ}{dt} \right|_a = \lim_{\Delta t \to 0} \frac{Q(a+\Delta t) - Q(a)}{\Delta t}\text{.}
\end{equation*}
</div>
<div class="para">Thinking of this in reverse, this is telling us that the value <span class="process-math">\(Q(a + \Delta t)\)</span> can approximately be found as</div>
<div class="displaymath process-math">
\begin{equation*}
Q(a + \Delta t) \approx Q(a) + \left.\frac{dQ}{dt}\right|_a \cdot \Delta t\text{.}
\end{equation*}
</div>
<div class="para">That is, the increment of change in <span class="process-math">\(Q\)</span> is approximately just the derivative times the increment of time. The approximation improves as the increment of time decreases and is exact in the limit.</div>
</div>
<div class="para" id="subsec-diffeq-rates-of-change-5">Returning to our ideas of births and deaths, this suggests that instead of thinking of the total number of births and deaths in a given time period (e.g., per year), we will think of a <em class="emphasis">rate</em> of births or deaths <em class="emphasis">per unit time</em> so that in a <em class="emphasis">short</em> interval of time, the <em class="emphasis">number</em> of births or deaths is approximately that corresponding rate times the length of the time interval.</div></section><section class="subsection" id="differential-equations"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.1.2</span><span class="space"> </span><span class="title">Differential Equations</span>
</h3>
<div class="para" id="differential-equations-2">A differential equation is an equation that defines the rate of change (a derivative) for a quantity. Unlike calculus where we would start with a function’s formula and use rules of calculus to find the derivative’s formula, in modeling we are going to think of the rate of change as a state variable that can be part of an equation.</div>
<article class="example example-like" id="ex-diffeq-intro-proportional-growth"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.1.1</span><span class="period">.</span>
</h4>
<div class="para logical" id="ex-diffeq-intro-proportional-growth-1-1">
<div class="para">We know that a population that is not constrained by its environment tends to grow exponentially. That is, we can think of the population as a function of time <span class="process-math">\(P(t)\)</span> as satisfying an exponential model,</div>
<div class="displaymath process-math">
\begin{equation*}
P(t) = Ae^{rt}\text{,}
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(A\)</span> and <span class="process-math">\(r\)</span> are appropriate constants. The rate of change with respect to time can be calculated using calculus rules to find</div>
<div class="displaymath process-math">
\begin{equation*}
P'(t) = Are^{rt}\text{.}
\end{equation*}
</div>
</div> <div class="para logical" id="ex-diffeq-intro-proportional-growth-1-2">
<div class="para">We can identify a relation between the state variables of <span class="process-math">\(P\)</span> and <span class="process-math">\(P'\)</span> by calculating the ratio <span class="process-math">\(P' / P\)</span> and simplifying. Since <span class="process-math">\(P'\)</span> is the overall rate of change and <span class="process-math">\(P\)</span> is the population, the ratio refers to the <dfn class="terminology">per capita rate of change</dfn>. Using the exponential formula and its derivative, we discover that an exponentially growing (or decaying) population satisfies the equation</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{P'}{P} = \frac{Are^{rt}}{Ae^{rt}} = r\text{.}
\end{equation*}
</div>
<div class="para">Exponential growth exactly corresponds to having a constant per capita rate of change. That is, we have a differential equation</div>
<div class="displaymath process-math">
\begin{equation*}
P' = r P
\end{equation*}
</div>
<div class="para">that corresponds to a population model <span class="process-math">\(P(t) = Ae^{rt}\text{.}\)</span>
</div>
</div></article><div class="para logical" id="differential-equations-4">
<div class="para">Notice in the previous example that when we started with the differential equation</div>
<div class="displaymath process-math">
\begin{equation*}
P' = r P
\end{equation*}
</div>
<div class="para">the formula for solutions had the form</div>
<div class="displaymath process-math">
\begin{equation*}
P(t) = Ae^{rt}\text{.}
\end{equation*}
</div>
<div class="para">The value of <span class="process-math">\(r\)</span> is part of the differential equation. But the value of <span class="process-math">\(A\)</span> is unspecified, meaning it is free to choose. We are allowed to solve for a specific value for <span class="process-math">\(A\)</span> in order to match an initial condition.</div>
</div>
<article class="example example-like" id="differential-equations-5"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.1.2</span><span class="period">.</span>
</h4>
<div class="para logical" id="differential-equations-5-1-1">
<div class="para">Find a solution to the differential equation</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{dP}{dt} = 3 P
\end{equation*}
</div>
<div class="para">that has initial value <span class="process-math">\(P(0) = 5\text{.}\)</span>
</div>
</div>
<div class="solutions"><details id="differential-equations-5-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para logical" id="differential-equations-5-2-1">
<div class="para">Time-dependent variables (functions of time) whose derivatives are proportional to the value of the variable must be exponential. Our example has proportionality constant <span class="process-math">\(r=3\text{,}\)</span> so the solutions have the form</div>
<div class="displaymath process-math">
\begin{equation*}
P(t) = Ae^{3t}\text{.}
\end{equation*}
</div>
</div>
<div class="para logical" id="differential-equations-5-2-2">
<div class="para">To find the value of <span class="process-math">\(A\text{,}\)</span> we use the model formula with <span class="process-math">\(t=0\)</span> and use it to match the given information <span class="process-math">\(P(0) = 5\text{.}\)</span> From our formula, we have</div>
<div class="displaymath process-math">
\begin{equation*}
P(0) = Ae^{3 \cdot 0} = Ae^0 = A\text{.}
\end{equation*}
</div>
<div class="para">Because we know <span class="process-math">\(P(0) = A\)</span> (from the model formula) and <span class="process-math">\(P(0) = 5\)</span> (from the initial condition), we must have <span class="process-math">\(A = 5\text{.}\)</span> That is, <span class="process-math">\(P(t) = 5e^{3t}\)</span> satisfies both the differential equation and the initial condition.</div>
</div>
</div></details></div></article><div class="para" id="differential-equations-6">Mathematics courses focusing on solving differential equations introduce strategies for finding formulas for solutions to differential equations. Because many applications of differential equations don’t actually have formula solutions, we will focus on the behavior of solutions and use computational methods to approximate those solutions.</div></section><section class="subsection" id="subsec-diffeq-slope-fields"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.1.3</span><span class="space"> </span><span class="title">Slope Fields</span>
</h3>
<div class="para" id="subsec-diffeq-slope-fields-2">To help us understand what a differential equation does, we start by learning about a <dfn class="terminology">slope field</dfn>. In the context of differential equations and in many scientific contexts, a field refers to a measurement that can vary as you move to different points in space. An electric field represents the potential force that would be applied to a charged particle based on its relative position to other charges in space. A gravitational field represents the potential force that would be applied to a mass based on the presence of other masses in space. A <dfn class="terminology">slope field</dfn> indicates that at every point in space, we have an associated slope.</div>
<div class="para logical" id="subsec-diffeq-slope-fields-3">
<div class="para">For differential equations, we think of our space as consisting of the time and the state. For a single state variable, say a measure of population <span class="process-math">\(P\)</span> as in our earlier example, our space will be characterized by time <span class="process-math">\(t\)</span> and the population <span class="process-math">\(P\text{.}\)</span> Consider the differential equation <span class="process-math">\(P' = 3P\text{.}\)</span> The right hand side is a formula that declares a value for the slope as it depends on the current value of <span class="process-math">\(P\text{.}\)</span> Consequently, at every point <span class="process-math">\((t,P)\)</span> in our space, we can calculate a slope given by <span class="process-math">\(3P\text{.}\)</span> This is a slope field, and we would typically represent it as a function</div>
<div class="displaymath process-math">
\begin{equation*}
f(t,P) = 3P\text{.}
\end{equation*}
</div>
</div>
<article class="example example-like" id="subsec-diffeq-slope-fields-4"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.1.3</span><span class="period">.</span>
</h4>
<div class="para logical" id="subsec-diffeq-slope-fields-4-1-1">
<div class="para">Given the slope field <span class="process-math">\(f(t,P) = 3P\text{,}\)</span> find the slope at each of the following points.</div>
<ol class="decimal" id="subsec-diffeq-slope-fields-4-1-1-2">
<li id="subsec-diffeq-slope-fields-4-1-1-2-1"><div class="para" id="subsec-diffeq-slope-fields-4-1-1-2-1-1"><span class="process-math">\(\displaystyle (t,P) = (0,1)\)</span></div></li>
<li id="subsec-diffeq-slope-fields-4-1-1-2-2"><div class="para" id="subsec-diffeq-slope-fields-4-1-1-2-2-1"><span class="process-math">\(\displaystyle (t,P) = (1,-2)\)</span></div></li>
<li id="subsec-diffeq-slope-fields-4-1-1-2-3"><div class="para" id="subsec-diffeq-slope-fields-4-1-1-2-3-1"><span class="process-math">\(\displaystyle (t,P) = (0,3)\)</span></div></li>
<li id="subsec-diffeq-slope-fields-4-1-1-2-4"><div class="para" id="subsec-diffeq-slope-fields-4-1-1-2-4-1"><span class="process-math">\(\displaystyle (t,P) = (1,3)\)</span></div></li>
</ol>
</div>
<div class="solutions"><details id="subsec-diffeq-slope-fields-4-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content"><div class="para logical" id="subsec-diffeq-slope-fields-4-2-1">
<div class="para">This is not much more than evaluating the formula.</div>
<ol class="decimal" id="subsec-diffeq-slope-fields-4-2-1-1">
<li id="subsec-diffeq-slope-fields-4-2-1-1-1"><div class="para" id="subsec-diffeq-slope-fields-4-2-1-1-1-1">At <span class="process-math">\((t,P) = (0,1)\text{,}\)</span> the slope will be <span class="process-math">\(f(0,1) = 3(1) = 3\text{.}\)</span>
</div></li>
<li id="subsec-diffeq-slope-fields-4-2-1-1-2"><div class="para" id="subsec-diffeq-slope-fields-4-2-1-1-2-1">At <span class="process-math">\((t,P) = (1,-2)\text{,}\)</span> the slope will be <span class="process-math">\(f(1,-2) = 3(-2) = -6\text{.}\)</span>
</div></li>
<li id="subsec-diffeq-slope-fields-4-2-1-1-3"><div class="para" id="subsec-diffeq-slope-fields-4-2-1-1-3-1">At <span class="process-math">\((t,P) = (0,3)\text{,}\)</span> the slope will be <span class="process-math">\(f(0,3) = 3(3) = 9\text{.}\)</span>
</div></li>
<li id="subsec-diffeq-slope-fields-4-2-1-1-4"><div class="para" id="subsec-diffeq-slope-fields-4-2-1-1-4-1">At <span class="process-math">\((t,P) = (1,3)\text{,}\)</span> the slope will be <span class="process-math">\(f(1,3) = 3(3) = 9\text{.}\)</span>
</div></li>
</ol>
</div></div></details></div></article><div class="para" id="subsec-diffeq-slope-fields-5">We visualize a slope field by drawing short line segments or arrows at specially chosen points, often using a grid, so that those segments have slopes matching the value of the slope field. In R using <code class="code-inline tex2jax_ignore">ggplot</code>, this is accomplished with a geometry layer called <code class="code-inline tex2jax_ignore">geom_quiver</code>. This requires an additional library <code class="code-inline tex2jax_ignore">ggquiver</code> be installed before it can be used.</div>
<div class="para" id="subsec-diffeq-slope-fields-6">Our plot will be treated almost like a scatter plot using <code class="code-inline tex2jax_ignore">geom_point</code> that specifies variables for <code class="code-inline tex2jax_ignore">x</code> and <code class="code-inline tex2jax_ignore">y</code>, except that our mapping must also include to additional variables <code class="code-inline tex2jax_ignore">u</code> and <code class="code-inline tex2jax_ignore">v</code> that will represent a displacement or rate associated with the <span class="process-math">\(x\)</span>- and <span class="process-math">\(y\)</span>-directions. Because slope graphically represents a rise over run, we will think of <code class="code-inline tex2jax_ignore">u</code> as dictating a “run” while we think of <code class="code-inline tex2jax_ignore">v</code> is dictating a “rise”. Using <code class="code-inline tex2jax_ignore">u=1</code> allows us to let <code class="code-inline tex2jax_ignore">v</code> be the value of the slope field.</div>
<div class="para" id="subsec-diffeq-slope-fields-7">Below is a simple implementation of a slope field for the four points in the previous example. We start with a simple data frame containing the <span class="process-math">\(t\)</span>- and <span class="process-math">\(P\)</span>-values where our slopes were calculated. We will let a function perform the calculations for us.</div>
<figure class="listing figure-like" id="subsec-diffeq-slope-fields-8"><div class="code-box"><pre class="program"><code class="language-r"># Load the libraries
library(ggplot2)
library(ggquiver)
library(dplyr)

# Create the initial data frame
my_pts &lt;- tibble(t = c(0, 1, 0, 1), P = c(1, -2, 3, 3))

# Define the slope field function
slope &lt;- function(t, P) { 3*P }

# Start with the location of points
slope_field &lt;- my_pts |&gt;
    # Then add columns for the dt and dP using slope field
    mutate(delta_t = 1,
           delta_P = slope(t, P)) |&gt;
    # Then feed this into ggplot
    ggplot(mapping = aes(x = t, y = P,              # Location
                         u = delta_t, v = delta_P)  # Directions
           ) +
    # And create the quiver graphics layer
    geom_quiver(color = "blue")
show(slope_field)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.1.4<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="fig-diffeq-first-slopefield"><div class="image-box" style="width: 50%; margin-left: 25%; margin-right: 25%;"><img src="external/images/diffeq-first-slopefield.png" class="contained" alt="quiver plot showing line segments with slopes matching the slope field"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.1.5<span class="period">.</span></span><span class="space"> </span>Illustration of the four calculated slopes for the slope field <span class="process-math">\(f(t,P) = 3P\)</span></figcaption></figure><div class="para" id="subsec-diffeq-slope-fields-10">It is much more informative if the slope field is visualized at a collection of points that form a regular grid in space. We will first define a grid by identifying specific <span class="process-math">\(t\)</span> and <span class="process-math">\(P\)</span> values and then construct the collection of all points from this grid. The rest of the calculations are essentially unchanged. It often takes some experimentation on the spacing chosen for the grid (see the <code class="code-inline tex2jax_ignore">by</code> argument to <code class="code-inline tex2jax_ignore">seq</code>) and the scale for the arrows (see the <code class="code-inline tex2jax_ignore">vecsize</code> argument to <code class="code-inline tex2jax_ignore">geom_quiver</code>) to get arrows that have nice spacing and length. Steeper arrows always have longer lengths.</div>
<figure class="listing figure-like" id="subsec-diffeq-slope-fields-11"><div class="code-box"><pre class="program"><code class="language-r"># Load the libraries
library(ggplot2)
library(ggquiver)
library(dplyr)

# Create the initial grid of points
my_pts &lt;- expand.grid(t = seq(0, 2, by = 0.1),
                      P = seq(-3.2, 3.2, by = 0.4))

# Define the slope field function
slope &lt;- function(t, P) { 3*P }

# Start with the location of points
slope_field_data &lt;- my_pts |&gt;
    # Then add columns for the dt and dP using slope field
    mutate(delta_t = 1,
           delta_P = slope(t, P))

# Then feed this into ggplot
ggplot(data = slope_field_data,
       mapping = aes(x = t, y = P,              # Location
                     u = delta_t, v = delta_P)  # Directions
    ) +
    # And create the quiver graphics layer
    geom_quiver(color = "blue", vecsize = 4)
show(slope_field)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.1.6<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="fig-diffeq-slopefield-grid"><div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;"><img src="external/images/diffeq-slopefield-grid.png" class="contained" alt="quiver plot showing line segments with slopes matching the slope field"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.1.7<span class="period">.</span></span><span class="space"> </span>Illustration of the four calculated slopes for the slope field <span class="process-math">\(f(t,P) = 3P\)</span></figcaption></figure><div class="para" id="subsec-diffeq-slope-fields-13">A slope field is related to a solution of a differential equation. If the graph of the solution, which is a function of time <span class="process-math">\(t\text{,}\)</span> is superimposed on top of a slope field, then at <em class="emphasis">every point</em> along the curve of the function, the tangent line must <em class="emphasis">match</em> the slope of the slope field. In other words, a solution <em class="emphasis">follows</em> the directions provided by the slope field, always smoothly staying parallel to the nearest segments.</div>
<div class="para" id="subsec-diffeq-slope-fields-14">The previous code listing defined <code class="code-inline tex2jax_ignore">slope_field</code> as the plot showing the slope field. We can build on top of that graph additional layers that represent different solutions. We know that solutions to <span class="process-math">\(P' = 3P\)</span> all have the form <span class="process-math">\(P(t) = Ae^{3t}\text{,}\)</span> so we will include several choices of functions with different values of <span class="process-math">\(A\text{.}\)</span>
</div>
<figure class="listing figure-like" id="subsec-diffeq-slope-fields-15"><div class="code-box"><pre class="program"><code class="language-r"># Start adding solutions as additional layers
soln_curves &lt;- slope_field +
    geom_function(fun = function(t) { 0.5*exp(3*t) }, linewidth=1) +
    geom_function(fun = function(t) { 0.01*exp(3*t) }, linewidth=1) +
    geom_function(fun = function(t) { -0.04*exp(3*t) }, linewidth=1) +
    geom_function(fun = function(t) { -1*exp(3*t) }, linewidth=1) +
    coord_cartesian(ylim=c(-4, 4))  # Required to keep the same viewing window
show(soln_curves)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.1.8<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="fig-diffeq-slopefield-solutions"><div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;"><img src="external/images/diffeq-slopefield-solutions.png" class="contained" alt="slope field with four solutions included"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.1.9<span class="period">.</span></span><span class="space"> </span>Graph showing solutions of the form <span class="process-math">\(P = Ae^{3t}\)</span> superimposed on the corresponding slope field <span class="process-math">\(f(t,P)=3P\text{.}\)</span></figcaption></figure></section><section class="subsection" id="subsec-diffeq-numerical-solutions"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">4.1.4</span><span class="space"> </span><span class="title">Numerical Solutions to Differential Equations</span>
</h3>
<div class="para logical" id="subsec-diffeq-numerical-solutions-2">
<div class="para">A general differential equation for a single time-dependent state variable <span class="process-math">\(Q\)</span> will take the form</div>
<div class="displaymath process-math">
\begin{equation*}
Q'(t) = F(t, Q(t))\text{.}
\end{equation*}
</div>
<div class="para">The function <span class="process-math">\(F\)</span> is not the derivative itself but represents the formula for the slope field. The differential equation says that the value of the rate of change, <span class="process-math">\(Q'(t)\text{,}\)</span> will exactly the slope of the slope field at each point <span class="process-math">\((t, Q(t))\)</span> along its curve. To select a single solution, we also need to provide a starting point, called an <dfn class="terminology">initial condition</dfn>.</div>
</div>
<div class="para" id="subsec-diffeq-numerical-solutions-3">The following theorem guarantees that a differential equation with an initial value has a unique solution under reasonable conditions.</div>
<article class="theorem theorem-like" id="thm-diffeq-existence-uniqueness"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">4.1.10</span><span class="period">.</span><span class="space"> </span><span class="title">Existence and Uniqueness of Initial Value Problems.</span>
</h4>
<div class="para logical" id="thm-diffeq-existence-uniqueness-2-1">
<div class="para">Suppose that <span class="process-math">\(F(t,y)\)</span> represents a continuous function of both <span class="process-math">\(t\)</span> and <span class="process-math">\(y\)</span> such that <span class="process-math">\(\frac{\partial F}{\partial y}\)</span> exists and is bounded (i.e., small changes in <span class="process-math">\(y\)</span> should result in small changes in <span class="process-math">\(F(t,y)\text{.}\)</span> Then the differential equation</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{dQ}{dt} = F(t,Q)
\end{equation*}
</div>
<div class="para">with initial value <span class="process-math">\(Q(a) = b\)</span> has a unique solution for some interval <span class="process-math">\(t \in (a-\epsilon, a+\epsilon)\)</span> with <span class="process-math">\(\epsilon \gt 0\text{.}\)</span>
</div>
</div></article><div class="para" id="subsec-diffeq-numerical-solutions-5">The existence property guarantees that a solution will exist on some small interval near the initial value. This gives us a justification for trying to find what that solution looks like. When we look for solutions, we do need to be mindful that we might try to use an interval that is larger than the solution can actually use. So if our method fails, we might need to try a smaller interval of time. The uniqueness property indicates that for any initial value, there can only be one solution that includes that point.</div>
<div class="para" id="subsec-diffeq-numerical-solutions-6">To find numerical approximations of solutions in R, we will use the <code class="code-inline tex2jax_ignore">deSolve</code> library. This library defines a command <code class="code-inline tex2jax_ignore">ode</code> (the letters stand for <em class="emphasis">ordinary differential equation</em>) that will calculate data points to represent these approximate solutions. To solve our equation, we will need to define a function that calculates the function on the right-hand side of the equation. This will be very similar to the functions we used to calculate slope fields, but with some more technical requirements to deal with the variety of problems <code class="code-inline tex2jax_ignore">ode</code> might encounter. The <code class="code-inline tex2jax_ignore">ode</code> command also requires that we provide the initial condition and an array of times at which we will evaluate the solution.</div>
<div class="para" id="subsec-diffeq-numerical-solutions-7">The R function calculating the rate of change or slope required for <code class="code-inline tex2jax_ignore">ode</code> is always expected to have three arguments—one for the time <code class="code-inline tex2jax_ignore">t</code>, one for the state <code class="code-inline tex2jax_ignore">state</code>, and one for model parameters <code class="code-inline tex2jax_ignore">params</code>. Both <code class="code-inline tex2jax_ignore">state</code> and <code class="code-inline tex2jax_ignore">params</code> are intended to allow for more than one variable, so entries are named. So that our calculations for the rate of change at the current time and state are allowed to use those internal names, we put our calculations inside of a <code class="code-inline tex2jax_ignore">with</code> command. The first argument for <code class="code-inline tex2jax_ignore">with</code> is a list of named values (we join <code class="code-inline tex2jax_ignore">state</code> and <code class="code-inline tex2jax_ignore">params</code> into a single list) that we might use in our formulas, and the second argument is a command or command block inside curly braces that does the calculation. Finally, when a state has multiple variables, we will need to report a rate of change for each variable. Consequently, <code class="code-inline tex2jax_ignore">ode</code> expects that our function returns a <code class="code-inline tex2jax_ignore">list</code> of rates rather than just a number. Unfortunately, I have not yet found a way to use the same function for the slope field and for <code class="code-inline tex2jax_ignore">ode</code> because of these different requirements.</div>
<article class="example example-like" id="subsec-diffeq-numerical-solutions-8"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">4.1.11</span><span class="period">.</span>
</h4>
<div class="para logical" id="subsec-diffeq-numerical-solutions-8-1-1">
<div class="para">We will find a numerical approximation for the solution of the differential equation</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{dQ}{dt} = 3Q
\end{equation*}
</div>
<div class="para">with the intial value <span class="process-math">\(Q(1) = 0.25\)</span> and include it with the slope field generated earlier.</div>
</div> <div class="para" id="subsec-diffeq-numerical-solutions-8-1-2">Our R script will need to first call <code class="code-inline tex2jax_ignore">library(deSolve)</code>. Then we will define our rate function to represent the formula <span class="process-math">\(3Q\)</span> as described. The state will only consist of the single variable <span class="process-math">\(Q\text{.}\)</span> Our model does not have any additional parameters, so the parameters will not actually be used in this example. Once the differential equation is defined, we provide the initial value and times we wish to evaluate.</div> <figure class="listing figure-like" id="subsec-diffeq-numerical-solutions-8-1-3"><div class="code-box"><pre class="program"><code class="language-r"># Load the library
library(deSolve)

# Define the rate function in this form
rateFcn &lt;- function(t, state, params) {
    with(as.list(c(state, params)), {  
        Q_rate &lt;- 3*Q   # Calculate the rate
        list(Q_rate)    # Return the rate in list
    })  # Close the block and end the with command
} # End the function

# Define the initial condition
init_state &lt;- c(Q = 0.25)   # (named array of values)
params &lt;- c()               # empty = no parameters

# Create an array of times where we evaluate
# We choose the interval of calculation
times &lt;- seq(from = 1, to = 2, by = 0.1)

# Find the solution
solution &lt;- ode(init_state, times, rateFcn, params)
# Result has column for time and each state variable

# Create a graph with both the slope field and the solution
numsoln_graph &lt;- ggplot() +
    geom_quiver(data = slope_field_data,
                mapping = aes(x = t, y = P,
                u = delta_t, v = delta_P),
                color = "blue", vecsize = 4) +
    geom_line(data = solution,
             mapping = aes(x = time, y = Q),
             color="purple", linewidth = 1)
show(numsoln_graph)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">4.1.12<span class="period">.</span></span><span class="space"> </span>R script to generate numerical solution to differential equation</figcaption></figure> <figure class="figure figure-like" id="fig-diffeq-slopefield-numerical-solution"><div class="image-box" style="width: 80%; margin-left: 10%; margin-right: 10%;"><img src="external/images/diffeq-slopefield-numerical-solution.png" class="contained" alt="slope field with a numerical solution"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">4.1.13<span class="period">.</span></span><span class="space"> </span>Graph showing a numerical solution superimposed on the corresponding slope field <span class="process-math">\(f(t,P)=3P\text{.}\)</span></figcaption></figure></article></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="ch-continuous-dynamics.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="diffeq-population-models.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
