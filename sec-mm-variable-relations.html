<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Relations between Variables</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.5';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.82032a8574f6ce75.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.6a985cbf816db5c7.css">
<style>
#ex-measure-distance-conversions-1-1-1 { counter-set: ex-measure-distance-conversions-1-1-1 0; }
#ex-measure-distance-conversions-1-1-1 > li::marker { content: "("counter(ex-measure-distance-conversions-1-1-1,lower-alpha)")"; }
#ex-measure-distance-conversions-1-1-1 > li { counter-increment: ex-measure-distance-conversions-1-1-1; }
#ex-measure-geometric-dimensions-1-1-2 { counter-set: ex-measure-geometric-dimensions-1-1-2 0; }
#ex-measure-geometric-dimensions-1-1-2 > li::marker { content: "("counter(ex-measure-geometric-dimensions-1-1-2,lower-alpha)")"; }
#ex-measure-geometric-dimensions-1-1-2 > li { counter-increment: ex-measure-geometric-dimensions-1-1-2; }
</style>
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-mm-intro-ggplot.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="mathematical-modeling.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="populations.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section active"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">2.8</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#rate-of-change" class="internal"><span class="codenumber">2.8.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">2.8.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#numerical-solutions-diffeq" class="internal"><span class="codenumber">2.8.3</span> <span class="title">Solutions to Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#slope-fields" class="internal"><span class="codenumber">2.8.4</span> <span class="title">Slope Fields</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="differential-equation-analysis.html" class="internal"><span class="codenumber">2.9</span> <span class="title">Analysis of Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-equilibria" class="internal"><span class="codenumber">2.9.1</span> <span class="title">Equilibria for Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-phase-line" class="internal"><span class="codenumber">2.9.2</span> <span class="title">Phase Lines</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">3</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">3.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">3.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">3.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">3.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">3.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">3.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">3.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">3.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-mm-variable-relations"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">1.6</span><span class="space"> </span><span class="title">Relations between Variables</span>
</h2>
<div class="para" id="sec-mm-variable-relations-2">In the previous section, we explored the US census population data set as the variables of <code class="code-inline tex2jax_ignore">Births</code>, <code class="code-inline tex2jax_ignore">Deaths</code>, and <code class="code-inline tex2jax_ignore">Populations</code> changed with <code class="code-inline tex2jax_ignore">Year</code>. Mathematical models are often built by exploring the relations between the state variables themselves other than time. How do birth and death rates relate to the population size? We can start to visualize this by creating a plot.</div>
<div class="para" id="sec-mm-variable-relations-3">We will work with the same data file <a class="external" href="external/data/US-population-data.csv" target="_blank"><code class="code-inline tex2jax_ignore">US-population-data.csv</code></a>. Using the same basic pattern as the previous work, we will load the data into R using <code class="code-inline tex2jax_ignore">read_csv</code> and then restrict to the years of interest using <code class="code-inline tex2jax_ignore">filter</code>. This time we will want to be plotting points <span class="process-math">\((x,y)\)</span> where <span class="process-math">\(x\)</span>-values correspond to the <code class="code-inline tex2jax_ignore">Population</code> values and <span class="process-math">\(y\)</span>-values correspond to the <code class="code-inline tex2jax_ignore">Births</code> and <code class="code-inline tex2jax_ignore">Deaths</code>. As there are two distinct types of <span class="process-math">\(y\)</span>-values, we will again use <code class="code-inline tex2jax_ignore">pivot_longer</code> to create a tidy version of the data for plotting.</div>
<figure class="listing figure-like" id="listing-US-popn-rates-vs-population-1"><div class="code-box"><pre class="program"><code class="language-none">library(readr)    # To load CSV files (read_csv)
library(dplyr)    # To reorganize (filter)
library(tidyr)    # To tidy data (pivot_longer)
library(ggplot2)  # To work with graphs (ggplot)

# Load the data from a file
US_population_data &lt;- read_csv("US-population-data.csv", 
    skip = 5)

# Focus on the the years 1991-2010
focus_population_data &lt;- filter(US_population_data, Year &gt;= 1991 &amp; Year &lt; 2010)

# Reorganize to plot Births, Deaths vs Population
pivot_longer(focus_population_data,
        cols = c(Births, Deaths),  # these columns get separate rows
        names_to = "Rate_Type",    # category column
        values_to = "Rate"         # column for actual values
) |&gt;
# And pipe the resulting frame into ggplot
ggplot(mapping = aes(x = Population, y = Rate, 
            color = Rate_Type, shape = Rate_Type)
    ) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.1<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 85%; margin-left: 7.5%; margin-right: 7.5%;"><img src="external/images/US-rates-population-v-rates-01.png" class="contained"></div>
<div class="para" id="sec-mm-variable-relations-6">From the resulting figure, we can see that the birth rate goes up and down in an unusual manner. This is typical in human populations, where birth rates are affected significantly by socioeconomic and political conditions. The death rate on the other hand appears to steadily increase with an increase in the population size. So we will spend some time in this section exploring that relationship.</div>
<div class="para" id="sec-mm-variable-relations-7">The simplest models for relationships are constant and linear relations. Let us look at the possibility of a linear relation between the death rate and the population size. We can add a best-fit line to our data and see what it looks like. The following script assumes that we have already imported the data as shown in the previous listing. Because we are looking at just the <code class="code-inline tex2jax_ignore">Deaths</code> for <span class="process-math">\(y\)</span>-values, we will revert back to the original data structure.</div>
<figure class="listing figure-like" id="listing-US-popn-rates-vs-population-2"><div class="code-box"><pre class="program"><code class="language-none">ggplot(focus_population_data,
        mapping = aes(x = Population, y = Deaths)
    ) +
    geom_point(color = "green") +
    geom_smooth(method = "lm", formula = y ~ x, se = FALSE)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.2<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para" id="sec-mm-variable-relations-9">The geometric object that was added is <code class="code-inline tex2jax_ignore">geom_smooth</code>, which has several different methods. The method we used is <code class="code-inline tex2jax_ignore">lm</code> which stands for “linear model”. The associated <code class="code-inline tex2jax_ignore">formula</code> option indicates that we want a linear model where <span class="process-math">\(y\)</span> is a linear function of <span class="process-math">\(x\text{.}\)</span> The option <code class="code-inline tex2jax_ignore">se = FALSE</code> indicates that we do not want to include the “standard error” as part of our linear model. Change this to <code class="code-inline tex2jax_ignore">TRUE</code> to see the effect, which essentially shows how much confidence we have that given the data, a linear model would be predicting a linear model values.</div>
<div class="para" id="sec-mm-variable-relations-10">Adding the graph of the line does not show us the formula for the model. We need to make a new call to find the values. Before introducing the command, recall that the standard high school representation of a line uses the form <span class="process-math">\(y = mx + b\text{,}\)</span> where <span class="process-math">\(m\)</span> is the slope of the line and <span class="process-math">\(b\)</span> is the <span class="process-math">\(y\)</span>-intercept, meaning the point <span class="process-math">\((0,b)\)</span> is on the line. The symbols <span class="process-math">\(m\)</span> and <span class="process-math">\(b\text{,}\)</span> although common, are not actually standard. For example, in physics, <span class="process-math">\(m\)</span> more commonly refers to <em class="emphasis">mass</em>. We could instead use a model <span class="process-math">\(y = a + bx\text{,}\)</span> and with this representation, <span class="process-math">\(a\)</span> is the <span class="process-math">\(y\)</span>-intercept and <span class="process-math">\(b\)</span> is the slope.</div>
<div class="para" id="sec-mm-variable-relations-11">In R, the method that we use to find the best linear model is <code class="code-inline tex2jax_ignore">lm</code>. The first argument is <code class="code-inline tex2jax_ignore">formula</code>, which wants to know which columns in our data are related. The <em class="emphasis">dependent</em> variable goes on the <em class="emphasis">left</em> of the formula. The <em class="emphasis">right</em> side of the formula is going to be a sum of columns that each are included with their individual slope terms. And the two sides of the formula are connected with a <em class="emphasis">tilde</em> symbol <code class="code-inline tex2jax_ignore">~</code>. In our example, we want a model <code class="code-inline tex2jax_ignore">Deaths ~ Population</code> because we want to predict <code class="code-inline tex2jax_ignore">Deaths</code> (dependent variable) as a linear function of <code class="code-inline tex2jax_ignore">Population</code> (explanatory or independent variable). The result of our call will be a structure that gives an <em class="emphasis">intercept</em> and a coefficient for <code class="code-inline tex2jax_ignore">Population</code>. (Results are shown following the code that you input.)</div>
<figure class="listing figure-like" id="listing-lm-deaths-vs-population"><div class="code-box"><pre class="program"><code class="language-none">lm(formula = Deaths ~ Population, data = focus_population_data)
</code></pre></div>
<div class="code-box"><pre class="console">Call:
lm(formula = Deaths ~ Population, data = focus_population_data)
 
Coefficients:
(Intercept)   Population  
9.160e+05    5.215e-03
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.3<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para logical" id="sec-mm-variable-relations-13">
<div class="para">The results of the linear model calculation tell us that the intercept is 9.160e+05 and the coefficient for <code class="code-inline tex2jax_ignore">Population</code> is 5.215e-03. Using these values in the equation of a line, and using <span class="process-math">\(P\)</span> for <code class="code-inline tex2jax_ignore">Population</code> and <span class="process-math">\(D\)</span> for <code class="code-inline tex2jax_ignore">Deaths</code>, we get a model equation</div>
<div class="displaymath process-math">
\begin{equation*}
D = 9.16 \times 10^5 + 5.215 \times 10^{-3} \cdot P.
\end{equation*}
</div>
</div>
<div class="para logical" id="sec-mm-variable-relations-14">
<div class="para">Another very important linear model is a <dfn class="terminology">proportional</dfn> model. This corresponds to a linear model where the intercept is required to be 0. The equation <span class="process-math">\(y = 2 + 3x\)</span> is a linear model but is not proportional. The equation <span class="process-math">\(y = 0 + 3x\text{,}\)</span> or more simply <span class="process-math">\(y = 3x\text{,}\)</span> is a proportional model. We can find the best proportinal model using <code class="code-inline tex2jax_ignore">lm</code> by using a formula with structure <code class="code-inline tex2jax_ignore">y ~ 0 + x</code>, and by explicitly adding “0”, we force the intercept value to be 0 and then find the best matching slope coefficients. The following listing shows that our best proportional regression model would be given by</div>
<div class="displaymath process-math">
\begin{equation*}
D = 0.008455 P.
\end{equation*}
</div>
</div>
<figure class="listing figure-like" id="listing-lm-deaths-vs-population-proportional"><div class="code-box"><pre class="program"><code class="language-none">lm(formula = Deaths ~ 0 + Population, data = focus_population_data)
</code></pre></div>
<div class="code-box"><pre class="console">Call:
lm(formula = Deaths ~ 0 + Population, data = focus_population_data)
 
Coefficients:
Population  
0.008455
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.4<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para" id="sec-mm-variable-relations-16">What do we do about other models? For example, can we find the best quadratic model? Some tools, like <a class="external" href="" target="_blank"><code class="code-inline tex2jax_ignore">Desmos</code></a>, make this very easy. R, which was written as a statistical software package, was designed to work with data sets and not formulas. However, we can work around this quite easily.</div>
<div class="para logical" id="sec-mm-variable-relations-17">
<div class="para">If our data set has multiple explanatory variables <span class="process-math">\(X_1\text{,}\)</span> <span class="process-math">\(X_2\text{,}\)</span> and <span class="process-math">\(X_3\)</span> for a dependent variable <span class="process-math">\(Y\text{,}\)</span> the generalization of a simiple linear model takes the form</div>
<div class="displaymath process-math">
\begin{equation*}
Y = a + b_1 X_1 + b_2 X_2 + b_3 X_3\text{.}
\end{equation*}
</div>
<div class="para">We still have an intercept <span class="process-math">\(a\)</span> along with separate slope coefficients for each of the explanatory variables. To find the best fit model of this form, we would use <code class="code-inline tex2jax_ignore">formula = Y ~ X1 + X2 + X3</code>.</div>
</div>
<div class="para logical" id="sec-mm-variable-relations-18">
<div class="para">To get models like quadratics or other polynomials, we can find the coefficients we need by engineering new columns in our data set. For example, a quadratic model for our death rate would have the form</div>
<div class="displaymath process-math">
\begin{equation*}
D = a + b P + c P^2\text{.}
\end{equation*}
</div>
<div class="para">Our data set already has a column for <span class="process-math">\(P\)</span> with <code class="code-inline tex2jax_ignore">Population</code>. We need to generate a new column containing <span class="process-math">\(P^2\text{.}\)</span> The function that adds new calculated columns is <code class="code-inline tex2jax_ignore">mutate</code> command in the <code class="code-inline tex2jax_ignore">dplyr</code> library. We will use the <dfn class="terminology">pipe</dfn> method to illustrate the steps we need.</div>
</div>
<figure class="listing figure-like" id="listing-lm-deaths-vs-population-quadratic"><div class="code-box"><pre class="program"><code class="language-none">expand_data &lt;- focus_population_data |&gt;    # Start with our data
    select(P = Population, D = Deaths) |&gt;    # Keep only P and D 
    mutate(P2 = P^2)                            # Add column for P^2
    
lm(formula = D ~ P + P2, data = expand_data)
</code></pre></div>
<div class="code-box"><pre class="console">Call:
lm(formula = D ~ P + P2, data = expand_data)

Coefficients:
(Intercept)            P           P2  
 -9.163e+06    7.684e-02   -1.269e-10
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.5<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para logical" id="sec-mm-variable-relations-20">
<div class="para">As a result of this calculation, our best quadratic model given the data is given by the model</div>
<div class="displaymath process-math">
\begin{equation*}
D = -9.163 \times 10^6 + 7.684 \times 10^{-2} P - 1.269 \times 10^{-10} P^2\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="sec-mm-variable-relations-21">As you can see, the summary of our calculation only gave four significant digits to each of the coefficients. When working with population sizes on the order of <span class="process-math">\(10^8\)</span> (hundreds of millions), small changes in the coefficients can result in fairly noticable differences in calculated values. If we want to have more digits, we need to look at the returned structure directly and not just the summary that is provided by the call. Assign a name to the result of the <code class="code-inline tex2jax_ignore">lm</code> call and then examine the <code class="code-inline tex2jax_ignore">coefficients</code> stored in the result.</div>
<figure class="listing figure-like" id="listing-lm-deaths-vs-population-quadratic-2"><div class="code-box"><pre class="program"><code class="language-none">D_model &lt;- lm(formula = D ~ P + P2, data = expand_data)
D_model$coefficients
</code></pre></div>
<div class="code-box"><pre class="console">(Intercept)               P            P2  
-9.163022e+06  7.683889e-02 -1.268641e-10
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.6<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para logical" id="sec-mm-variable-relations-23">
<div class="para">Again, because R was not designed to work with formulas but with data, there is not an automatic method to draw the curve we want based on this best quadratic fit. We need to know how to graph a function instead of data. The graph of a continuous function can be approximated by using a sequence of calculated points connected together to form a curve. Our task is to do the following:</div>
<ul class="disc" id="sec-mm-variable-relations-23-1">
<li id="sec-mm-variable-relations-23-1-1"><div class="para" id="sec-mm-variable-relations-23-1-1-1">Identify our domain interval,</div></li>
<li id="sec-mm-variable-relations-23-1-2"><div class="para" id="sec-mm-variable-relations-23-1-2-1">Create a sequence of <span class="process-math">\(x\)</span>-values from that interval,</div></li>
<li id="sec-mm-variable-relations-23-1-3"><div class="para" id="sec-mm-variable-relations-23-1-3-1">Use formula to calculate <span class="process-math">\(y\)</span>-values for each point,</div></li>
<li id="sec-mm-variable-relations-23-1-4"><div class="para" id="sec-mm-variable-relations-23-1-4-1">Graph the calculated <span class="process-math">\((x,y)\)</span> points connected.</div></li>
</ul>
<div class="para">We will first generate a graph without trying to connect it to our data.</div>
</div>
<figure class="listing figure-like" id="listing-qm-graph-function"><div class="code-box"><pre class="program"><code class="language-none"># Create the sequence of x-values
x_vals &lt;- seq(from = 2.55e8, to = 3.10e8, length.out = 50)
# Extract the coefficients for an easier name to calculate the y-values
c &lt;- D_model$coefficients
y_vals &lt;- c[1] + c[2] * x_vals + c[3] * x_vals^2

# Put the data in a table and pipe the result to ggplot
tibble(P = x_vals, D = y_vals) |&gt;
    ggplot(mapping = aes(x = P, y = D)) +
    geom_path(color = "blue", linewidth = 2)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.7<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 75%; margin-left: 12.5%; margin-right: 12.5%;"><img src="external/images/US-rates-quadratic-death-rate-01.png" class="contained"></div>
<div class="para" id="sec-mm-variable-relations-26">In order to combine graphs that come from different data sets, we will create geometric layers resulting from different <code class="code-inline tex2jax_ignore">data</code> features. This means that when we open up our graphics layout using <code class="code-inline tex2jax_ignore">ggplot</code>, we should not pass a common dataset for all of the layers. Instead, we pass an empty dataset indicator <code class="code-inline tex2jax_ignore">NULL</code>. We can still name our axes in the aesthetics. Then when we generate the geometric layers, we will specify our datasets and indicate the columns for <span class="process-math">\((x,y)\)</span> in each case separately.</div>
<figure class="listing figure-like" id="listing-qm-combining-graphs"><div class="code-box"><pre class="program"><code class="language-none">ggplot(data = NULL, 
        mapping = aes(x = Population, y = Deaths)) +
    geom_point(data = focus_population_data,
                aes(x = Population, y = Deaths),
                color = "blue", shape = 16) +
    geom_path(data = tibble(P = x_vals, D = y_vals),
                aes(x = P, y = D),
                color = "violet", linewidth = 1)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.8<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 75%; margin-left: 12.5%; margin-right: 12.5%;"><img src="external/images/US-rates-quadratic-death-rate-02.png" class="contained"></div>
<div class="para" id="sec-mm-variable-relations-29">Next, we want to look at derived state variables. (Note: “derived” means generated from and is not related to the calculus idea of “derivative”.) For populations, we are often interested in <dfn class="terminology">per capita rates</dfn>, which are calculated by taking a total rate (like a birth rate or death rate) and dividing it by the population size. This gives the number of births or deaths per year <em class="emphasis">per individual</em>.</div>
<div class="para" id="sec-mm-variable-relations-30">We add new columns to our dataset using <code class="code-inline tex2jax_ignore">mutate</code> to represent these new values. Let’s take a look at how per capita birth and death rates relate to population size.</div>
<figure class="listing figure-like" id="listing-US-per-capita-rates-01"><div class="code-box"><pre class="program"><code class="language-none">focus_population_data |&gt;
    mutate(Births_per_capita = Births / Population,
        Deaths_per_capita = Deaths / Population) |&gt;
    pivot_longer(cols = c(Births_per_capita, Deaths_per_capita),
            names_to = "rate_name",
            values_to = "per_capita_rate") |&gt;
    ggplot(mapping = aes(x = Population, y = per_capita_rate,
                        color = rate_name, shape = rate_name)) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.9<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 85%; margin-left: 7.5%; margin-right: 7.5%;"><img src="external/images/US-per-capita-rates-01.png" class="contained"></div>
<div class="para" id="sec-mm-variable-relations-33">This new view suggests that perhaps the population saw a transition in per capita birth rates for a time and then settled down to something approximately constant around 0.014 (births per individual per year), or 14 births per year per thousand individuals. The per capita death rate possibly was seeing a gradual decline. Because death rates are based on economics as well as medical innovations, we are unlikely going to want to attribute the falling death rate to the increasing population. However, from a modeling perspective, we could ignore this good sense and determine what the relationship is <em class="emphasis">if</em> we wanted to attribute all of the change to population size.</div>
<figure class="listing figure-like" id="listing-US-per-capita-death-01"><div class="code-box"><pre class="program"><code class="language-none">work_data &lt;- focus_population_data |&gt;
    mutate(Births_per_capita = Births / Population,
        Deaths_per_capita = Deaths / Population)
death_pc_model &lt;-
    lm(formula = Deaths_per_capita ~ Population, data = work_data)
death_pc_model$coefficients
ggplot(data = work_data,
       mapping = aes(x = Population, y = Deaths_per_capita)) +
    geom_point() +
    geom_smooth(method = "lm", formula = y ~ x, se = FALSE)
</code></pre></div>
<div class="code-box"><pre class="console"> (Intercept)    Population 
1.164158e-02 -1.123642e-11
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">1.6.10<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 85%; margin-left: 7.5%; margin-right: 7.5%;"><img src="external/images/US-per-capita-death-01.png" class="contained"></div></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-mm-intro-ggplot.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="populations.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
