<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Density Dependence in Structured Populations</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* div with class 'sagecell-sage' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-sage",
  "linked": true,
  "linkKey": "linked-sage",
  "autoeval": false,
  "languages": [
    "sage"
  ],
  "evalButtonText": "Evaluate (Sage)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.9';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.d7db380f34a0a67e.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.e0c6d4592e23c667.css">
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-structure-example-mosquitoes.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="ch-structured-populations.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="ch-continuous-dynamics.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="ch-structured-populations.html" class="internal"><span class="codenumber">3</span> <span class="title">Structured Populations</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-two-stage.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Two Stage Populations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-matrix-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Models for Structured Populations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Example: Mosquito Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Model Equations and Parameters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Simulation, Asymptotic Growth, and Stable Distributions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Exploring the Impact of Additional Mortality</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="sec-structure-density-dependent.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Density Dependence in Structured Populations</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-model" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Model Development</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#sec-structure-density-dependent-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Simulation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-equilibria" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Finding Fixed Points for Structured Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-partial-derivatives" class="internal"><span class="codenumber">3.4.4</span> <span class="title">Partial Derivatives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-fixed-point-stability" class="internal"><span class="codenumber">3.4.5</span> <span class="title">Testing the Stability of a Fixed Point</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-continuous-dynamics.html" class="internal"><span class="codenumber">4</span> <span class="title">Continuous Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-rates-of-change" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-slope-fields" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Slope Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-numerical-solutions" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Numerical Solutions to Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="diffeq-population-models.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Continuous Time Population Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-popn-density-dependent" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Continuous Logistic Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-rescaling" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Dimensional Analysis and Rescaling</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-diffeq-equilibria.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Differential Equation Analysis of Equilibria</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-diffeq-phase-line" class="internal"><span class="codenumber">4.3.1</span> <span class="title">The Phase Line</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-equilibria-examples" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Applications</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="differential-equation-analysis.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Analysis of Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-equilibria" class="internal"><span class="codenumber">4.4.1</span> <span class="title">Equilibria for Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-phase-line" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Phase Lines</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">5</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">5.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="sec-structure-density-dependent"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">3.4</span><span class="space"> </span><span class="title">Density Dependence in Structured Populations</span>
</h2>
<section class="introduction" id="sec-structure-density-dependent-2"><div class="para" id="sec-structure-density-dependent-2-1">In our analysis of the mosquito population using a structured model, like all linear projection models, the dynamics eventually resulted in either exponential growth or exponential decay. Just as with simple populations, exponential growth is not a valid model for structured populations when the population becomes larger than the environment is capable of supporting. There must be a change to the model when the population starts to become sufficiently large.</div>
<div class="para" id="sec-structure-density-dependent-2-2">For the mosquito population, one possible bottleneck is the water where larvae develop. As more larvae grow in the fixed number of open water sources, they will compete for food and space. There may also be limited space for female mosquitoes to deposit their eggs. Even beyond these considerations, a high mosquito population might also attract predators that might put additional pressure on the population.</div></section><section class="subsection" id="subsec-structure-density-model"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.4.1</span><span class="space"> </span><span class="title">Model Development</span>
</h3>
<div class="para" id="subsec-structure-density-model-2">We will choose just one pressure point on the population and add density-dependence in the model at the larva stage. Specifically, we could consider the mortality rate for larvae to be an increasing function of the number of larvae present. A mortality rate in this context is a probability and so is constrained to be between 0 and 1. We will introduce a mortality function <span class="process-math">\(\mu_L\)</span> that is an increasing function of <span class="process-math">\(L\)</span> with a horizontal asymptote <span class="process-math">\(\mu_L \to 1\)</span> as <span class="process-math">\(L \to \infty\text{.}\)</span> Graphically, we want a function that looks something like the graph in <a href="sec-structure-density-dependent.html#fig-density-dependent-mortality" class="xref" data-knowl="./knowl/xref/fig-density-dependent-mortality.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 3.4.1">Figure 3.4.1</a>.</div>
<figure class="figure figure-like" id="fig-density-dependent-mortality"><div class="image-box" style="width: 60%; margin-left: 20%; margin-right: 20%;"><img src="external/images/density-dependent-mortality-prototype.svg" role="img" class="contained" alt="density-dependent mortality probability function"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.4.1<span class="period">.</span></span><span class="space"> </span>Graph of a prototypical density-dependent mortality probability.</figcaption></figure><div class="para logical" id="subsec-structure-density-model-4">
<div class="para">From calculus, we know that a function of the form</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = \frac{bx+a}{bx+1}
\end{equation*}
</div>
<div class="para">will have a horizontal asymptote <span class="process-math">\(f(x) \to 1\)</span> as <span class="process-math">\(x \to \infty\text{.}\)</span> We also know that <span class="process-math">\(f(0) = a\text{.}\)</span> Calculating <span class="process-math">\(f'(x)\text{,}\)</span> we find</div>
<div class="displaymath process-math">
\begin{equation*}
f'(x) = \frac{b(1-a)}{(bx+1)^2}
\end{equation*}
</div>
<div class="para">so that <span class="process-math">\(f'(0) = b(1-a)\text{.}\)</span> By choosing appropriate values for <span class="process-math">\(a\)</span> and <span class="process-math">\(b\text{,}\)</span> we can therefore make our graph match an initial mortality rate <span class="process-math">\(\mu_0\)</span> and for small values of <span class="process-math">\(L\)</span> have additional mortality that is proportional to <span class="process-math">\(L\)</span> (density-dependence) with proportionality constant <span class="process-math">\(k\)</span> (slope) by choosing <span class="process-math">\(a = \mu_0\)</span> and <span class="process-math">\(b = \frac{k}{1-\mu_0}\text{.}\)</span>
</div>
</div>
<div class="para logical" id="subsec-structure-density-model-5">
<div class="para">Using this mortality rate for larvae, and the uniform reproductive rate for adults, we obtain a modified density-dependent mosquito model. Because the larvae mortality rate in <a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3-7-1" class="xref" data-knowl="./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.2">(3.3.2)</a> and <a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3-7-1" class="xref" data-knowl="./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.3">(3.3.3)</a> always appeared as <span class="process-math">\(1-\mu_L\text{,}\)</span> we will rewrite this first. We now know that <span class="process-math">\(\mu_L\)</span> is a function of <span class="process-math">\(L\)</span> with</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html ./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html">
\begin{equation*}
\mu_L = \frac{bL+a}{bL+1}
\end{equation*}
</div>
<div class="para">so that we can write</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html ./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html" id="subsec-structure-density-model-5-7">
\begin{align*}
1-\mu_L \amp = 1 - \frac{bL+a}{bL+1} \\
\amp = \frac{1-a}{bL+1}\\
\amp = \frac{1-\mu_0}{\frac{k}{1-\mu_0} L+1}\\
\amp = \frac{(1-\mu_0)^2}{kL + 1-\mu_0}
\end{align*}
</div>
<div class="para">Substituting this result into <a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3-7-1" class="xref" data-knowl="./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.2">(3.3.2)</a> and <a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3-7-1" class="xref" data-knowl="./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html" data-reveal-label="Reveal" data-close-label="Close" title="Equation 3.3.3">(3.3.3)</a>, our system of projection equations then become (using <span class="process-math">\(L_t\)</span> in place of <span class="process-math">\(L\)</span>)</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html ./knowl/xref/eqn-ELPA-larva-uniform-reproduction.html ./knowl/xref/eqn-ELPA-pupa-uniform-reproduction.html" id="subsec-structure-density-model-5-12">
\begin{align}
E_{t+1} \amp = (1-\mu_{E})(1-p_{E}) E_{t} +  {\textstyle \frac{5 N_{egg}}{\tau_{A}}} A_{t}\tag{3.4.1}\\
L_{t+1} \amp = (1-\mu_{E}) p_{E} E_{t} + \frac{(1-\mu_{0})^2(1-p_{L}) L_{t}}{k L_t + 1 - \mu_{0}}\tag{3.4.2}\\
P_{t+1} \amp = \frac{(1-\mu_{0})^2 p_{L} L_{t}}{k L_t + 1 - \mu_{0}} + (1-\mu_{P})(1-p_{P}) P_{t}\tag{3.4.3}\\
A_{t+1} \amp = {\textstyle \frac{1}{2}} (1-\mu_{P}) p_{P} P_{t} + (1-\eta_{A}) A_{t}\tag{3.4.4}
\end{align}
</div>
</div></section><section class="subsection" id="sec-structure-density-dependent-4"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.4.2</span><span class="space"> </span><span class="title">Simulation</span>
</h3>
<div class="para" id="sec-structure-density-dependent-4-2">Because we have introduced density dependence, the model is no longer a linear model. That is, there is at least one projection equation that is not just a linear combination of the state variables. The analysis that we did previously works well for small mosquito populations when <span class="process-math">\(\mu_L \approx \mu_0\text{,}\)</span> but as the population gets larger, the density dependence slows the exponential growth and we might approach an equilibrium.</div>
<div class="para" id="sec-structure-density-dependent-4-3">We can explore this initially using simulation. We will use the same parameters as in the previous section, with the exception that we need to introduce our density dependent parameter <span class="process-math">\(k\text{,}\)</span> representing the increase in larvae mortality per individual in the population. In our earlier simulation, we used <span class="process-math">\(\mu_L = 0.05\)</span> as an arbitrarily chosen value to reflect some environmental daily loss of larvae. Suppose we want our model to increase mortality to <span class="process-math">\(\mu_L = 0.10\)</span> if the larvae population in the water reaches <span class="process-math">\(L=100\text{.}\)</span> This represents and increase of <span class="process-math">\(\Delta \mu_L = 0.05\)</span> for a change <span class="process-math">\(\Delta L = 100\text{,}\)</span> so our parameter <span class="process-math">\(k = \frac{\Delta \mu_L}{\Delta L} = \frac{0.05}{100} = 0.0005\text{.}\)</span>
</div>
<figure class="listing figure-like" id="listing-ELPA-density-dependent"><div class="code-box"><pre class="program"><code class="language-r"># Life cycle parameters
T_egg &lt;- 2
T_larva &lt;- 4
T_pupa &lt;- 2
T_adult &lt;- 28
N_egg &lt;- 100

# Model parameters
# E,L,P mortality probabilities are arbitrarily set -- not based on life cycle
m_E &lt;- 0.05
m_L0 &lt;- 0.05
k &lt;- 0.0005    # density dependent increase in mortality
m_P &lt;- 0.05
p_E &lt;- 1/T_egg
p_L &lt;- 1/T_larva
p_P &lt;- 1/T_pupa
e_A &lt;- 1/T_adult

# Create space for data and fill with 0
maxT &lt;- 90
t_seq &lt;- 0:maxT
E_seq &lt;- double(maxT+1)
L_seq &lt;- double(maxT+1)
P_seq &lt;- double(maxT+1)
A_seq &lt;- double(maxT+1)

# Initial values -- only eggs nonzero
E_seq[1] &lt;- N_egg
# Now perform the projections
for (t in 1:maxT) {
    E_seq[t+1] &lt;- (1-m_E) * (1-p_E) * E_seq[t] +  (5 * N_egg)/T_adult * A_seq[t]
    L_seq[t+1] &lt;- (1-m_E) * p_E * E_seq[t] + 
                  (1-m_L0)^2 * (1-p_L) * L_seq[t] / (k * L_seq[t] + 1 - m_L0)
    P_seq[t+1] &lt;- (1-m_L0)^2 * p_L * L_seq[t] / (k * L_seq[t] + 1 - m_L0) +
                  (1-m_P) * (1-p_P) * P_seq[t]
    A_seq[t+1] &lt;- 0.5 * (1-m_P) * p_P * P_seq[t] + (1-e_A) * A_seq[t]
}

# Visualize dynamics --- expect exponential growth so use log-scale
library(ggplot2)
pop_growth &lt;- ggplot() +
    # Add data; use color to label the different stages
    geom_point(mapping = aes(x = t_seq, y = E_seq, color = "1")) +
    geom_point(mapping = aes(x = t_seq, y = L_seq, color = "2")) +
    geom_point(mapping = aes(x = t_seq, y = P_seq, color = "3")) +
    geom_point(mapping = aes(x = t_seq, y = A_seq, color = "4")) +
    # Add legend information
    scale_color_discrete(breaks=c("1", "2", "3", "4"),
                        labels = c("eggs","larvae","pupae","adult (F)"),
                        name="stage") +
    # Add logarithimc scale
    scale_y_continuous(trans = "log10") +
    # Add labels
    labs(x = "time", y = "population")
show(pop_growth)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">3.4.2<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="fig-ELPA-density-dependent-population"><div class="image-box" style="width: 90%; margin-left: 5%; margin-right: 5%;"><img src="external/images/ELPA-density-dependent-population.png" class="contained" alt="Plot of the different stages as functions of time"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">3.4.3<span class="period">.</span></span><span class="space"> </span>Population values predicted by the density-dependent ELPA model</figcaption></figure><div class="para" id="sec-structure-density-dependent-4-6">We can see that the mosquito population starts out like it will grow exponentially, but after only a few days the population values start to level out. Our population is converging toward an equilibrium. By inspecting the final recorded values for each of the state variables, we can see that our simulation has not quite reached equilibrium for <span class="process-math">\(t=90\text{.}\)</span> Increasing our final time value to <span class="process-math">\(t=100\text{,}\)</span> we still have not reached equilibrium (values are still changing), but we can see we are close with values <span class="process-math">\((E,L,P,A) = (190157, 91646, 842, 5591)\text{.}\)</span> To find actual equilibrium values, we need to do some analysis.</div></section><section class="subsection" id="subsec-structure-density-equilibria"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.4.3</span><span class="space"> </span><span class="title">Finding Fixed Points for Structured Populations</span>
</h3>
<div class="para" id="subsec-structure-density-equilibria-2">Recall that for a single sequence with projection function <span class="process-math">\(P_{n+1} = f(P_n)\text{,}\)</span> we find a fixed point by solving the equation <span class="process-math">\(x = f(x)\text{.}\)</span> When working with structured populations, we need <em class="emphasis">all</em> of the projection equations to be at an equilibrium. That is, we need to find values <span class="process-math">\((E,L,P,A)\)</span> so that <span class="process-math">\(E_{t+1} = E_t = E\text{,}\)</span> <span class="process-math">\(L_{t+1}=L_{t} = L\text{,}\)</span> <span class="process-math">\(P_{t+1} = P_t = P\)</span> and <span class="process-math">\(A_{t+1} = A_{t} = A\text{.}\)</span>
</div>
<div class="para logical" id="subsec-structure-density-equilibria-3">
<div class="para">We will need to solve <em class="emphasis">four</em> equations involving <em class="emphasis">four</em> variables at the same time. In an abstract sense, if we thought of our four projection formulas as four different projection functions that depend on the full state of the population,</div>
<div class="displaymath process-math" id="subsec-structure-density-equilibria-3-3">
\begin{align*}
E_{t+1} \amp = f_E(E_t, L_t, P_t, A_t) \\
L_{t+1} \amp = f_L(E_t, L_t, P_t, A_t) \\
P_{t+1} \amp = f_P(E_t, L_t, P_t, A_t) \\
A_{t+1} \amp = f_A(E_t, L_t, P_t, A_t) 
\end{align*}
</div>
<div class="para">then we are trying to solve the following four equations simultaneously,</div>
<div class="displaymath process-math" id="subsec-structure-density-equilibria-3-4">
\begin{align*}
E \amp = f_E(E, L, P, A) \\
L \amp = f_L(E, L, P, A) \\
P \amp = f_P(E, L, P, A) \\
A \amp = f_A(E, L, P, A) 
\end{align*}
</div>
</div>
<div class="para" id="subsec-structure-density-equilibria-4">Rather than work through the mathematical theory for how to do this solving of equations by hand, we will let a computer algebra system do the work for us (if possible). An example of how we would try to do this using Sage is illustrated below. If we want symbolic solutions, we need to declare every parameter as a symbol. This often slows the computation down or might even make it so the algebra system can’t find the answer. Instead, we can declare the values directly and then solve. Only the second method is illustrated here.</div>
<div id="subsec-structure-density-equilibria-5" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># State variables
var("E,L,P,A")

# Declare parameter values (=)
mE = 0.05
mL0 = 0.05
k = 0.0005
mP = 0.05
pE = 1/2
pL = 1/4
pP = 1/2
eA = 1/28
Regg = 500/28

# Solve the *system* (list) of equations
fix_pts = solve(
    # List of equations (double ==)
    [ E == (1-mE) * (1-pE) * E +  Regg * A,
      L == (1-mE)*pE * E + (1-mL0)^2*(1-pL) * L / (k*L+1-mL0),
      P == (1-mL0)^2*pL * L / (k*L+1-mL0) + (1-mP)*(1-pP) * P,
      A == 1/2*(1-mP)*pP * P + (1-eA) * A
    ],
    # List of variables we solve for
    [E, L, P, A]
)

# Show the results
# - N() converts formulas to decimal values
# - subs(fp) applies the solution from the fp solution
for fp in fix_pts:
    show(E == N(E.subs(fp)))
    show(L == N(L.subs(fp)))
    show(P == N(P.subs(fp)))
    show(A == N(A.subs(fp)))
    show("-")   # To break up results
</script></div>
<div class="para logical" id="subsec-structure-density-equilibria-6">
<div class="para">There are two equilibria or fixed point states. A total absence of mosquitoes is one of the solutions, <span class="process-math">\((E,L,P,A)=(0,0,0,0)\text{.}\)</span> The second equilbrium state is what our simulation was approaching,</div>
<div class="displaymath process-math">
\begin{equation*}
(E,L,P,A) \approx (190473.89, 91801.40, 842.10, 5599.93)\text{.}
\end{equation*}
</div>
<div class="para">Our simulation gives us strong reason to believe that the second fixed point is stable while the fixed point with no mosquitoes is unstable.</div>
</div></section><section class="subsection" id="subsec-structure-partial-derivatives"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.4.4</span><span class="space"> </span><span class="title">Partial Derivatives</span>
</h3>
<div class="para" id="subsec-structure-partial-derivatives-2">Recall that for simple projection models, <span class="process-math">\(P_{n+1} = f(P_n)\text{,}\)</span> where <span class="process-math">\(P=P^*\)</span> is a fixed point, we tested the local stability of the fixed point by looking at the value of the slope <span class="process-math">\(\lambda = f'(P^*)\text{.}\)</span> For structured populations, we will do a similar thing. However, in this case, there are more functions and more variables. We will be creating a matrix full of derivatives of each of the functions with respect to each of the variables. In place of the single slope to determine stability, we will be looking at the dominant eigenvalue of this matrix.</div>
<div class="para" id="subsec-structure-partial-derivatives-3">We first need to introduce the idea of a <dfn class="terminology">partial derivative</dfn>. When a function is defined involving multiple variables, such as <span class="process-math">\(f(x,y)\text{,}\)</span> a partial derivative gives us the rate of change of this function when only one of the variables is changed. We can not use the prime notation, as in <span class="process-math">\(f'\)</span> because that doesn’t tell us which variable was changed. Instead, we use a subscript indicating the variable, so that <span class="process-math">\(f_x(x,y)\)</span> represents the rate of change when <span class="process-math">\(x\)</span> is changing and <span class="process-math">\(f_y(x,y)\)</span> represents the rate of change when <span class="process-math">\(y\)</span> is changing. The derivative operator in calculus <span class="process-math">\(\frac{d}{dx}\)</span> is also updated to use curly “d” to indicate we are holding other variables constant so that we have <span class="process-math">\(\frac{\partial}{\partial x}\)</span> and <span class="process-math">\(\frac{\partial}{\partial y}\text{.}\)</span> These are also sometimes abbreviated as operators to also involve subscripts <span class="process-math">\(\partial_x\)</span> and <span class="process-math">\(\partial_y\text{.}\)</span>
</div>
<article class="example example-like" id="subsec-structure-partial-derivatives-4"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.4.4</span><span class="period">.</span>
</h4>
<div class="para" id="subsec-structure-partial-derivatives-4-1-1">If <span class="process-math">\(f(x,y) = 2x^2 - 3xy + 4y^2 +3y\text{,}\)</span> find <span class="process-math">\(f_x(x,y)\)</span> and <span class="process-math">\(f_y(x,y)\text{.}\)</span>
</div>
<div class="solutions"><details id="subsec-structure-partial-derivatives-4-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para logical" id="subsec-structure-partial-derivatives-4-2-1">
<div class="para">The partial derivative <span class="process-math">\(\frac{\partial}{\partial x}\)</span> finds the derivative treating <span class="process-math">\(x\)</span> as the variable and <span class="process-math">\(y\)</span> as if it were constant. Whenever a term has just <span class="process-math">\(y\text{,}\)</span> that entire term is treated as if it were constant. And if a term has a formula involving <span class="process-math">\(y\)</span> as a factor, that entire factor is treated like a constant multiple. Consequently,</div>
<div class="displaymath process-math" id="subsec-structure-partial-derivatives-4-2-1-6">
\begin{align*}
f_x(x,y) \amp = \frac{\partial}{\partial x}\Big[2x^2 - 3xy + 4y^2 + 3y\Big]\\
\amp = \frac{\partial}{\partial x}\Big[2 \cdot x^2 - (3y) \cdot x + (4y^2 + 3y)\Big]\\
\amp = 2 \cdot (2x) - (3y) \cdot 1 + 0\\
\amp = 4x - 3y
\end{align*}
</div>
</div>
<div class="para logical" id="subsec-structure-partial-derivatives-4-2-2">
<div class="para">The partial derivative <span class="process-math">\(\frac{\partial}{\partial y}\)</span> does the reverse—we treat <span class="process-math">\(y\)</span> as the variable and any term involving <span class="process-math">\(x\)</span> as if that were a constant. Thus,</div>
<div class="displaymath process-math" id="subsec-structure-partial-derivatives-4-2-2-5">
\begin{align*}
f_y(x,y) \amp = \frac{\partial}{\partial y}\Big[2x^2 - 3xy + 4y^2 + 3y\Big]\\
\amp = \frac{\partial}{\partial x}\Big[(2x^2) - (3x) \cdot y + 4 \cdot y^2 + 3 \cdot y\Big]\\
\amp = 0 - (3x) \cdot 1 + 4 \cdot (2y) + 3 \cdot 1\\
\amp = -3x + 8y + 3
\end{align*}
</div>
</div>
<div class="para" id="subsec-structure-partial-derivatives-4-2-3">We can use a computer algebra system to perform the derivatives by specifying the variable of differentiation.</div>
<div id="subsec-structure-partial-derivatives-4-2-4" class="ptx-sagecell sagecell-sage"><script type="text/x-sage">var("x,y")
f(x,y) = 2*x^2 - 3*x*y +4*y^2 + 3*y

f_x = f(x,y).derivative(x)
f_y = f(x,y).derivative(y)
show(f_x)
show(f_y)
</script></div>
</div></details></div></article><div class="para logical" id="subsec-structure-partial-derivatives-5">
<div class="para">Our abstract setup for the matrix of derivatives presumes that have state variables ordered <span class="process-math">\((x_1,x_2,\ldots,x_n)\text{.}\)</span> Each state variable has its own projection function involving potentially any of the state variables,</div>
<div class="displaymath process-math">
\begin{equation*}
x_{i,t+1} = f_i(x_1, x_2, \ldots, x_n)\text{.}
\end{equation*}
</div>
<div class="para">For each function <span class="process-math">\(f_i\text{,}\)</span> we will compute all of the partial derivatives with respect to <span class="process-math">\(x_1\text{,}\)</span> <span class="process-math">\(x_2\text{,}\)</span> etc., one at a time, and put them in the <span class="process-math">\(i\)</span>th row of a matrix. This matrix full of partial derivatives is named the <dfn class="terminology">Jacobian</dfn> matrix, or more simply the derivative matrix. The order is critical in that the first column will have all of the partial derivatives with respect to <span class="process-math">\(x_1\text{,}\)</span> the second column will have all of the partial derivatives with respect to <span class="process-math">\(x_2\text{,}\)</span> and so on. I prefer the notation <span class="process-math">\(Df\)</span> for the derivative matrix.</div>
</div>
<article class="example example-like" id="subsec-structure-partial-derivatives-6"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.4.5</span><span class="period">.</span>
</h4>
<div class="para logical" id="subsec-structure-partial-derivatives-6-1-1">
<div class="para">Suppose we started with a projection model for <span class="process-math">\((S,P)\)</span> given by recursive formulas</div>
<div class="displaymath process-math" id="subsec-structure-partial-derivatives-6-1-1-2">
\begin{align*}
S_{t+1} \amp = \rho (1-\alpha) S_t + \frac{f P_t}{\beta P_t + 1}\\
P_{t+1} \amp = \alpha S_t
\end{align*}
</div>
<div class="para">This model could represent a simplified density-dependent seed-bank annual plant model. The parameter <span class="process-math">\(\alpha\)</span> represents the fraction of seeds from the seed bank that germinate while <span class="process-math">\(\rho\)</span> represents the fraction of non-germinating seeds that will survive to the next year. Plants are modeled with density dependence so that the number of seeds per plant starts at <span class="process-math">\(f\)</span> but decreases with increasing population sizes using the per plant seed model <span class="process-math">\(\frac{f}{\beta P_t + 1}\text{.}\)</span>
</div>
</div> <div class="para logical" id="subsec-structure-partial-derivatives-6-1-2">
<div class="para">Having specified an order for the state variables of <span class="process-math">\((S,P)\text{,}\)</span> we can define the two projection functions</div>
<div class="displaymath process-math" id="subsec-structure-partial-derivatives-6-1-2-2">
\begin{align*}
f_{1}(S,P) \amp = \rho (1-\alpha) S + \frac{f P}{\beta P + 1} \\
f_{2}(S,P) \amp = \alpha S \text{.}
\end{align*}
</div>
<div class="para">We can compute the partial derivatives, following the same order of first <span class="process-math">\(S\)</span> and then <span class="process-math">\(P\text{:}\)</span>
</div>
<div class="displaymath process-math" id="subsec-structure-partial-derivatives-6-1-2-5">
\begin{align*}
f_{1,S}(S,P) \amp = \frac{\partial}{\partial S}\Big[ \rho (1-\alpha) S + \frac{f P}{\beta P + 1}\Big] \\
\amp = \rho(1-\alpha) + 0\\
f_{1,P}(S,P) \amp = \frac{\partial}{\partial P}\Big[ \rho (1-\alpha) S + \frac{f P}{\beta P + 1}\Big] \\
\amp = 0 + \frac{f}{(\beta P + 1)^2} \\
f_{2,S}(S,P) \amp = \frac{\partial}{\partial S}\Big[ \alpha S \Big] \\
\amp = \alpha \\
f_{2,P}(S,P) \amp = \frac{\partial}{\partial P}\Big[ \alpha S \Big] \\
\amp = 0 \text{.}
\end{align*}
</div>
</div> <div class="para logical" id="subsec-structure-partial-derivatives-6-1-3">
<div class="para">The Jacobian or derivative matrix is found by putting the partial derivatives of <span class="process-math">\(f_1\)</span> in the first row and the partial derivatives of <span class="process-math">\(f_2\)</span> in the second row.</div>
<div class="displaymath process-math">
\begin{equation*}
Df = \begin{bmatrix}
(1-\alpha)\rho \amp \frac{f}{(\beta P + 1)^2} \\
\alpha \amp 0
\end{bmatrix}
\end{equation*}
</div>
<div class="para">Notice that this formula still depends on the value of <span class="process-math">\(P\text{.}\)</span> This is because our original function <span class="process-math">\(f_1(S,P)\)</span> was nonlinear with respect to <span class="process-math">\(P\text{.}\)</span>
</div>
</div> <div class="para" id="subsec-structure-partial-derivatives-6-1-4">This example focused only on finding the Jacobian matrix. We would need to calculate fixed points and then evaluate this matrix using the fixed point state values before proceeding further.</div></article><div class="para" id="subsec-structure-partial-derivatives-7">A computer algebra system can automate this process for us. To do this, we must have a way to inform the system of the ordering for the variables as well as for the projection functions. A possible approach using Sage is provided below, using the previous example involving <span class="process-math">\((S,P)\text{.}\)</span> To modify this, you only need to update the names of the state variables and paramters, define your projection functions, and then update the <code class="code-inline tex2jax_ignore">state_vars</code> and <code class="code-inline tex2jax_ignore">projections</code> lists to match order.</div>
<div id="subsec-structure-partial-derivatives-8" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># Declare state variables and parameters as symbols
var("S,P,alpha,rho,f,beta")

# Define our two functions
f1(S,P) = rho*(1-alpha)*S + f*P/(beta*P+1)
f2(S,P) = alpha*S

# Create an association between variables and projections
state_vars = [S, P]
projections = [f1(S,P), f2(S,P)]

# ==== Edit ABOVE this line =====
# Caution: lengths must be the same or an error
assert len(state_vars) == len(projections)

# Create a matrix using partial derivatives
# This uses a Python trick called "list comprehension"
Df = matrix([ # create a list of rows based on projections
    [ # create a list of factored derivatives
        curF.derivative(curX).factor()
            for curX in state_vars
    ] for curF in projections
])
show(Df)
</script></div></section><section class="subsection" id="subsec-structure-fixed-point-stability"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">3.4.5</span><span class="space"> </span><span class="title">Testing the Stability of a Fixed Point</span>
</h3>
<div class="para" id="subsec-structure-fixed-point-stability-2">To test the local stability of a fixed point in a structured population, we take advantage of the following theorem.</div>
<article class="theorem theorem-like" id="thm-discrete-dynamics-local-stability"><h4 class="heading">
<span class="type">Theorem</span><span class="space"> </span><span class="codenumber">3.4.6</span><span class="period">.</span>
</h4>
<div class="para logical" id="thm-discrete-dynamics-local-stability-1-1">
<div class="para">Suppose a discrete-time system has a state vector <span class="process-math">\(\vec x = (x_1, x_2, \ldots, x_n)\)</span> governed by <span class="process-math">\(n\)</span> projection functions</div>
<div class="displaymath process-math" id="thm-discrete-dynamics-local-stability-1-1-3">
\begin{align*}
x_{1,t+1} \amp = f_1(\vec x_t) \\
x_{2,t+1} \amp = f_2(\vec x_t) \\
\amp \vdots \\
x_{n,t+1} \amp = f_n(\vec x_t) 
\end{align*}
</div>
<div class="para">has a <dfn class="terminology">fixed point</dfn> <span class="process-math">\(\vec x^*\)</span> satisfying</div>
<div class="displaymath process-math" id="thm-discrete-dynamics-local-stability-1-1-6">
\begin{align*}
x^*_{1} \amp = f_1(\vec x^*) \\
x^*_{2} \amp = f_2(\vec x^*) \\
\amp \vdots \\
x^*_{n} \amp = f_n(\vec x^*) \text{.}
\end{align*}
</div>
<div class="para">Calculate the Jacobian matrix <span class="process-math">\(Df\)</span> evaluated at <span class="process-math">\(\vec x^*\)</span> and then find the dominant eigenvalue of that matrix <span class="process-math">\(\lambda\text{.}\)</span>
</div>
<ul class="disc" id="thm-discrete-dynamics-local-stability-1-1-10">
<li id="thm-discrete-dynamics-local-stability-1-1-10-1"><div class="para" id="thm-discrete-dynamics-local-stability-1-1-10-1-1">If <span class="process-math">\(|\lambda| \gt 1\text{,}\)</span> then <span class="process-math">\(\vec x=\vec x^*\)</span> is <dfn class="terminology">locally unstable</dfn>.</div></li>
<li id="thm-discrete-dynamics-local-stability-1-1-10-2"><div class="para" id="thm-discrete-dynamics-local-stability-1-1-10-2-1">If <span class="process-math">\(|\lambda| \lt 1\text{,}\)</span> then <span class="process-math">\(\vec x=\vec x^*\)</span> is <dfn class="terminology">locally stable</dfn>.</div></li>
</ul>
<div class="para">If <span class="process-math">\(|\lambda| = 1\text{,}\)</span> the test is inconclusive.</div>
</div></article><div class="para" id="subsec-structure-fixed-point-stability-4">Since we are already using the computer algebra system Sage to generate our matrix and find our fixed points, we might as well also ask this system to calculate our eigenvalues. Because Sage is designed to accommodate many mathematical subtleties, the command is slightly more complex than the <code class="code-inline tex2jax_ignore">eigen</code> command in R. We will illustrate the analysis for our simple seed model introduced above.</div>
<article class="example example-like" id="subsec-structure-fixed-point-stability-5"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">3.4.7</span><span class="period">.</span>
</h4>
<div class="para logical" id="subsec-structure-fixed-point-stability-5-1-1">
<div class="para">For the density-dependent seed bank model</div>
<div class="displaymath process-math" id="subsec-structure-fixed-point-stability-5-1-1-1">
\begin{align*}
S_{t+1} \amp = \rho (1-\alpha) S_t + \frac{f P_t}{\beta P_t + 1}\\
P_{t+1} \amp = \alpha S_t
\end{align*}
</div>
<div class="para">we will use Sage to find the fixed points and calculate the Jacobian matrix using the fixed point solutions. Suppose that we are working with parameter values <span class="process-math">\(\rho = 0.5\)</span> (50% survival of seeds to next year), <span class="process-math">\(\alpha = 0.6\)</span> (60% germination rate each year), <span class="process-math">\(f = 10\)</span> (100 seeds per plant in ideal conditions), and <span class="process-math">\(\beta = 0.01\)</span> (controls how fast density dependence impacts the seed production). We borrow the derivative code from the earlier Sage calculation and add in the calculation of the fixed points.</div>
</div> <div id="subsec-structure-fixed-point-stability-5-1-2" class="ptx-sagecell sagecell-sage"><script type="text/x-sage"># Declare state variables
var("S,P")

# Parameters as values
rho = 0.5
alpha = 0.6
f = 10
beta = 0.01

# Define our two functions
f1(S,P) = rho*(1-alpha)*S + f*P/(beta*P+1)
f2(S,P) = alpha*S

# Create an association between variables and projections
state_vars = [S, P]
projections = [f1(S,P), f2(S,P)]

# ==== Edit ABOVE this line =====
# Caution: lengths must be the same or an error
assert len(state_vars) == len(projections)

# Create a matrix using partial derivatives
# This uses a Python trick called "list comprehension"
Df = matrix([ # create a list of rows based on projections
    [ # create a list of factored derivatives
        curF.derivative(curX).factor()
            for curX in state_vars
    ] for curF in projections
])
show("General Jacobian")
show(Df)

# Find the fixed points
N = len(state_vars)

# Again use list comprehension so this works for other models
fp_list = solve([ state_vars[i] == projections[i] for i in range(N)],
          state_vars)

# Show the fixed point solutions and also the Jacobian evaluated there.
for fp in fp_list:
    show("-")
    show("Fixed point solution")
    for my_var in state_vars:
        show(my_var == my_var.subs(fp).factor().simplify())

    show("Jacobian")
    myJ = Df.subs(fp)
    show(myJ)
    
    show("Eigenvalues")
    myJM = Matrix(RDF, myJ)
    myEigSpace = myJM.right_eigenvectors()
    show([myEig[0] for myEig in myEigSpace])
</script></div> <div class="para logical" id="subsec-structure-fixed-point-stability-5-1-3">
<div class="para">When evaluating the Sage code, we discover that there are two fixed point solutions. The first fixed point listed is <span class="process-math">\((S,P) = (\frac{3250}{3}, 650)\text{.}\)</span> The Jacobian matrix at this fixed point is given by</div>
<div class="displaymath process-math">
\begin{equation*}
Df = \begin{bmatrix} 0.2 \amp 0.17777777778 \\ 0.6 \amp 0 \end{bmatrix}\text{.}
\end{equation*}
</div>
<div class="para">Finally, Sage reports the eigenvalues as <span class="process-math">\(\lambda_1 = 0.441565\)</span> and <span class="process-math">\(\lambda_2 = -0.241565\text{.}\)</span> The dominant eigenvalue is the eigenvalue with largest magnitude <span class="process-math">\(\lambda = 0.441565\text{.}\)</span> Since this eigenvalue has magnitude smaller than 1, the fixed point is stable.</div>
</div> <div class="para logical" id="subsec-structure-fixed-point-stability-5-1-4">
<div class="para">The second fixed point is <span class="process-math">\((S,P) = (0,0)\text{.}\)</span> The Jacobian matrix at this fixed point is given by</div>
<div class="displaymath process-math">
\begin{equation*}
Df = \begin{bmatrix} 0.2 \amp 10 \\ 0.6 \amp 0 \end{bmatrix}
\end{equation*}
</div>
<div class="para">and Sage reports the eigenvalues as <span class="process-math">\(\lambda_1 = 2.55153\)</span> and <span class="process-math">\(\lambda_2 = -2.35153\text{.}\)</span> Because the dominant eigenvalue, <span class="process-math">\(\lambda = 2.55153\text{,}\)</span> has magnitude greater than 1, the fixed point is unstable.</div>
</div></article></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-structure-example-mosquitoes.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="ch-continuous-dynamics.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
