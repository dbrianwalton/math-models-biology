<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Recursive Models Using Projection</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script>// Make *any* div with class 'sagecell-r' an executable Sage cell
// Their results will be linked, only within language type
sagecell.makeSagecell({
  "inputLocation": "div.sagecell-r",
  "linked": true,
  "linkKey": "linked-r",
  "autoeval": false,
  "languages": [
    "r"
  ],
  "evalButtonText": "Evaluate (R)"
});
</script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.9';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.d7db380f34a0a67e.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.e0c6d4592e23c667.css">
<style>
#ex-measure-distance-conversions-1-1-1 { counter-set: ex-measure-distance-conversions-1-1-1 0; }
#ex-measure-distance-conversions-1-1-1 > li::marker { content: "("counter(ex-measure-distance-conversions-1-1-1,lower-alpha)")"; }
#ex-measure-distance-conversions-1-1-1 > li { counter-increment: ex-measure-distance-conversions-1-1-1; }
#ex-measure-geometric-dimensions-1-1-2 { counter-set: ex-measure-geometric-dimensions-1-1-2 0; }
#ex-measure-geometric-dimensions-1-1-2 > li::marker { content: "("counter(ex-measure-geometric-dimensions-1-1-2,lower-alpha)")"; }
#ex-measure-geometric-dimensions-1-1-2 > li { counter-increment: ex-measure-geometric-dimensions-1-1-2; }
</style>
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner">
<a id="logo-link" class="logo-link" target="_blank" href=""></a><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div>
</div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="sec-population-density-dependent.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="populations.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="projection-analysis.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-structured-populations.html" class="internal"><span class="codenumber">3</span> <span class="title">Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-two-stage.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Two Stage Populations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-matrix-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Models for Structured Populations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Example: Mosquito Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Model Equations and Parameters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Simulation, Asymptotic Growth, and Stable Distributions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Exploring the Impact of Additional Mortality</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">4</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">4.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">4.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">4.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">4.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-.html" class="internal"><span class="codenumber">5</span> <span class="title">Continuous Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#rate-of-change" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#numerical-solutions-diffeq" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Solutions to Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#slope-fields" class="internal"><span class="codenumber">5.1.4</span> <span class="title">Slope Fields</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="differential-equation-analysis.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Analysis of Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-equilibria" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Equilibria for Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="differential-equation-analysis.html#diffeq-phase-line" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Phase Lines</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="population-projection"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">2.4</span><span class="space"> </span><span class="title">Recursive Models Using Projection</span>
</h2>
<section class="introduction" id="population-projection-2"><div class="para logical" id="population-projection-2-1">
<div class="para">In the previous section, we considered a recursive formula for the new population in terms of the per capita net growth rate, <span class="process-math">\(r(P)\text{,}\)</span> where the new population is computed by the difference equation</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} - P_n  = r(P_n) \cdot P_n,
\end{equation*}
</div>
<div class="para">which is equivalent to the recursive formula</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} = P_n + r(P_n) \cdot P_n.
\end{equation*}
</div>
<div class="para">The basic idea to the difference equation is that <span class="process-math">\(r(P) \cdot P\)</span> is the formula for the increment of change in the population, which is why that formula is added to the previous population.</div>
</div>
<div class="para" id="population-projection-2-2">In this section, we introduce an alternative way of thinking about computing the new population. In the above model, we effectively were thinking about the <em class="emphasis">change in the population</em> as a function of the previous population (specifically by thinking of the per capita rate as a function). We turn our attention now to thinking of the new population as itself being a function of the previous population. This function is called the <dfn class="terminology">projection function</dfn>.</div></section><section class="subsection" id="projection-functions"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">2.4.1</span><span class="space"> </span><span class="title">Projection Functions</span>
</h3>
<div class="para logical" id="projection-functions-2">
<div class="para">A sequence <span class="process-math">\(x=(x_n)\)</span> is defined <dfn class="terminology">recursively</dfn> if you have a formula to compute <span class="process-math">\(x_{n+1}\)</span> in terms of the value for <span class="process-math">\(x_n\text{.}\)</span> Generally, we have an equation that is solved for the new value in the form of</div>
<div class="displaymath process-math">
\begin{equation*}
x_{n+1} = f(x_n)\text{.}
\end{equation*}
</div>
<div class="para">That is, the equation has been rewritten so that the <em class="emphasis">new</em> value is isolated on one side of the equation and is equal to some formula involving the <em class="emphasis">previous</em> value of the sequence. We then think of the formula involving <span class="process-math">\(x_n\)</span> as a <em class="emphasis">function</em> of <span class="process-math">\(x_n\text{.}\)</span> That function is named the <dfn class="terminology">projection function</dfn> for the sequence because it allows us to <em class="emphasis">project</em> (i.e., forecast) the next value of the sequence knowing the current value in the sequence.</div>
</div>
<article class="example example-like" id="projection-functions-3"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.1</span><span class="period">.</span>
</h4>
<div class="para logical" id="projection-functions-3-1">
<div class="para">The difference equation <span class="process-math">\(P_{n+1} - P_n = r P_n\)</span> with an initial value defines a sequence recursively. This is the model for constant per capita growth rates. If we solve this equation for <span class="process-math">\(P_{n+1}\text{,}\)</span>
</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} = P_n + r P_n\text{,}
\end{equation*}
</div>
<div class="para">we think of the right hand side as the projection function, <span class="process-math">\(f(P_n) = P_n + r P_n\text{.}\)</span> In terms of a simple variable (change <span class="process-math">\(P_n\)</span> to <span class="process-math">\(x\)</span>), the projection function is defined by</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = x+rx = (1+r)x\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="projection-functions-3-2">We saw earlier that this sequence results in geometric sequences that grow or decay exponentially. If we generate this sequence <span class="process-math">\(P = (P_0, P_1, P_2, \ldots)\)</span> and look at the relation <span class="process-math">\((P_n, P_{n+1})\text{,}\)</span> all of those points are on the graph of the projection function <span class="process-math">\(y=(1+r)x\text{.}\)</span> The following code generates the sequence recursively and demonstrates this relation.</div>
<figure class="listing figure-like" id="projection-functions-3-3"><div class="code-box"><pre class="program"><code class="language-r">library(tidyr)   # for tibble
library(ggplot2) # for ggplot

# Set values for the model parameters and initial value
r &lt;- 0.25
P0 &lt;- 10

# Specify the size of the sequence and create space in memory
num_pts &lt;- 50
P &lt;- double(num_pts)

# Generate the sequence
P[1] &lt;- P0
for (n in 2:num_pts) {
    P[n] &lt;- (1+r) * P[n-1]
}
# Store as P_start and P_end
seq_data &lt;- tibble(P_start = P[1:(num_pts-1)],
                      P_end=P[2:num_pts])

# Generate a graph of the projection function
# Create x-values between 0 and the largest value of P in our data
x_vals &lt;- seq(from=0, to=max(P), length=500)
# Vectorized calculation of y = f(x)
y_vals &lt;- (1+r)*x_vals

# Create a plot with sequential values (P_n,P_(n+1)) and y=f(x)
ggplot(data = NULL,   # different data for different layers 
      mapping = aes(x = P_start, y = P_end, color = "sequence")) +
  geom_point(data = seq_data, size=3) +
  geom_path(mapping = aes(x = x_vals, y = y_vals, color = "projection")) +
  scale_color_manual(values=c("sequence"="blue", "projection"="black"))
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.2<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div id="projection-functions-3-4" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div></article><article class="example example-like" id="projection-functions-4"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.3</span><span class="period">.</span>
</h4>
<div class="para logical" id="projection-functions-4-1">
<div class="para">The difference equation <span class="process-math">\(P_{n+1} - P_n = (r_0 - a P_n) P_n\)</span> is the difference equation perspective for the discrete logistic model. Solving this equation for <span class="process-math">\(P_{n+1}\)</span> gives</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} = (1+r_0) P_n - P_n^2\text{.}
\end{equation*}
</div>
<div class="para">The projection function must therefore be <span class="process-math">\(f(P_n) = (1+r_0) P_n - a P_n^2\text{.}\)</span> More simply written, the projection function for the discrete logistic model is</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = (1+r_0) x - ax^2\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="projection-functions-4-2">Again, if we generate a sequence to follow this model, each point in the relation <span class="process-math">\((P_n, P_{n+1})\)</span> will be on the graph of the projection function <span class="process-math">\(y=f(x)\text{.}\)</span>
</div>
<figure class="listing figure-like" id="projection-functions-4-3"><div class="code-box"><pre class="program"><code class="language-r">library(tidyr)   # for tibble
library(ggplot2) # for ggplot

# Set values for the model parameters and initial value
r0 &lt;- 0.4
a &lt;- 0.001
P0 &lt;- 10

# Specify the size of the sequence and create space in memory
num_pts &lt;- 50
P &lt;- double(num_pts)

# Generate the sequence
P[1] &lt;- P0
for (n in 1:(num_pts-1)) {
    P[n+1] &lt;- (1+r0) * P[n] - a * P[n]^2
}
# Store as P_start and P_end
seq_data &lt;- tibble(P_start = P[1:(num_pts-1)],
                      P_end=P[2:num_pts])

# Generate a graph of the projection function
# Create x-values between 0 and the largest value of P in our data
x_vals &lt;- seq(from=0, to=max(P), length=500)
# Vectorized calculation of y = f(x)
y_vals &lt;- (1+r0) * x_vals - a * x_vals^2

# Create a plot with sequential values (P_n,P_(n+1)) and y=f(x)
ggplot(data = NULL,   # different data for different layers 
      mapping = aes(x = P_start, y = P_end, color = "sequence")) +
  geom_point(data = seq_data, size=3) +
  geom_path(mapping = aes(x = x_vals, y = y_vals, color = "projection")) +
  scale_color_manual(values=c("sequence"="blue", "projection"="black"))
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.4<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div id="projection-functions-4-4" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div></article><article class="example example-like" id="projection-functions-5"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.5</span><span class="period">.</span>
</h4>
<div class="para logical" id="projection-functions-5-1">
<div class="para">Not all recursive sequences have biological motivations. In Calculus, Newton’s method is frequently taught as a way to find the positive square root of any positive number <span class="process-math">\(a \gt 0\text{.}\)</span> The square root <span class="process-math">\(\sqrt{a}\)</span> is the positive solution to <span class="process-math">\(x^2-a=0\text{.}\)</span> Newton’s method involves creating a sequence using the recursive equation</div>
<div class="displaymath process-math">
\begin{equation*}
x_n^2 - a + 2x_n(x_{n+1}-x_n) = 0\text{.}
\end{equation*}
</div>
<div class="para">Solving this equation for <span class="process-math">\(x_{n+1}\text{,}\)</span> we find the equation that writes <span class="process-math">\(x_{n+1}\)</span> as a function of <span class="process-math">\(x_n\text{,}\)</span>
</div>
<div class="displaymath process-math">
\begin{equation*}
x_{n+1} = \frac{x_n}{2} + \frac{a}{2x_n} = f(x_n)\text{.}
\end{equation*}
</div>
<div class="para">The projection function in this example is</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = \frac{x}{2} + \frac{a}{2x}.
\end{equation*}
</div>
</div>
<div class="para" id="projection-functions-5-2">The sequence generated in the code below solves for <span class="process-math">\(\sqrt{3}\)</span> by using <span class="process-math">\(a=3\text{.}\)</span> The initial value was chosen as <span class="process-math">\(a=1\text{.}\)</span> The relation <span class="process-math">\((x_n, x_{n+1})\)</span> is graphed along with <span class="process-math">\(y=f(x)\text{.}\)</span> The method converges very quickly, so not many distinct points appear.</div>
<figure class="listing figure-like" id="projection-functions-5-3"><div class="code-box"><pre class="program"><code class="language-r">library(tidyr)   # for tibble
library(ggplot2) # for ggplot

# Set values for the model parameters and initial value
a &lt;- 3
x0 &lt;- 1

# Specify the size of the sequence and create space in memory
num_pts &lt;- 20
newton &lt;- double(num_pts)

# Generate the sequence
newton[1] &lt;- x0
for (n in 1:(num_pts-1)) {
    newton[n+1] &lt;- newton[n]/2 + a/(2 * newton[n])
}
# Store as x_start and x_end
seq_data &lt;- tibble(x_start = newton[1:(num_pts-1)],
                      x_end=newton[2:num_pts])

# Generate a graph of the projection function
# Create x-values between 0 and the largest value of P in our data
x_vals &lt;- seq(from=min(newton), to=max(newton), length=200)
# Vectorized calculation of y = f(x)
y_vals &lt;- x_vals / 2 + a / (2 * x_vals)

# Create a plot with sequential values (P_n,P_(n+1)) and y=f(x)
ggplot(data = NULL,   # different data for different layers 
      mapping = aes(x = x_start, y = x_end, color = "sequence")) +
  geom_point(data = seq_data, size=3) +
  geom_path(mapping = aes(x = x_vals, y = y_vals, color = "projection")) +
  scale_color_manual(values=c("sequence"="blue", "projection"="black"))
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.6<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div id="projection-functions-5-4" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div></article><div class="para" id="projection-functions-6">In each of our examples above, we started with sequences defined recursively and showed that the relation <span class="process-math">\((x_n, x_{n+1})\)</span> always matched the graph <span class="process-math">\(y=f(x)\)</span> for the projection function <span class="process-math">\(f\text{.}\)</span>` The projection function is the rule that when given the value of <span class="process-math">\(x_n\text{,}\)</span> we can predict the value of <span class="process-math">\(x_{n+1} = f(x_n)\text{.}\)</span> From a modeling perspective, we <em class="emphasis">find</em> projection functions by looking at the relation given by the scatter plot of <span class="process-math">\((x_n, x_{n+1})\)</span> when data are available and find an appropriate function. When data are not available, we can construct hypotheses for the relation and build an appropriate model to explore the behavior if such a model were relevant.</div>
<article class="example example-like" id="projection-functions-7"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.7</span><span class="period">.</span>
</h4>
<div class="para" id="projection-functions-7-1-1">The table below gives the values of a sequence <span class="process-math">\(z_n\)</span> for <span class="process-math">\(n=0,\ldots,10\text{.}\)</span> Analyze the data to find a reasonable projection function.</div> <figure class="table table-like" id="projection-functions-7-1-2"><figcaption><span class="type">Table</span><span class="space"> </span><span class="codenumber">2.4.8<span class="period">.</span></span><span class="space"> </span></figcaption><div class="tabular-box natural-width"><table class="tabular">
<tr>
<td class="l m b3 r3 l0 t0 lines"><span class="process-math">\(n\)</span></td>
<td class="l m b3 r0 l0 t0 lines"><span class="process-math">\(z_n\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(0\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(1.00\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(1\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(3.42\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(2\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(10.21\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(3\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(17.99\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(4\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(6.50\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(5\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(15.80\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(6\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(11.95\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(7\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(17.32\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(8\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(8.37\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(9\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(17.52\)</span></td>
</tr>
<tr>
<td class="l m b0 r3 l0 t0 lines"><span class="process-math">\(10\)</span></td>
<td class="l m b0 r0 l0 t0 lines"><span class="process-math">\(7.82\)</span></td>
</tr>
</table></div></figure><div class="solutions"><details id="projection-functions-7-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para logical" id="projection-functions-7-2-1">
<div class="para">We start by creating a plot of the projection relation, corresponding to a scatter plot of points <span class="process-math">\((z_n,z_{n+1})\text{.}\)</span> When <span class="process-math">\(n=0\text{,}\)</span> we have <span class="process-math">\((z_0,z_1) = (1.0, 3.42)\text{.}\)</span> The next few points are expressed below:</div>
<div class="displaymath process-math" id="projection-functions-7-2-1-4">
\begin{gather*}
n=1 \quad \Rightarrow \quad (z_1,z_2) = (3.42, 10.21) \\
n=2 \quad \Rightarrow \quad (z_2,z_3) = (10.21, 17.99) \\
n=3 \quad \Rightarrow \quad (z_3,z_4) = (17.99, 6.50) 
\end{gather*}
</div>
<div class="para">We can create this graph in R using the following script. Our original set of data had index values <span class="process-math">\(n=0, 1, \ldots, 10\text{,}\)</span> which corresponds to 11 points. However, when we think of our data as values before/after, there can be at most 10 pairs. The code below defines columns that use a subset of the entries.</div>
</div>
<figure class="listing figure-like" id="projection-functions-7-2-2"><div class="code-box"><pre class="program"><code class="language-r">library(tidyr)
library(ggplot2)

# Create the sequence vector directly
z &lt;- c(1.00, 3.42, 10.21, 17.99, 6.50, 15.80, 11.95, 17.32, 8.37, 17.52, 7.82)
N &lt;- length(z)
# z_start has all but the last value; z_end has all but the first value
z_data &lt;- tibble(z_start = z[1:N-1], z_end = z[2:N])

# Graph the relation
ggplot(data = z_data,
       mapping = aes(x = z_start, y = z_end)) +
  geom_point(color="blue")
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.9<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="projection-functions-7-2-3"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/projection-from-data-01.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.4.10<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div id="projection-functions-7-2-4" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<div class="para" id="projection-functions-7-2-5">The figure strongly suggests the shape of a parabola so that the relation likely involves a quadratic formula. A quadratic function has the form <span class="process-math">\(f(x) = ax^2 + bx + c\text{,}\)</span> which we could rewrite in the form <span class="process-math">\(f(x) = c + bx + ax^2\text{.}\)</span> This can be interpreted as a <em class="emphasis">linear</em> model with a <span class="process-math">\(y\)</span>-intercept <span class="process-math">\(c\)</span> and two explanatory variables coming from <span class="process-math">\(x\)</span> and <span class="process-math">\(x^2\text{.}\)</span> We can continue our script to estimate the coefficients for the model by using <code class="code-inline tex2jax_ignore">lm</code> with <code class="code-inline tex2jax_ignore">formula = y ~ x + x2</code> where <code class="code-inline tex2jax_ignore">x2</code> is going to be an extra column defined by <code class="code-inline tex2jax_ignore">x2 = x^2</code>. Add the following code to the script defined above or after having already executed the code above.</div>
<figure class="listing figure-like" id="projection-functions-7-2-6"><div class="code-box"><pre class="program"><code class="language-r"># Add new columns to z_data
library(dplyr)
z_data |&gt;
  mutate(z = z_start) |&gt;  # z is a simpler name than z_start
  mutate(z2 = z^2) -&gt;
  z_data2
# Do linear model
z_model &lt;- lm(formula = z_end ~ z + z2, data = z_data2)
z_model$coefficients
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.11<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="code-box"><pre class="console"> (Intercept)             z            z2 
0.0005194086  3.6003271165 -0.1800141078
</pre></div>
<div id="projection-functions-7-2-8" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<div class="para logical" id="projection-functions-7-2-9">
<div class="para">From the regression, we see that we have values <span class="process-math">\(a = -0.180014\text{,}\)</span> <span class="process-math">\(b = 3.600327\text{,}\)</span> and <span class="process-math">\(c = 0.0005194\text{.}\)</span> Based on those values, we could construct a sequence using the recursive equation</div>
<div class="displaymath process-math">
\begin{equation*}
z_{n+1} = 0.0005194 + 3.600327 z_n - 0.180014 z_n^2\text{.}
\end{equation*}
</div>
<div class="para">Our original sequence data only showed two decimal places in the values, so we should think of our coefficients as having their own uncertainty. Let’s compare what happens with the sequence using those estimated values with another sequence using the very similar <span class="process-math">\(u_{n+1} = 3.6 u_n - 0.18 u_n^2\text{.}\)</span> The code below also illustrates how we can format a table.</div>
</div>
<figure class="listing figure-like" id="projection-functions-7-2-10"><div class="code-box"><pre class="program"><code class="language-r"># Model parameters
a &lt;- -0.180014
a2 &lt;- -0.18
b &lt;- 3.600327
b2 &lt;- 3.6
c &lt;- 0.0005194

# Initial value
z0 &lt;- 1.00
num_pts &lt;- 10

# Build the sequences z and u
z &lt;- double(num_pts + 1)
u &lt;- double(num_pts + 1)
z[1] &lt;- z0
u[1] &lt;- z0
for (n in 1:num_pts) {
    z[n+1] &lt;- c + b * z[n] + a * z[n]^2
    u[n+1] &lt;- b2 * u[n] + a2 * u[n]^2
}

# Layout a table showing the values
my_data &lt;- tibble(t = 0:num_pts, z = z, u = u)
print(my_data)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.12<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="code-box"><pre class="console"># A tibble: 11 × 3
    t     z     u
&lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1     0  1     1   
2     1  3.42  3.42
3     2 10.2  10.2 
4     3 18.0  18.0 
5     4  6.50  6.50
6     5 15.8  15.8 
7     6 12.0  11.9 
8     7 17.3  17.3 
9     8  8.38  8.37
10     9 17.5  17.5 
11    10  7.80  7.82
</pre></div>
<div id="projection-functions-7-2-12" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<div class="para" id="projection-functions-7-2-13">Perhaps surprisingly, the rounded model did better than the fitted values. Why would this happen? The actual values of the original sequence, which I generated with a computer using the simplified parameters, were rounded in order to present them with two decimal places. Thus our starting sequence had built-in errors. When we calculated our parameters using the linear model, we did in fact find the model that matched our results with the least squared errors for the rounded sequence. However, the fitted equation did not reproduce the sequence because it actually models a nearby sequence. If we had worked with more decimal values in the original sequence, we would have found a closer model.</div>
<div class="para" id="projection-functions-7-2-14">To close the topic, the two projection functions will be visually indistinguishable in a figure. So the code below generates the graph of the original sequence as points coupled with a smooth graph showing the projection function.</div>
<figure class="listing figure-like" id="projection-functions-7-2-15"><div class="code-box"><pre class="program"><code class="language-r">library(tidyr)   # for tibble
library(ggplot2) # for ggplot

# Original sequence
z &lt;- c(1.00, 3.42, 10.21, 17.99, 6.50, 15.80, 11.95, 17.32, 8.37, 17.52, 7.82)
# Create the before/after pairings
z_proj_data &lt;- tibble(z_start = z[1:10], z_end = z[2:11])

# Data for the projection function
x &lt;- seq(from = 0, to = 20, length=200)
y &lt;- 3.6 * x - 0.18 * x^2

# Create a plot with sequential values (P_n,P_(n+1)) and y=f(x)
ggplot(data = NULL,   # different data for different layers 
      mapping = aes(x = z_start, y = z_end, color = "sequence")) +
    geom_point(data = z_proj_data, size=3) +
    geom_path(mapping = aes(x = x, y = y, color = "projection")) +
    scale_color_manual(values=c("sequence"="blue", "projection"="black"))
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.13<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div id="projection-functions-7-2-16" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<figure class="figure figure-like" id="projection-functions-7-2-17"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/proj-function-quadratic-example.svg" role="img" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.4.14<span class="period">.</span></span><span class="space"> </span></figcaption></figure>
</div></details></div></article></section><section class="subsection" id="projection-fixed-points"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">2.4.2</span><span class="space"> </span><span class="title">Fixed Points and Equilibria</span>
</h3>
<div class="para" id="projection-fixed-points-2">An <dfn class="terminology">equilibrium</dfn> represents a state of balance. For example, in chemistry, an equilibrium in a chemical reaction means that there is a balance between the reaction rates that create a chemical and those that use the chemical. It is not that nothing is happening, but that the creation and loss are perfectly balanced.</div>
<div class="para logical" id="projection-fixed-points-3">
<div class="para">A population can also be in equilibrium if the sources of all growth in the population is exactly balanced by the sources of all loss. That is, the rate of birth and immigration in a population would need to be exactly balanced by the rate of death and emigration. The effect of this balance is that the sequence is constant, namely that</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} = P_n\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="projection-fixed-points-4">When a population is modeled by a projection function, <span class="process-math">\(P_{n+1} = f(P_n)\text{,}\)</span> we can test whether an equilibrium is possible by seeing whether the equation <span class="process-math">\(x=f(x)\)</span> has any solutions. That is, since <span class="process-math">\(P_{n+1}=P_n\)</span> is true for an equilibrium, we are looking for all values of <span class="process-math">\(x\)</span> that might be used for the sequence <span class="process-math">\(P_n=x\text{.}\)</span> We call solutions to the equation <span class="process-math">\(x=f(x)\)</span> the <dfn class="terminology">fixed points</dfn> of the function <span class="process-math">\(f(x)\text{.}\)</span>
</div>
<article class="example example-like" id="projection-fixed-points-5"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.15</span><span class="period">.</span>
</h4>
<div class="para logical" id="projection-fixed-points-5-1-1">
<div class="para">Recall that Newton’s method for finding the square root <span class="process-math">\(\sqrt{a}\)</span> introduced the projection function</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = \frac{x}{2} + \frac{a}{2x}\text{.}
\end{equation*}
</div>
<div class="para">Find all of the fixed points for this function.</div>
</div>
<div class="solutions"><details id="projection-fixed-points-5-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content"><div class="para logical" id="projection-fixed-points-5-2-1">
<div class="para">We are solving the fixed point equation <span class="process-math">\(x=f(x)\)</span> which becomes</div>
<div class="displaymath process-math">
\begin{equation*}
x = \frac{x}{2} + \frac{a}{2x}\text{.}
\end{equation*}
</div>
<div class="para">Solving this equation by hand corresponds to the following steps.</div>
<div class="displaymath process-math" id="projection-fixed-points-5-2-1-3">
\begin{gather*}
x = \frac{x}{2} + \frac{a}{2x}\\
\frac{x}{2} = \frac{a}{2x}\\
x^2 = a\\
x=\pm \sqrt{a}
\end{gather*}
</div>
<div class="para">So the fixed points are the positive and negative square roots of <span class="process-math">\(a\text{.}\)</span>
</div>
</div></div></details></div></article><article class="example example-like" id="projection-fixed-points-6"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.16</span><span class="period">.</span>
</h4>
<div class="para logical" id="projection-fixed-points-6-1-1">
<div class="para">A population has a per capita net growth rate that linearly decreases with the population,</div>
<div class="displaymath process-math">
\begin{equation*}
r(P) = 0.12 - 0.0004 P\text{.}
\end{equation*}
</div>
<div class="para">Find the projection function and identify possible equilibria for this population.</div>
</div>
<div class="solutions"><details id="projection-fixed-points-6-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para logical" id="projection-fixed-points-6-2-1">
<div class="para">The per capita net growth rate is related to the change in the population through births and deaths: <span class="process-math">\(B-D = r(P) \cdot P\text{.}\)</span> As a difference equation, the population can be modeled as</div>
<div class="displaymath process-math">
\begin{equation*}
P_{n+1} - P_n = r(P_n) \cdot P_n\text{.}
\end{equation*}
</div>
<div class="para">Using the given formula for <span class="process-math">\(r(P)\text{,}\)</span> we can rewrite our model in recursive form as</div>
<div class="displaymath process-math" id="projection-fixed-points-6-2-1-4">
\begin{align*}
P_{n+1} &amp;= P_n + r(P_n) \cdot P_n\\
&amp;= P_n + (0.12 - 0.0004 P_n) P_n\\
&amp;= 1.12 P_n - 0.0004 P_n^2.
\end{align*}
</div>
<div class="para">A projection function corresponds to the function in the equation <span class="process-math">\(P_{n+1}=f(P_n)\text{,}\)</span> which we can recognize in this problem involves</div>
<div class="displaymath process-math">
\begin{equation*}
f(x) = 1.12x - 0.0004x^2\text{.}
\end{equation*}
</div>
</div>
<div class="para logical" id="projection-fixed-points-6-2-2">
<div class="para">The fixed point equation <span class="process-math">\(x=f(x)\)</span> allows us to find all fixed points (and therefore possible equilibria of the population). We solve the equation by factoring:</div>
<div class="displaymath process-math" id="projection-fixed-points-6-2-2-2">
\begin{gather*}
x = 1.12x - 0.0004 x^2\\
0 = 0.12x-0.0004x^2\\
x(0.12 - 0.0004x) = 0
\end{gather*}
</div>
<div class="para">By factoring an equation equal to zero, we find either <span class="process-math">\(x=0\)</span> (a fixed point) or <span class="process-math">\(0.12-0.0004x=0\)</span> (a simpler equation to find another fixed point). The other fixed point is <span class="process-math">\(x=\frac{0.12}{0.0004} = 300\text{.}\)</span> So the possible equilibria for this population model are the values <span class="process-math">\(P=0\)</span> or <span class="process-math">\(P=300\text{.}\)</span> (Notice how we interpreted in the context of the state variable <span class="process-math">\(P\)</span> rather than the fixed point variable <span class="process-math">\(x\text{.}\)</span>)</div>
</div>
</div></details></div></article><div class="para" id="projection-fixed-points-7">A sequence that starts at a fixed point will lead to a constant sequence, holding steady at the same value indefinitely. If the initial value of the sequence is not a fixed point, then next value will definitely be different and it can be challenging to predict in advance whether the sequence will eventually converge or not. Whether a sequence converges to a fixed point depends significantly on whether the fixed point is stable or unstable.</div>
<div class="para" id="projection-fixed-points-8">A fixed point is <dfn class="terminology">locally stable</dfn> if every sequence that starts sufficiently close to the fixed point will always converge to the fixed point. Often, the sequence does not need to start very close at all to converge to a stable fixed point. However, a fixed point is <dfn class="terminology">locally unstable</dfn> if regardless of how close you look, there will be at least one nearby initial value that results in a sequence that moves further away from the fixed point instead. That sequence might eventually return to this or another fixed point, but we only care if it initially moves away. For now, we will just look at the values of nearby sequences and see if they converge or not.</div>
<article class="example example-like" id="projection-fixed-points-9"><h4 class="heading">
<span class="type">Example</span><span class="space"> </span><span class="codenumber">2.4.17</span><span class="period">.</span>
</h4>
<div class="para" id="projection-fixed-points-9-1-1">Find the fixed points for the projection function <span class="process-math">\(f(x) = 1.3x - 0.05x^2\text{.}\)</span> Use numerical evidence to determine if each fixed point is locally stable or unstable.</div>
<div class="solutions"><details id="projection-fixed-points-9-2" class="solution solution-like born-hidden-knowl"><summary class="knowl__link"><span class="type">Solution</span><span class="period">.</span></summary><div class="solution solution-like knowl__content">
<div class="para logical" id="projection-fixed-points-9-2-1">
<div class="para">We start by looking for fixed points algebraically. A fixed point is a solution to the equation <span class="process-math">\(x = f(x)\text{.}\)</span> Using the formula of the projection function, the relevant equation is</div>
<div class="displaymath process-math">
\begin{equation*}
x = 1.3x - 0.05x^2\text{.}
\end{equation*}
</div>
<div class="para">Even though <span class="process-math">\(x\)</span> is a common factor, avoid the temptation to divide it out. This is a sure-fire way to lose an important solution. Instead, it is better to adopt a strategy solving <span class="process-math">\(f(x)-x = 0\)</span> using factoring.</div>
<div class="displaymath process-math" id="projection-fixed-points-9-2-1-5">
\begin{align*}
x \amp= 1.3x - 0.05 x^2 \\
0 \amp= -x + 1.3x - 0.05 x^2 \\
0 \amp= 0.3x - 0.05 x^2 \\
0 \amp= x(0.3 - 0.05 x) 
\end{align*}
</div>
<div class="para">From this factored equation, we see solutions occur when <span class="process-math">\(x=0\)</span> or when <span class="process-math">\(0.3 - 0.05x = 0\text{.}\)</span> That is, <span class="process-math">\(x=0\)</span> is one fixed point. Solving <span class="process-math">\(0.3-0.05x = 0\)</span> results in a second fixed point <span class="process-math">\(x = 6\text{.}\)</span>
</div>
</div>
<div class="para" id="projection-fixed-points-9-2-2">To see if a fixed point is locally stable or unstable, we can get some numerical intuition by looking at sequence solutions that start relatively close to the fixed point. The first constructed sequence will look at the fixed point <span class="process-math">\(x=0\text{.}\)</span>
</div>
<figure class="listing figure-like" id="projection-fixed-points-9-2-3"><div class="code-box"><pre class="program"><code class="language-r">N &lt;- 20    # Number of values we calculate

# One sequence will have the fixed point as initial value
fp_seq &lt;- double(N+1)
# Another sequence will be close
nearby_seq &lt;- double(N+1)

# Define a projection function as a function
project_fcn &lt;- function(x) { 1.3*x - 0.05*x^2 }

# Do two sequences at the same time
fp_seq[1] &lt;- 0       # At the fixed point
nearby_seq[1] &lt;- 0.1 # Just above the fixed point
for (n in 1:N) {
    fp_seq[n+1] &lt;- project_fcn( fp_seq[n] )
    nearby_seq[n+1] &lt;- project_fcn( nearby_seq[n] )
}

# Organize into a tibble dataframe so both can be plotted together
library(tidyr)
library(dplyr)
library(ggplot2)

seq_data &lt;- tibble(t = 0:N, fp = fp_seq, nearby = nearby_seq)
# Combine fp and nearby into same common to be tidy style, then plot
pivot_longer(seq_data, cols = c(fp, nearby),
             values_to = "value", names_to = "sequence") |&gt;
    ggplot(mapping = aes(x = t, y = value, color = sequence)) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.18<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/proj-function-fp-stability-01.png" class="contained"></div>
<div id="projection-fixed-points-9-2-5" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<div class="para" id="projection-fixed-points-9-2-6">From the result, we see that the sequence that started just off the fixed point had sequence values the moved <em class="emphasis">away</em> from the fixed point sequence. This is strong evidence that the fixed point <span class="process-math">\(x=0\)</span> is locally unstable. It is not definitive because this one example doesn’t show whether an even closer starting value might instead move toward the fixed point.</div>
<div class="para" id="projection-fixed-points-9-2-7">We next consider the fixed point at <span class="process-math">\(x=6\text{.}\)</span> Again, we visualize the fixed point sequence along with a sequence that starts nearby.</div>
<figure class="listing figure-like" id="projection-fixed-points-9-2-8"><div class="code-box"><pre class="program"><code class="language-r">N &lt;- 20    # Number of values we calculate

# One sequence will have the fixed point as initial value
fp_seq &lt;- double(N+1)
# Another sequence will be close
nearby_seq &lt;- double(N+1)

# Define a projection function as a function
project_fcn &lt;- function(x) { 1.3*x - 0.05*x^2 }

# Do two sequences at the same time
fp_seq[1] &lt;- 6       # At the fixed point
nearby_seq[1] &lt;- 6.1 # Just above the fixed point
for (n in 1:N) {
    fp_seq[n+1] &lt;- project_fcn( fp_seq[n] )
    nearby_seq[n+1] &lt;- project_fcn( nearby_seq[n] )
}

# Organize into a tibble dataframe so both can be plotted together
library(tidyr)
library(dplyr)
library(ggplot2)

seq_data &lt;- tibble(t = 0:N, fp = fp_seq, nearby = nearby_seq)
# Combine fp and nearby into same common to be tidy style, then plot
pivot_longer(seq_data, cols = c(fp, nearby),
             values_to = "value", names_to = "sequence") |&gt;
    ggplot(mapping = aes(x = t, y = value, color = sequence)) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.4.19<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/proj-function-fp-stability-02.png" class="contained"></div>
<div id="projection-fixed-points-9-2-10" class="ptx-sagecell sagecell-r"><script type="text/x-sage">
</script></div>
<div class="para" id="projection-fixed-points-9-2-11">In this case, we see that the sequence that started just off the fixed point had sequence values the moved <em class="emphasis">toward</em> the fixed point sequence. This is strong evidence that the fixed point <span class="process-math">\(x=0\)</span> might be locally stable. It is not definitive <em class="emphasis">all</em> sequences that start sufficiently close need to demonstrate this behavior. We are only able to inspect a few at a time through graphs.</div>
</div></details></div></article><div class="para" id="projection-fixed-points-10">We will want a more definitive approach to determining whether fixed points are locally stable or unstable. The next section will demonstrate how the derivative of the projection function contains the necessary information to make this decision.</div></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="sec-population-density-dependent.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="projection-analysis.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866"><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png"></a>
</div>
</body>
</html>
