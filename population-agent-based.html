<!DOCTYPE html>
<!--********************************************-->
<!--*       Generated from PreTeXt source      *-->
<!--*                                          *-->
<!--*         https://pretextbook.org          *-->
<!--*                                          *-->
<!--********************************************-->
<html lang="en-US" dir="ltr">
<head xmlns:og="http://ogp.me/ns#" xmlns:book="https://ogp.me/ns/book#">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>An Agent Based Motivation for Dynamics</title>
<meta name="Keywords" content="Authored in PreTeXt">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta property="og:type" content="book">
<meta property="book:title" content="Dynamic Models for Biology">
<meta property="book:author" content="D. Brian Walton">
<script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script><script>
var runestoneMathReady = new Promise((resolve) => window.rsMathReady = resolve);
window.MathJax = {
  "tex": {
    "inlineMath": [
      [
        "\\(",
        "\\)"
      ]
    ],
    "tags": "none",
    "tagSide": "right",
    "tagIndent": ".8em",
    "packages": {
      "[+]": [
        "base",
        "extpfeil",
        "ams",
        "amscd",
        "color",
        "newcommand",
        "knowl"
      ]
    }
  },
  "options": {
    "ignoreHtmlClass": "tex2jax_ignore|ignore-math",
    "processHtmlClass": "process-math",
    "renderActions": {
      "findScript": [
        10,
        function (doc) {
            document.querySelectorAll('script[type^="math/tex"]').forEach(function(node) {
                var display = !!node.type.match(/; *mode=display/);
                var math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
                var text = document.createTextNode('');
                node.parentNode.replaceChild(text, node);
                math.start = {node: text, delim: '', n: 0};
                math.end = {node: text, delim: '', n: 0};
                doc.math.push(math);
            });
        },
        ""
      ]
    }
  },
  "chtml": {
    "scale": 0.98,
    "mtextInheritFont": true
  },
  "loader": {
    "load": [
      "input/asciimath",
      "[tex]/extpfeil",
      "[tex]/amscd",
      "[tex]/color",
      "[tex]/newcommand",
      "[pretext]/mathjaxknowl3.js"
    ],
    "paths": {
      "pretext": "_static/pretext/js/lib"
    }
  },
  "startup": {
    pageReady() {
      return MathJax.startup.defaultPageReady().then(function () {
      console.log("in ready function");
      rsMathReady();
      }
    )}
  }
};
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-numbers/prism-line-numbers.min.js" integrity="sha512-dubtf8xMHSQlExGRQ5R7toxHLgSDZ0K7AunqPWHXmJQ8XyVIG19S1T95gBxlAeGOK02P4Da2RTnQz0Za0H0ebQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/line-highlight/prism-line-highlight.min.js" integrity="sha512-93uCmm0q+qO5Lb1huDqr7tywS8A2TFA+1/WHvyiWaK6/pvsFl6USnILagntBx8JnVbQH5s3n0vQZY6xNthNfKA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js" integrity="sha512-4xUl/d6D6THrAnXAwGajXkoWaeMNwEKK4iNfq5DotEbLPAfk6FSxSP3ydNxqDgCw1c/0Z1Jg6L8h2j+++9BZmg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><script src="lunr-pretext-search-index.js" async=""></script><script src="_static/pretext/js/pretext_search.js"></script><script src="_static/pretext/js/lib/jquery.min.js"></script><script src="_static/pretext/js/lib/jquery.sticky.js"></script><script src="_static/pretext/js/lib/jquery.espy.min.js"></script><script src="_static/pretext/js/pretext.js"></script><script src="_static/pretext/js/pretext_add_on.js?x=1"></script><script src="_static/pretext/js/user_preferences.js"></script><script src="_static/pretext/js/lib/knowl.js"></script><!--knowl.js code controls Sage Cells within knowls--><script>sagecellEvalName='Evaluate (Sage)';
</script><link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
<link href="_static/pretext/css/theme.css" rel="stylesheet" type="text/css">
<link href="_static/pretext/css/ol-markers.css" rel="stylesheet" type="text/css">
<!--** eBookCongig is necessary to configure interactive       **-->
<!--** Runestone components to run locally in reader's browser **-->
<!--** No external communication:                              **-->
<!--**     log level is 0, Runestone Services are disabled     **-->
<script type="text/javascript">
eBookConfig = {};
eBookConfig.useRunestoneServices = false;
eBookConfig.host = 'http://127.0.0.1:8000';
eBookConfig.course = 'PTX_Course_Title_Here';
eBookConfig.basecourse = 'PTX_Base_Course';
eBookConfig.isLoggedIn = false;
eBookConfig.email = '';
eBookConfig.isInstructor = false;
eBookConfig.logLevel = 0;
eBookConfig.username = '';
eBookConfig.readings = null;
eBookConfig.activities = null;
eBookConfig.downloadsEnabled = false;
eBookConfig.allow_pairs = false;
eBookConfig.enableScratchAC = false;
eBookConfig.build_info = "";
eBookConfig.python3 = null;
eBookConfig.runestone_version = '7.5.10';
eBookConfig.jobehost = '';
eBookConfig.proxyuri_runs = '';
eBookConfig.proxyuri_files = '';
eBookConfig.enable_chatcodes =  false;
</script>
<!--*** Runestone Services ***-->
<script src="_static/prefix-runtime.c2d04816128ebb44.bundle.js"></script><script src="_static/prefix-723.3e6434f80549315a.bundle.js"></script><script src="_static/prefix-runestone.f6bda0c0ccce4835.bundle.js"></script><link rel="stylesheet" type="text/css" href="_static/prefix-723.3bccd435914aa0ff.css">
<link rel="stylesheet" type="text/css" href="_static/prefix-runestone.e0c6d4592e23c667.css">
</head>
<body id="dmb" class="pretext book ignore-math">
<a class="assistive" href="#ptx-content">Skip to main content</a><header id="ptx-masthead" class="ptx-masthead"><div class="ptx-banner"><div class="title-container">
<h1 class="heading"><a href="my-great-book.html"><span class="title">Dynamic Models for Biology</span></a></h1>
<p class="byline">D. Brian Walton</p>
</div></div></header><nav id="ptx-navbar" class="ptx-navbar navbar"><div class="ptx-navbar-contents">
<button class="toc-toggle button" title="Contents"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5d2;</span><span class="name">Contents</span></button><div class="searchbox">
<div class="searchwidget"><button id="searchbutton" class="searchbutton button" type="button" title="Search book"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe8b6;</span><span class="name">Search Book</span></button></div>
<div id="searchresultsplaceholder" class="searchresultsplaceholder" style="display: none">
<div class="search-results-controls">
<input aria-label="Search term" id="ptxsearch" class="ptxsearch" type="text" name="terms" placeholder="Search term"><button title="Close search" id="closesearchresults" class="closesearchresults"><span class="material-symbols-outlined">close</span></button>
</div>
<h2 class="search-results-heading">Search Results: </h2>
<div id="searchempty" class="searchempty"><span>No results.</span></div>
<ol id="searchresults" class="searchresults"></ol>
</div>
</div>
<span class="nav-other-controls"><button id="light-dark-button" class="light-dark-button button" title="Dark Mode"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe51c;</span><span class="name">Dark Mode</span></button></span><span class="treebuttons"><a class="previous-button button" href="populations.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="up-button button" href="populations.html" title="Up"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Up</span></a><a class="next-button button" href="sec-population-discrete.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a></span>
</div></nav><div id="latex-macros" class="hidden-content process-math" style="display:none"><span class="process-math">\(\newcommand{\N}{\mathbb N} \newcommand{\Z}{\mathbb Z} \newcommand{\Q}{\mathbb Q} \newcommand{\R}{\mathbb R}
\newcommand{\lt}{&lt;}
\newcommand{\gt}{&gt;}
\newcommand{\amp}{&amp;}
\definecolor{fillinmathshade}{gray}{0.9}
\newcommand{\fillinmath}[1]{\mathchoice{\colorbox{fillinmathshade}{$\displaystyle     \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\textstyle        \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptstyle      \phantom{\,#1\,}$}}{\colorbox{fillinmathshade}{$\scriptscriptstyle\phantom{\,#1\,}$}}}
\)</span></div>
<div class="ptx-page">
<div id="ptx-sidebar" class="ptx-sidebar"><nav id="ptx-toc" class="ptx-toc depth2 focused" data-preexpanded-levels="0" data-max-levels="2"><ul class="structural toc-item-list contains-active">
<li class="toc-item toc-frontmatter"><div class="toc-title-box"><a href="frontmatter.html" class="internal"><span class="title">Front Matter</span></a></div></li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="mathematical-modeling.html" class="internal"><span class="codenumber">1</span> <span class="title">Mathematical Modeling</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="scientific-method.html" class="internal"><span class="codenumber">1.1</span> <span class="title">The Scientific Method</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="role-of-models.html" class="internal"><span class="codenumber">1.2</span> <span class="title">The Role of Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="measurements.html" class="internal"><span class="codenumber">1.3</span> <span class="title">Measurements</span></a></div>
<ul class="structural toc-item-list"><li class="toc-item toc-exercises"><div class="toc-title-box"><a href="measurements.html#exercises-measurements" class="internal"><span class="codenumber">1.3</span> <span class="title">Exercises</span></a></div></li></ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="system-state.html" class="internal"><span class="codenumber">1.4</span> <span class="title">The State of a System</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-intro-ggplot.html" class="internal"><span class="codenumber">1.5</span> <span class="title">Introducing tidyverse and ggplot</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-mm-variable-relations.html" class="internal"><span class="codenumber">1.6</span> <span class="title">Relations between Variables</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-chapter contains-active">
<div class="toc-title-box"><a href="populations.html" class="internal"><span class="codenumber">2</span> <span class="title">Population Dynamics</span></a></div>
<ul class="structural toc-item-list contains-active">
<li class="toc-item toc-section contains-active">
<div class="toc-title-box"><a href="population-agent-based.html" class="internal"><span class="codenumber">2.1</span> <span class="title">An Agent Based Motivation for Dynamics</span></a></div>
<ul class="structural toc-item-list active">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-based-3" class="internal"><span class="codenumber">2.1.1</span> <span class="title">NetLogo Overview</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-naive" class="internal"><span class="codenumber">2.1.2</span> <span class="title">Environmentally Naive Births and Deaths</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-agent-based.html#population-agent-density-dependent" class="internal"><span class="codenumber">2.1.3</span> <span class="title">Density-Dependent Births and Deaths</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-discrete.html" class="internal"><span class="codenumber">2.2</span> <span class="title">Discrete Population Models</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-population-density-dependent.html" class="internal"><span class="codenumber">2.3</span> <span class="title">Density Dependent Population Growth Models</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-projection.html" class="internal"><span class="codenumber">2.4</span> <span class="title">Recursive Models Using Projection</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-functions" class="internal"><span class="codenumber">2.4.1</span> <span class="title">Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-projection.html#projection-fixed-points" class="internal"><span class="codenumber">2.4.2</span> <span class="title">Fixed Points and Equilibria</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-analysis.html" class="internal"><span class="codenumber">2.5</span> <span class="title">Analysis of Population Projections</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#linear-projection-analysis" class="internal"><span class="codenumber">2.5.1</span> <span class="title">Linear Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-4" class="internal"><span class="codenumber">2.5.2</span> <span class="title">Linearizing Projection Functions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-analysis.html#projection-analysis-5" class="internal"><span class="codenumber">2.5.3</span> <span class="title">Computer Assisted Analysis</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="projection-cobweb.html" class="internal"><span class="codenumber">2.6</span> <span class="title">Graphical Analysis of Projection Functions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-compare-replacement" class="internal"><span class="codenumber">2.6.1</span> <span class="title">Visualizing Potential for Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#cobweb-diagrams" class="internal"><span class="codenumber">2.6.2</span> <span class="title">Cobweb Diagrams</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="projection-cobweb.html#projection-cobweb-5" class="internal"><span class="codenumber">2.6.3</span> <span class="title">Cobwebs and Stability</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="population-interventions.html" class="internal"><span class="codenumber">2.7</span> <span class="title">Intervention and Bifurcations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-constant-harvesting" class="internal"><span class="codenumber">2.7.1</span> <span class="title">Constant Harvesting</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="population-interventions.html#population-interventions-4" class="internal"><span class="codenumber">2.7.2</span> <span class="title">Proportional Harvesting</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-structured-populations.html" class="internal"><span class="codenumber">3</span> <span class="title">Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-two-stage.html" class="internal"><span class="codenumber">3.1</span> <span class="title">Two Stage Populations</span></a></div></li>
<li class="toc-item toc-section"><div class="toc-title-box"><a href="sec-structure-matrix-models.html" class="internal"><span class="codenumber">3.2</span> <span class="title">Matrix Models for Structured Populations</span></a></div></li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html" class="internal"><span class="codenumber">3.3</span> <span class="title">Example: Mosquito Growth</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-3" class="internal"><span class="codenumber">3.3.1</span> <span class="title">Model Equations and Parameters</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-4" class="internal"><span class="codenumber">3.3.2</span> <span class="title">Simulation, Asymptotic Growth, and Stable Distributions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-example-mosquitoes.html#sec-structure-example-mosquitoes-5" class="internal"><span class="codenumber">3.3.3</span> <span class="title">Exploring the Impact of Additional Mortality</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-structure-density-dependent.html" class="internal"><span class="codenumber">3.4</span> <span class="title">Density Dependence in Structured Populations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-model" class="internal"><span class="codenumber">3.4.1</span> <span class="title">Model Development</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#sec-structure-density-dependent-4" class="internal"><span class="codenumber">3.4.2</span> <span class="title">Simulation</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-density-equilibria" class="internal"><span class="codenumber">3.4.3</span> <span class="title">Finding Fixed Points for Structured Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-partial-derivatives" class="internal"><span class="codenumber">3.4.4</span> <span class="title">Partial Derivatives</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-structure-density-dependent.html#subsec-structure-fixed-point-stability" class="internal"><span class="codenumber">3.4.5</span> <span class="title">Testing the Stability of a Fixed Point</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="ch-continuous-dynamics.html" class="internal"><span class="codenumber">4</span> <span class="title">Continuous Dynamics</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="intro-differential-equations.html" class="internal"><span class="codenumber">4.1</span> <span class="title">Introduction to Differential Equations</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-rates-of-change" class="internal"><span class="codenumber">4.1.1</span> <span class="title">Rates of Change</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#differential-equations" class="internal"><span class="codenumber">4.1.2</span> <span class="title">Differential Equations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-slope-fields" class="internal"><span class="codenumber">4.1.3</span> <span class="title">Slope Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="intro-differential-equations.html#subsec-diffeq-numerical-solutions" class="internal"><span class="codenumber">4.1.4</span> <span class="title">Numerical Solutions to Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="diffeq-population-models.html" class="internal"><span class="codenumber">4.2</span> <span class="title">Continuous Time Population Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-popn-density-dependent" class="internal"><span class="codenumber">4.2.1</span> <span class="title">Continuous Logistic Growth</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="diffeq-population-models.html#subsec-diffeq-rescaling" class="internal"><span class="codenumber">4.2.2</span> <span class="title">Dimensional Analysis and Rescaling</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="sec-diffeq-equilibria.html" class="internal"><span class="codenumber">4.3</span> <span class="title">Analysis of Equilibria, Drug Dosing, and the Allee effect</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-diffeq-phase-line" class="internal"><span class="codenumber">4.3.1</span> <span class="title">The Phase Line</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="sec-diffeq-equilibria.html#subsec-equilibria-examples" class="internal"><span class="codenumber">4.3.2</span> <span class="title">Applications</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html" class="internal"><span class="codenumber">4.4</span> <span class="title">Interacting Variables and Producer-Consumer Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-phase-plane-vector-fields" class="internal"><span class="codenumber">4.4.1</span> <span class="title">The Phase Plane and Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-interacting-populations.html#subsec-diffeq-systems-differential-equations" class="internal"><span class="codenumber">4.4.2</span> <span class="title">Systems of Differential Equations</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html" class="internal"><span class="codenumber">4.5</span> <span class="title">Phase Plane Analysis with Nullclines, Competition and Predator-Prey Models</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-competition-models" class="internal"><span class="codenumber">4.5.1</span> <span class="title">Competition Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-nullcline-analysis" class="internal"><span class="codenumber">4.5.2</span> <span class="title">Nullcline Analysis</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="seq-diffeq-nullclines-predation-competition.html#subsec-diffeq-predator-prey" class="internal"><span class="codenumber">4.5.3</span> <span class="title">The Predator-Prey Model</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-chapter">
<div class="toc-title-box"><a href="interactions.html" class="internal"><span class="codenumber">5</span> <span class="title">Modeling Interactions</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-examples.html" class="internal"><span class="codenumber">5.1</span> <span class="title">Examples of Interacting Systems</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-3" class="internal"><span class="codenumber">5.1.1</span> <span class="title">Epidemic Models</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-4" class="internal"><span class="codenumber">5.1.2</span> <span class="title">Interacting Populations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-examples.html#system-examples-5" class="internal"><span class="codenumber">5.1.3</span> <span class="title">Age or Stage-Based Models</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="interaction-rate-models.html" class="internal"><span class="codenumber">5.2</span> <span class="title">Modeling Interaction Rates</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-3" class="internal"><span class="codenumber">5.2.1</span> <span class="title">Linear Rates and Linear Combinations</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-4" class="internal"><span class="codenumber">5.2.2</span> <span class="title">Logistic Growth with Functional Dependence</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-5" class="internal"><span class="codenumber">5.2.3</span> <span class="title">Law of Mass Action for Interactions</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-6" class="internal"><span class="codenumber">5.2.4</span> <span class="title">Saturating Functional Response</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="interaction-rate-models.html#interaction-rate-models-7" class="internal"><span class="codenumber">5.2.5</span> <span class="title">Switching Functional Response</span></a></div></li>
</ul>
</li>
<li class="toc-item toc-section">
<div class="toc-title-box"><a href="system-phase-space.html" class="internal"><span class="codenumber">5.3</span> <span class="title">Dynamical Systems and Phase Space</span></a></div>
<ul class="structural toc-item-list">
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#vector-fields" class="internal"><span class="codenumber">5.3.1</span> <span class="title">Vector Fields</span></a></div></li>
<li class="toc-item toc-subsection"><div class="toc-title-box"><a href="system-phase-space.html#system-phase-space-4" class="internal"><span class="codenumber">5.3.2</span> <span class="title">Nullclines and Equilibria</span></a></div></li>
</ul>
</li>
</ul>
</li>
<li class="toc-item toc-backmatter"><div class="toc-title-box"><a href="backmatter.html" class="internal"><span class="title">Backmatter</span></a></div></li>
</ul></nav></div>
<main class="ptx-main"><div id="ptx-content" class="ptx-content"><section class="section" id="population-agent-based"><h2 class="heading hide-type">
<span class="type">Section</span><span class="space"> </span><span class="codenumber">2.1</span><span class="space"> </span><span class="title">An Agent Based Motivation for Dynamics</span>
</h2>
<section class="introduction" id="population-agent-based-2"><div class="para" id="population-agent-based-2-1">We start our modeling by thinking about an <dfn class="terminology">agent-based model</dfn>. An agent-based model is a computer simulation in which abstract agents are defined on a computer with a collection of rules for what they do in time and how the different agents interact with one another. In the context of a population, we might think of the agents as simulating individuals within a virtual population. The rules describe the patterns of life that the individuals follow.</div>
<div class="para" id="population-agent-based-2-2">By first thinking about how we would implement an agent-based model for a system, we are engaging the process of establishing an abstract representation of the fundamental assumptions identified in a hypothesis on how the system develops in time. Generally, we want to minimize the number of rules while still capturing the essence of our hypothesis. Allowing the computer simulation to follow our rules, we can observe the dynamics relatively quickly and make virtual measurements that might guide a more mathematical model.</div></section><section class="subsection" id="population-agent-based-3"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">2.1.1</span><span class="space"> </span><span class="title">NetLogo Overview</span>
</h3>
<div class="para" id="population-agent-based-3-2">
<div class="image-box" style="width: 10%; margin-left: 45%; margin-right: 45%;"><img src="external/images/NetLogoIcon.png" class="contained"></div> NetLogo (see <a class="external" href="https://ccl.northwestern.edu/netlogo/" target="_blank">https://ccl.northwestern.edu/netlogo/</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-2-3"><summary class="ptx-footnote__number" title="Footnote 2.1.1"><sup> 1 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-2-3"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/</code></div></details>) is an example of an agent-based modeling environment, made freely available under the <a class="external" href="http://www.gnu.org/licenses/gpl-2.0.html" target="_blank">GNU General Public License</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-2-5"><summary class="ptx-footnote__number" title="Footnote 2.1.2"><sup> 2 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-2-5"><code class="code-inline tex2jax_ignore">www.gnu.org/licenses/gpl-2.0.html</code></div></details>. The agents are easily visualized as characters (called turtles) that move about a rectangular plot. The plot is subdivided into patches so that you can assign different rules of behavior that depend on which patch each turtle is on.</div>
<div class="para" id="population-agent-based-3-3">Rather than explain everything about NetLogo here, I refer you to the excellent documentation on the NetLogo website. There are three useful tutorials to get started: <a class="external" href="https://ccl.northwestern.edu/netlogo/docs/tutorial1.html" target="_blank">Tutorial 1</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-3-2"><summary class="ptx-footnote__number" title="Footnote 2.1.3"><sup> 3 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-3-2"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/docs/tutorial1.html</code></div></details> (Running Models), <a class="external" href="https://ccl.northwestern.edu/netlogo/docs/tutorial2.html" target="_blank">Tutorial 2</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-3-4"><summary class="ptx-footnote__number" title="Footnote 2.1.4"><sup> 4 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-3-4"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/docs/tutorial2.html</code></div></details> (On Turtles and Patches), and <a class="external" href="https://ccl.northwestern.edu/netlogo/docs/tutorial3.html" target="_blank">Tutorial 3</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-3-6"><summary class="ptx-footnote__number" title="Footnote 2.1.5"><sup> 5 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-3-6"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/docs/tutorial3.html</code></div></details> (Building a Model). In addition, the <a class="external" href="https://ccl.northwestern.edu/netlogo/docs/programming.html" target="_blank">NetLogo Programming Guide</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-3-8"><summary class="ptx-footnote__number" title="Footnote 2.1.6"><sup> 6 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-3-8"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/docs/programming.html</code></div></details> explains the structure of how to program and the <a class="external" href="https://ccl.northwestern.edu/netlogo/docs/dictionary.html" target="_blank">NetLogo Dictionary</a><details class="ptx-footnote" aria-live="polite" id="population-agent-based-3-3-10"><summary class="ptx-footnote__number" title="Footnote 2.1.7"><sup> 7 </sup></summary><div class="ptx-footnote__contents" id="population-agent-based-3-3-10"><code class="code-inline tex2jax_ignore">ccl.northwestern.edu/netlogo/docs/dictionary.html</code></div></details> summarizes the commands that agents automatically inherit.</div>
<div class="para" id="population-agent-based-3-4">Demo code associated with this document was written to run in NetLogo 6.4. Links are provided to download the full model. Elements of the code will be discussed. Individuals in the population will be modeled as turtle agents (meaning they are movable).</div></section><section class="subsection" id="population-agent-naive"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">2.1.2</span><span class="space"> </span><span class="title">Environmentally Naive Births and Deaths</span>
</h3>
<div class="para" id="population-agent-naive-2">When trying to define rules for how an individual will give birth to new individuals or die, we might consider complicating factors. For example, we might expect that births and death would depend on the health of the individual as well as the state of the environment in which the individual is living. However, the simplest models would not take these into account. The simplest rule for reproduction might be to decide randomly whether or not to give birth at a given cycle (tick) for the system. Similarly, we might have death be decided randomly.</div>
<div class="para" id="population-agent-naive-3">We start with the NetLogo simulation available here: <a class="external" href="external/code/netlogo/naive-population.nlogo" target="_blank"><code class="code-inline tex2jax_ignore">naive-population.nlogo</code></a>. The interface for the simulation is illustrated in <a href="population-agent-based.html#fig-naive-population-interface" class="xref" data-knowl="./knowl/xref/fig-naive-population-interface.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 2.1.1">Figure 2.1.1</a>. In the <code class="code-inline tex2jax_ignore">initial-population</code> data field, you can set the number of individuals in the population at the start of the simulation. Then there are sliders that allow you to control the percent of individuals during each population cycle that will give birth or that will die. When you press the <code class="code-inline tex2jax_ignore">setup</code> button, the population will reset based on your <code class="code-inline tex2jax_ignore">initial-population</code> entry. When you press the <code class="code-inline tex2jax_ignore">go</code> button, individuals will scramble around the screen randomly and give birth or die based on your settings. Press <code class="code-inline tex2jax_ignore">go</code> a second time to stop the simulation.</div>
<figure class="figure figure-like" id="fig-naive-population-interface"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/naive-population-interface.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.1<span class="period">.</span></span><span class="space"> </span>Interface for <code class="code-inline tex2jax_ignore">naive-population.nlogo</code>.</figcaption></figure><div class="para" id="population-agent-naive-5">You can inspect the code describing the rules for the simulation by selecting the <code class="code-inline tex2jax_ignore">code</code> tab at the top of the NetLogo window. Much of the code specifies rules for the agent and environment visualization, such as stating that our individuals are <code class="code-inline tex2jax_ignore">people</code>, defining their shapes and colors, and giving rules for how to move randomly on the screen. This gives us something interesting to look at, but does not have much to do with the biologically relevant questions of how the population changes.</div>
<div class="para" id="population-agent-naive-6">In the <code class="code-inline tex2jax_ignore">go</code> code fragment, there are statements where we ask all <code class="code-inline tex2jax_ignore">people</code> to do three things: <code class="code-inline tex2jax_ignore">try-reproduce</code> (give birth or not), <code class="code-inline tex2jax_ignore">move</code>, <code class="code-inline tex2jax_ignore">try-survive</code> (die or not). The names include “try-” as a way to indicate there is some decision involved here. The code fragment in <a href="population-agent-based.html#listing-naive-population-reproduce-survive" class="xref" data-knowl="./knowl/xref/listing-naive-population-reproduce-survive.html" data-reveal-label="Reveal" data-close-label="Close" title="Listing 2.1.2">Listing 2.1.2</a> is a minimal approach for implementing random birth and death that is naive in regards to the environment. The expression <code class="code-inline tex2jax_ignore">random-float 100</code> creates a random number between 0 and 100, so saying <code class="code-inline tex2jax_ignore">if random-float 100 &lt; birth-percent [...]</code> calculates such a random number and compares it to the number in the <code class="code-inline tex2jax_ignore">birth-percent</code> input field. If the random number is less than <code class="code-inline tex2jax_ignore">birth-percent</code>, then the command inside the brackets (<code class="code-inline tex2jax_ignore">hatch 1</code>) is sent to the corresponding <code class="code-inline tex2jax_ignore">person</code> under simulation (creating a new person). A similar calculation occurs for each <code class="code-inline tex2jax_ignore">person</code> to see if they should die (remove the person).</div>
<figure class="listing figure-like" id="listing-naive-population-reproduce-survive"><div class="code-box"><pre class="program"><code class="language-none">to try-reproduce
;; global 'birth-percent' = percent of cycles
;; in which to reproduce
if random-float 100 &lt; birth-percent [ hatch 1 ]
end

to try-survive  ;; and failure is to die
;; global 'death-percent' = percent of cycles
;; in which to die
if random-float 100 &lt; death-percent [ die ]
end
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.1.2<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="para" id="population-agent-naive-8">The actual code is slightly more complex, in that it actually creates temporary agents that are <em class="emphasis">markers</em> for birth and death events. This allows the simulation to count how many events occur each cycle by checking the simulation for how many <code class="code-inline tex2jax_ignore">birth-markers</code> or <code class="code-inline tex2jax_ignore">death-markers</code> are in the system. You will also find code at the start of the <code class="code-inline tex2jax_ignore">go</code> code that kills all of the markers before proceeding so that each cycle of the simulation only shows markers for the most recent set of events.</div>
<div class="para" id="population-agent-naive-9">If we ran a simulation using these naive rules for reproduction and survival, with every agent randomly deciding whether it will reproduce and whether it will die, we would discover that there is a lot of randomness but that the number of births and deaths seem to be related to the population size. The following graph is typical of such a simulation.</div>
<figure class="figure figure-like" id="fig-nl-pop-dyn-naive-dynamics"><div class="image-box" style="width: 70%; margin-left: 15%; margin-right: 15%;"><img src="external/images/nl-pop-dyn-naive-graph.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.3<span class="period">.</span></span><span class="space"> </span>Plot of total population, the number of births and deaths for a naive reproductive model with <code class="code-inline tex2jax_ignore">birth-percent = 16</code> and <code class="code-inline tex2jax_ignore">death-percent = 9</code> and <code class="code-inline tex2jax_ignore">initial-population = 20</code>.</figcaption></figure><div class="para" id="population-agent-naive-11">This figure illustrates that larger populations result in more births and deaths. In fact, because of how the birth and death events were randomly determined based on a percentage of the number of tick cycles for each individual, we would expect that the number of births and deaths are approximately just the corresponding percentage of the total population size. Of course, because the simulation involves random decisions, there are fluctuations above and below that amount. This randomness is called <dfn class="terminology">demographic stochasticity</dfn>.</div>
<div class="para" id="population-agent-naive-12">We would like to look at the relationship between the number of births and deaths with respect to the population size. From the simulation, we can export the data for the simulation graph. If you right-click (or control-click) on the graph, you should see a menu that includes an option to copy the image or to export the results. When you select <code class="code-inline tex2jax_ignore">Export...</code>, NetLogo will save the data points for the graph as a CSV file that can be imported into a spreadsheet or data analysis file. The file corresponding to our graph is available here: <a class="external" href="external/data/naive-population-graph-export.csv" target="_blank"><code class="code-inline tex2jax_ignore">naive-population-graph-export.csv</code></a>. If you open this with a spreadsheet application (e.g., Excel), you should see a view similar to <a href="population-agent-based.html#fig-nl-pop-dyn-naive-csv" class="xref" data-knowl="./knowl/xref/fig-nl-pop-dyn-naive-csv.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 2.1.4">Figure 2.1.4</a>.</div>
<figure class="figure figure-like" id="fig-nl-pop-dyn-naive-csv"><div class="image-box" style="width: 90%; margin-left: 5%; margin-right: 5%;"><img src="external/images/nl-pop-dyn-naive-csv.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.4<span class="period">.</span></span><span class="space"> </span>Spreadsheet view of the exported data coresponding to <a href="population-agent-based.html#fig-nl-pop-dyn-naive-dynamics" class="xref" data-knowl="./knowl/xref/fig-nl-pop-dyn-naive-dynamics.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 2.1.3">Figure 2.1.3</a></figcaption></figure><div class="para" id="population-agent-naive-14">How is this sheet organized? NetLogo reports a variety of <dfn class="terminology">metadata</dfn> at the top of the export file. For example, the second row contains the name of the NetLogo program and the third row contains the time when the data were created. Then we have a summary of the <dfn class="terminology">model parameters</dfn> that were used for the given simulation, which we need to properly document the data or to perform analysis on the results. The last set of metadata for this file is a list of the “pens” (plots) that were included in the graph.</div>
<div class="para" id="population-agent-naive-15">The actual data coming from the simulation starts in row 20. Each pen (plot) gets four reported values, where the first two values are the <dfn class="terminology">coordinates</dfn> of the plotted point. Because this graph was plotting values against time, the <span class="process-math">\(x\)</span>-coordinates for each pen are all the same and correspond to the time as tracked by the number of completed cycles. The values of the state variables <span class="process-math">\(P\text{,}\)</span> <span class="process-math">\(B\text{,}\)</span> and <span class="process-math">\(D\)</span> correspond to the <span class="process-math">\(y\)</span>-coordinates of each plot, appearing in columns <code class="code-inline tex2jax_ignore">B</code>, <code class="code-inline tex2jax_ignore">F</code>, and <code class="code-inline tex2jax_ignore">J</code>, which are ordinally (counting order) the 2nd, 6th, and 10th columns.</div>
<div class="para logical" id="population-agent-naive-16">
<div class="para">Before we proceed, we also need to understand that NetLogo is reporting values for the population <span class="process-math">\(P\text{,}\)</span> births <span class="process-math">\(B\text{,}\)</span> and deaths <span class="process-math">\(D\)</span> that were present at the <em class="emphasis">end</em> of each cycle. That is, there are actually two different population values associated with each time cycle. The population at the start of the cycle <span class="process-math">\(P_{\mathrm{start}}\)</span> represents the number of individual people in the simulation. Then we go through the births and deaths resulting in a new population value at the end of the cycle <span class="process-math">\(P_{\mathrm{end}}\text{.}\)</span> The values are related by the equation</div>
<div class="displaymath process-math">
\begin{equation*}
P_{\mathrm{end}} = P_{\mathrm{start}} + B - D\text{,}
\end{equation*}
</div>
<div class="para">in that the final number of individuals can be found by adding the number of births and then subtracting the number of deaths. The population column in the dataset corresponds to <span class="process-math">\(P_{\mathrm{end}}\text{,}\)</span> and we are going to want to know <span class="process-math">\(P_{\mathrm{start}}\text{,}\)</span> which we can find by solving the equation. This gives</div>
<div class="displaymath process-math">
\begin{equation*}
P_{\mathrm{start}} = P_{\mathrm{end}} - B + D\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="population-agent-naive-17">Once we import our data, we will generate a new column that contains the value of <span class="process-math">\(P_{\mathrm{start}}\text{.}\)</span> Then we will examine the relation between the number of births and deaths and the starting population value. Specifically, we will create graph corresponding to <span class="process-math">\((P_{\mathrm{start}},B)\)</span> and <span class="process-math">\((P_{\mathrm{start}},D)\text{.}\)</span> The code to generate this result using tidyverse libraries is given below.</div>
<figure class="listing figure-like" id="listing-naive-population-rates"><div class="code-box"><pre class="program"><code class="language-none">library(readr)    # To load CSV files (read_csv)
library(dplyr)    # To reorganize (select)
library(tidyr)    # To tidy data (pivot_longer)
library(ggplot2)  # To work with graphs (ggplot)

# Import the data
netlogo_data &lt;- read_csv("naive-population-graph-export.csv", 
                        skip = 19, col_names = FALSE)

# Select only columns 1, 2, 6, 10 and assign names
# Then add a new column for P_start
netlogo_table &lt;- netlogo_data |&gt;
    select(tick = 1, P_end = 2, B = 6, D = 10) |&gt;
    mutate(P_start = P_end - B + D)

# Pivot columns B and D values into a single column Rate
# Then plot Rate vs P_start to see relations
netlogo_table |&gt; pivot_longer(cols = c(B, D),
                            names_to = "Rate_Type",
                            values_to = "Rate") |&gt;
    ggplot(mapping = aes(x = P_start, y = Rate,
                        color = Rate_Type, shape = Rate_Type)) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.1.5<span class="period">.</span></span><span class="space"> </span></figcaption></figure><figure class="figure figure-like" id="population-agent-naive-19"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/rates-agent-naive-graph.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.6<span class="period">.</span></span><span class="space"> </span>Plot of birth and death rates for each time step of the simulation with respect to the population size at the beginning of that time step for the naive model.</figcaption></figure><div class="para" id="population-agent-naive-20">The plot suggests that the number of births and deaths occurring during each time period is approximately proportional to the population size (i.e., linear graphs passing through <span class="process-math">\((0,0)\)</span>). Let’s add best fit proportional lines and then see what the corresponding coefficients for the models mean.</div>
<figure class="listing figure-like" id="listing-naive-population-rates-lm"><div class="code-box"><pre class="program"><code class="language-none"># Find the model coefficients
lm(formula = B ~ 0 + P_start, data = netlogo_table)
lm(formula = D ~ 0 + P_start, data = netlogo_table)

# Redraw the figure adding the best fit proportional lines
netlogo_table |&gt; 
    pivot_longer(cols = c(B, D),
                names_to = "Rate_Type",
                values_to = "Rate") |&gt;
    ggplot(mapping = aes(x = P_start, y = Rate,
                    color = Rate_Type, shape = Rate_Type)) +
    geom_point() +
    geom_smooth(method = "lm", formula = y ~ 0 + x,
                linewidth = 1, se = FALSE)
</code></pre></div>
<div class="code-box"><pre class="console">Call:
lm(formula = B ~ 0 + P_start, data = netlogo_table)

Coefficients:
P_start  
0.1575  
-----
Call:
lm(formula = D ~ 0 + P_start, data = netlogo_table)

Coefficients:
P_start  
0.09003
</pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.1.7<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/rates-agent-naive-graph-02.png" class="contained"></div>
<div class="para" id="population-agent-naive-23">When we look at the coefficients, notice that they are essentially the model parameters. The proportionality coefficient for the birth rate was estimated as 0.1575, which is remarkable close to decimal value for the model parameter <code class="code-inline tex2jax_ignore">birth-percent</code> of 0.16. Similarly, the proportionality coefficient for the death rate was estimated as 0.09003 and is remarkably close to the decimal value of <code class="code-inline tex2jax_ignore">death-percent</code> of 0.09.</div>
<div class="para" id="population-agent-naive-24">Finally, we look at the per capita birth and death rates. Recall that per capita rates are calculated by dividing the regular rate by the population size. In our case, this means we divide it by the value <code class="code-inline tex2jax_ignore">P_start</code>.</div>
<figure class="listing figure-like" id="listing-naive-population-rates-per-capita"><div class="code-box"><pre class="program"><code class="language-none"># Pivot columns B and D values into a single column Rate
# Then calculate per capita rates
# Then plot per_capita_rate vs P_start to see relations
netlogo_table |&gt; pivot_longer(cols = c(B, D),
                            names_to = "Rate_Type",
                            values_to = "Rate") |&gt;
    mutate(per_capita_rate = Rate / P_start) |&gt;
    ggplot(mapping = aes(x = P_start, y = Rate,
                        color = Rate_Type, shape = Rate_Type)) +
    geom_point()
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.1.8<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/rates-agent-naive-graph-03.png" class="contained"></div>
<div class="para" id="population-agent-naive-27">Notice that the per capita graph has more randomness for small populations. This is typical behavior for <dfn class="terminology">demographic stochasticity</dfn>, as the random variation in births and deaths is much larger <em class="emphasis">relative</em> to the population size when the population size itself is small. However, you should still be able to see that the per capita rates are roughly constant across the populations. Those constant values correspond precisely to the proportionality constants that we found earlier.</div>
<div class="para logical" id="population-agent-naive-28">
<div class="para">This should make sense. The proportional models we found earlier were saying that the number of births <span class="process-math">\(B\)</span> are a coefficient times <span class="process-math">\(P_{\mathrm{start}}\text{,}\)</span> say <span class="process-math">\(B = b \cdot P_{\mathrm{start}}\)</span> where we estimated <span class="process-math">\(b \approx 0.1575\)</span> (and our simulation used the exact value <span class="process-math">\(b=0.16\)</span>). But the per capita rate is <em class="emphasis">defined</em> by <span class="process-math">\(\frac{B}{P_{\mathrm{start}}}\text{.}\)</span> Based on our proportional model, this must mean the per capita birth rate is</div>
<div class="displaymath process-math">
\begin{equation*}
\frac{B}{P_{\mathrm{start}}} = \frac{b \cdot P_{\mathrm{start}}}{P_{\mathrm{start}}} = b\text{.}
\end{equation*}
</div>
</div>
<div class="para" id="population-agent-naive-29">In other words, a birth or death rate that is proportional to the population size means the same thing as saying that the corresponding <em class="emphasis">per capita rate</em> is constant.</div></section><section class="subsection" id="population-agent-density-dependent"><h3 class="heading hide-type">
<span class="type">Subsection</span><span class="space"> </span><span class="codenumber">2.1.3</span><span class="space"> </span><span class="title">Density-Dependent Births and Deaths</span>
</h3>
<div class="para" id="population-agent-density-dependent-2">A more complex rule for population dynamics would include density-dependence. A population does not grow without bound. When the population is crowded, the birth and death rates for individuals change. Competition between individuals might result in fewer resources per individual. Crowded conditions might increase sickness or injuries. Such conditions generally lower the birth rates and increase the death rates for the population.</div>
<div class="para" id="population-agent-density-dependent-3">One simplistic approach to simulate these density-dependent effects in NetLogo would be to identify how many individuals are on a common patch and treat that as the local density. We might then directly increase the percentage of individuals that would die based on this density. This approach captures the idea of density dependence but does not attempt to attribute those changes to actual interactions. More advanced simulations would require directly modeling the environment itself.</div>
<div class="para logical" id="population-agent-density-dependent-4">
<div class="para">One possible implementation for a NetLogo simulation is given here: <a class="external" href="external/code/netlogo/density-dependent-population.nlogo" target="_blank"><code class="code-inline tex2jax_ignore">density-dependent-population.nlogo</code></a>. The interface is illustrated in <a href="population-agent-based.html#fig-density-dependent-population-interface" class="xref" data-knowl="./knowl/xref/fig-density-dependent-population-interface.html" data-reveal-label="Reveal" data-close-label="Close" title="Figure 2.1.9">Figure 2.1.9</a>. The simulation allows you to specify the initial population size, the birth rate as number of births per thousand individuals per cycle, and options to find the death rate that decreases as a population increases. The death rate calculates for each individual a value <code class="code-inline tex2jax_ignore">local-death-percent</code> based on the how many individuals are sharing the patch where the individual is located. Let <span class="process-math">\(p\)</span> represent a specific patch, and let <span class="process-math">\(n_p\)</span> represent the number of individuals located on patch <span class="process-math">\(p\text{.}\)</span> Then <code class="code-inline tex2jax_ignore">local-death-percent</code>, represented by a variable <span class="process-math">\(d_p\)</span> (per capita death) at the patch is calculated by</div>
<div class="displaymath process-math" data-contains-math-knowls="./knowl/xref/fig-density-dependent-population-interface.html">
\begin{equation*}
d_p = d_0 - a n_p,
\end{equation*}
</div>
<div class="para">where <span class="process-math">\(d_0\)</span> is the reference <code class="code-inline tex2jax_ignore">death-per-thousand</code> converted to a decimal and <span class="process-math">\(a\)</span> is the <code class="code-inline tex2jax_ignore">death-increment</code>.</div>
</div>
<figure class="figure figure-like" id="fig-density-dependent-population-interface"><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/density-dependent-population-interface.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.9<span class="period">.</span></span><span class="space"> </span>Interface for <code class="code-inline tex2jax_ignore">density-dependent-population.nlogo</code>.</figcaption></figure><div class="para" id="population-agent-density-dependent-6">To implement this strategy, each individual will need to keep track of its own <code class="code-inline tex2jax_ignore">local-death-percent</code>, which is implemented in NetLogo by the following command.</div>
<div class="code-box"><pre class="program"><code class="language-none">people-own [ local-death-percent ]
</code></pre></div>
<div class="para" id="population-agent-density-dependent-8">We cause each patch to update all of the agents that belong to that patch with an action called <code class="code-inline tex2jax_ignore">density-update</code>. The patch identifies all local individuals and then tells each person on the patch what their local death probability should be based on how many neighbors are competing for the same resources.</div>
<div class="code-box"><pre class="program"><code class="language-none">to density-update ;; this is a command for patches
    ;; create a temporary variable that counts all individuals on patch
    let density count turtles-here
    
    ;; use that density to compute a variable death percentage for
    ;; each individual living on the current patch
    ask turtles-here [
        ;; death-percent is "y-intercept"
        ;; death-increment is "slope"
        set local-death-percent (death-percent + death-increment * density)
    ]
end
</code></pre></div>
<div class="para" id="population-agent-density-dependent-10">Now, the rest of the simulation is essentially the same as before, except that the <code class="code-inline tex2jax_ignore">attempt-survive</code> action has been modified to use <code class="code-inline tex2jax_ignore">local-death-percent</code>.</div>
<div class="code-box"><pre class="program"><code class="language-none">to attempt-survive  ;; and failure is to die
;; 'local-death-percent' = calculated by patches
if random-float 100 &lt; local-death-percent [ die ]
end
</code></pre></div>
<div class="para" id="population-agent-density-dependent-12">The following graph comes from such a simulation using this type of density-dependence. The data for the graph has been exported as <a class="external" href="external/data/density-dependent-population-graph-export.csv" target="_blank"><code class="code-inline tex2jax_ignore">density-dependent-population-graph-export.csv</code></a>.</div>
<figure class="figure figure-like" id="population-agent-density-dependent-13"><div class="image-box" style="width: 70%; margin-left: 15%; margin-right: 15%;"><img src="external/images/nl-pop-dyn-densdep-graph.png" class="contained"></div>
<figcaption><span class="type">Figure</span><span class="space"> </span><span class="codenumber">2.1.10<span class="period">.</span></span><span class="space"> </span>Plot of total population, the number of births and deaths for a density-dependent growth model with <code class="code-inline tex2jax_ignore">birth-percent = 16</code> and <code class="code-inline tex2jax_ignore">death-percent = 9</code> and <code class="code-inline tex2jax_ignore">death-increment = 0.3</code>.</figcaption></figure><div class="para" id="population-agent-density-dependent-14">Notice that the population does not grow indefinitely. As the population increases, the death rate increases faster than the birth rate so that the population growth rate ultimately decreases. The population levels out. We say that the population is approaching a <dfn class="terminology">carrying capacity</dfn>, which is the population that the environment can sustain at a steady-state.</div>
<div class="para" id="population-agent-density-dependent-15">Let us look at how the birth and death rates relate to the population size, similar to what we did earlier with the naive birth/death model. We will import the density-dependent data into R and plot the per capita birth and death rates against the population size at the start of the cycle.</div>
<figure class="listing figure-like" id="listing-density-dependent-population-rates"><div class="code-box"><pre class="program"><code class="language-none">library(readr)    # To load CSV files (read_csv)
library(dplyr)    # To reorganize (select)
library(tidyr)    # To tidy data (pivot_longer)
library(ggplot2)  # To work with graphs (ggplot)

# Import the data
netlogo_data &lt;- read_csv("density-dependent-population-graph-export.csv", 
                        skip = 19, col_names = FALSE)

# Select only columns 1, 2, 6, 10 and assign names
# Then add a new column for P_start
netlogo_table &lt;- netlogo_data |&gt;
    select(tick = 1, P_end = 2, B = 6, D = 10) |&gt;
    mutate(P_start = P_end - B + D)

# Pivot columns B and D values into a single column Rate
# Calculate per capita rates.
# Then plot per capita rates vs P_start to see relations
netlogo_table |&gt; pivot_longer(cols = c(B, D),
                            names_to = "Rate_Type",
                            values_to = "Rate") |&gt;
    mutate(per_capita_rate = Rate / P_start) |&gt;    
    ggplot(mapping = aes(x = P_start, y = per_capita_rate,
                        color = Rate_Type, shape = Rate_Type)) +
    geom_point() +
    geom_smooth(method = "lm", formula = y ~ x)
</code></pre></div>
<figcaption><span class="type">Listing</span><span class="space"> </span><span class="codenumber">2.1.11<span class="period">.</span></span><span class="space"> </span></figcaption></figure><div class="image-box" style="width: 100%; margin-left: 0%; margin-right: 0%;"><img src="external/images/rates-agent-density-dependent-graph.png" class="contained"></div>
<div class="para" id="population-agent-density-dependent-18">Notice that the per capita birth rate is essentially constant across the different population sizes. That is exactly how the simulation was set up to behave. Now notice how the per capita death rate is <em class="emphasis">increasing</em> as the population gets larger. There will be a point where the per capita death rate exactly matches the per capita birth rate. At that population size, the number of new births will exactly balance the number of deaths. This population will be the carrying capactiy. Notice that if the population is above the carrying capacity, the per capita death rate will exceed the birth rate causing the population to decline. We will explore this idea mathematically in the study of <dfn class="terminology">equilibrium values</dfn>, of which a carrying capacity is an example.</div></section><section class="conclusion" id="population-agent-based-6"><div class="para" id="population-agent-based-6-1">Motivated by dynamics of a population simulated with births and deaths, we will next look at deterministic models for population growth. The agent-based simulations we have just been discussing included demographic stochasticity, the randomness related to random birth and death events. In our deterministic models that are about to be developed, the models will not include the stochasticity. They will represent the average behavior expected for a population. For large population sizes, demographic stochasticity is negligible, so we could also think of our deterministic models as describing behavior of large populations.</div></section></section></div>
<div class="ptx-content-footer">
<a class="previous-button button" href="populations.html" title="Previous"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cb;</span><span class="name">Prev</span></a><a class="top-button button" href="#" title="Top"><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5ce;</span><span class="name">Top</span></a><a class="next-button button" href="sec-population-discrete.html" title="Next"><span class="name">Next</span><span class="icon material-symbols-outlined" aria-hidden="true">&#xe5cc;</span></a>
</div></main>
</div>
<div id="ptx-page-footer" class="ptx-page-footer">
<a class="pretext-link" href="https://pretextbook.org" title="PreTeXt"><div class="logo"><svg xmlns="http://www.w3.org/2000/svg" height="100%" viewBox="338 3000 8772 6866" role="img"><title>PreTeXt logo</title><g style="stroke-width:.025in; stroke:currentColor; fill:none"><polyline points="472,3590 472,9732 " style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round; "></polyline><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,9448 A 4660 4660  0  0  1  8598  9259"></path><path style="stroke-width:174;stroke-linecap:butt;" d="M 4488,9685 A 4228 4228  0  0  0   472  9732"></path><path style="stroke-width:126;stroke-linecap:butt;" d="M 4724,3590 A 4241 4241  0  0  1  8598  3496"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,3496  A 4241 4241  0  0  1  4724  3590"></path><path style="stroke-width:126;stroke-linecap:round;" d="M 850,9259  A 4507 4507  0  0  1  4724  9448"></path><polyline points="5385,4299 4062,8125" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8598,3496 8598,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="850,3496 850,9259" style="stroke-width:126; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="4960,9685 4488,9685" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="3070,4582 1889,6141 3070,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="6418,4582 7600,6141 6418,7700" style="stroke-width:300; stroke-linejoin:miter; stroke-linecap:round;"></polyline><polyline points="8976,3590 8976,9732" style="stroke-width:174; stroke-linejoin:miter; stroke-linecap:round;"></polyline><path style="stroke-width:174;stroke-linecap:butt;" d="M 4960,9685 A 4228 4228  0  0  1  8976  9732"></path></g></svg></div></a><a class="runestone-link" href="https://runestone.academy" title="Runestone Academy"><img class="logo" src="https://runestone.academy/runestone/static/images/RAIcon_cropped.png" alt="Runstone Academy logo"></a><a class="mathjax-link" href="https://www.mathjax.org" title="MathJax"><img class="logo" src="https://www.mathjax.org/badge/badge-square-2.png" alt="MathJax logo"></a>
</div>
</body>
</html>
